
//      //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Jan 18 2025
Time   : 09:50:11
Host   : "TUE035485"
PID    : 8975
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.8976"
"TUE035485.8977"
"TUE035485.8978"
"TUE035485.8979"
"TUE035485.8980"
"TUE035485.8981"
"TUE035485.8982"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
[0] 
[0] 
[0] --> FOAM FATAL ERROR: 
[0] cfdemSolverMultiphaseScalar: cannot open case directory "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD/processor0"
[0] 
[0] 
FOAM parallel run exiting
[0] 
--------------------------------------------------------------------------
MPI_ABORT was invoked on rank 0 in communicator MPI_COMM_WORLD
with errorcode 1.

NOTE: invoking MPI_ABORT causes Open MPI to kill all MPI processes.
You may or may not see output from other processes, depending on
exactly when Open MPI kills them.
--------------------------------------------------------------------------

//      //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Jan 18 2025
Time   : 09:50:37
Host   : "TUE035485"
PID    : 9052
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.9053"
"TUE035485.9054"
"TUE035485.9055"
"TUE035485.9056"
"TUE035485.9057"
"TUE035485.9058"
"TUE035485.9059"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0


PIMPLE: Operating solver in PISO mode


Reading momentum exchange field Ksl


Reading voidfraction field voidfraction = (Vgas/Vparticle)

Reading particle velocity field Us

Reading field p_rgh

Reading field U

Reading/calculating face flux field phi

Selecting incompressible transport model Newtonian
Selecting incompressible transport model Newtonian
Reading/creating thermal fields

Reading/creating concentration fields

Selecting turbulence model type laminar

Reading g

Reading hRef
Calculating field g.h

No finite volume options present

GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
time step continuity errors : sum local = 0, global = 0, cumulative = 0
Courant Number mean: 0 max: 0
Selecting dataExchangeModel twoWayMPI
Starting up LIGGGHTS for first time execution
Executing input script '../DEM/in.liggghts_run'
LIGGGHTS (Version LIGGGHTS-PFM 24.01, compiled 2025-01-17-18:01:04 by ht45454, git commit d075b97762ce4302707903718dda170920e630bd, based on LAMMPS 23 Nov 2013)
log             ../log/log.liggghts_run
thermo_log      ../log/thermo.txt

atom_style      granular
atom_modify     map array
boundary        f f f
newton          off

communicate     single vel yes

units           si
processors      2 2 2

# read the restart file
read_restart    ../DEM/post/restart/liggghts.restartSequence
Reading restart file ...
ERROR on proc 0: Cannot open restart file ../DEM/post/restart/liggghts.restartSequence (/home/ht45454/CFDEM/LIGGGHTS/src/read_restart.cpp:115)
--------------------------------------------------------------------------
MPI_ABORT was invoked on rank 0 in communicator MPI COMMUNICATOR 3 DUP FROM 0
with errorcode 1.

NOTE: invoking MPI_ABORT causes Open MPI to kill all MPI processes.
You may or may not see output from other processes, depending on
exactly when Open MPI kills them.
--------------------------------------------------------------------------

//      //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Jan 18 2025
Time   : 09:51:42
Host   : "TUE035485"
PID    : 9126
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.9127"
"TUE035485.9128"
"TUE035485.9129"
"TUE035485.9130"
"TUE035485.9131"
"TUE035485.9132"
"TUE035485.9133"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0


PIMPLE: Operating solver in PISO mode


Reading momentum exchange field Ksl


Reading voidfraction field voidfraction = (Vgas/Vparticle)

Reading particle velocity field Us

Reading field p_rgh

Reading field U

Reading/calculating face flux field phi

Selecting incompressible transport model Newtonian
Selecting incompressible transport model Newtonian
Reading/creating thermal fields

Reading/creating concentration fields

Selecting turbulence model type laminar

Reading g

Reading hRef
Calculating field g.h

No finite volume options present

GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
time step continuity errors : sum local = 0, global = 0, cumulative = 0
Courant Number mean: 0 max: 0
Selecting dataExchangeModel twoWayMPI
Starting up LIGGGHTS for first time execution
Executing input script '../DEM/in.liggghts_run'
LIGGGHTS (Version LIGGGHTS-PFM 24.01, compiled 2025-01-17-18:01:04 by ht45454, git commit d075b97762ce4302707903718dda170920e630bd, based on LAMMPS 23 Nov 2013)
log             ../log/log.liggghts_run
thermo_log      ../log/thermo.txt

atom_style      granular
atom_modify     map array
boundary        f f f
newton          off

communicate     single vel yes

units           si
processors      2 2 2

# read the restart file
read_restart    ../DEM/post/restart/liggghts.restartSequence
Reading restart file ...
  orthogonal box = (-0.5 -0.5 -0.0025) to (0.5 0.5 1)
  2 by 2 by 2 MPI processor grid
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
  80888 atoms

neighbor        0.007 bin
neigh_modify    delay 0

# contact model
include         ../DEM/in.contact_settings
# Material properties required for granular pair styles
fix             m1 all property/global youngsModulus	                peratomtype       5.e6
fix             m2 all property/global poissonsRatio 	                peratomtype	  0.3
fix             m3 all property/global coefficientRestitution           peratomtypepair 1 0.3
fix             m4 all property/global coefficientFriction 	        peratomtypepair 1 0.5
fix             m5 all property/global coefficientRollingFriction       peratomtypepair 1 0.2
fix             m6 all property/global coefficientRollingViscousDamping peratomtypepair 1 0.3

# pair style
pair_style	gran model hertz tangential history rolling_friction epsd
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
pair_coeff  	* *

# hearth settings
include         ../DEM/in.hearth_settings
# hearth settings
variable        hearthRadius  equal 0.5     # hearth radius (m)
variable        coreRadius    equal 0.15    # radius of core region (m)
variable        liquidLevel   equal 0.4     # initial liquid level (m) [set in setFieldsDict as well!]
variable        liquidDensity equal 6700.   # liquid density (kg/m3)

# heat/mass transfer settings
variable        particlekInit equal 5000    # particle thermal conductivity during init (W/Km)
variable        particlekRun  equal 40.0    # particle thermal conductivity during run  (W/Km) [sped up! 2.0*20!]
variable        particleCp    equal 870     # particle heat capacity (J/kgK)
variable        Tinlet        equal 1823.15 # particle inlet temperature (K) [set in CFD as well!]
variable        Tinit         equal 1623.15 # initial temperature (K) [set in CFD as well!]
variable        Twall         equal 1423.15 # wall temperature (K) [set in CFD as well!]
variable        rRemove       equal 0.001   # radius at which dissolved particles are removed (m)

# zone definitions
variable        forceZmin     equal 0.70    # lower boundary of force zone (m)
variable        forceZmax     equal 0.80    # upper boundary of force zone (m)
variable        insZmin       equal 0.70    # lower boundary of insertion zone (m)
variable        insZmax       equal 0.80    # upper boundary of insertion zone (m)

region          bedReg        cylinder z 0 0 ${hearthRadius} 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            0.8
region          coreReg       cylinder z 0 0 ${coreRadius}   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            0.8 side in
region          invCoreReg    cylinder z 0 0 ${coreRadius}   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            0.8 side out
region          shellReg      intersect 2 bedReg invCoreReg

region		insReg        cylinder z 0 0 ${hearthRadius} ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   0.8
region          insCoreReg    intersect 2 insReg coreReg
region          insShellReg   intersect 2 insReg invCoreReg

region		forceReg      cylinder z 0 0 ${hearthRadius} ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 0.8
region          freeboard     cylinder z 0 0 ${hearthRadius} ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 0.8 INF

region          mushroom      block 0.4 0.5 -0.05 0.05 0.2 0.3 side out # mushroom cutout
region          initReg       intersect 2 bedReg mushroom # entire bed minus mushroom
region          initCoreReg   intersect 2 initReg coreReg
region          initShellReg  intersect 2 initReg invCoreReg

# total burden weight
variable        pressureMin   equal 2000    # lower pressure value (Pa), near wall
variable        pressureMax   equal 20000   # upper pressure value (Pa), near core

# kinetic energy
variable        kinEn         equal ke      # kinetic energy (J)
variable        kinEnMax      equal 2.      # kinetic energy threshold for init (J)

# coke removal settings
variable        cokeRateInit  equal 20.     # coke combustion rate during init (kg/s)
variable        cokeRateRun   equal 1.      # coke combustion rate during run (kg/s)
variable        delInt        equal 0.1     # removal interval (s) [set in liggghtsCommands as well!]

variable        nFreeboard    equal count(all,freeboard)

variable        nRaceways     equal count(all,raceways)
variable        mRaceways     equal mass(all,raceways)
variable        avMass        equal "v_mRaceways/(v_nRaceways+1e-3)"

variable        delIntSteps   equal "floor(v_delInt/dt)"

variable        nDelInit      equal "v_delIntSteps*dt*v_cokeRateInit/v_avMass"
variable        fDelInit      equal "v_nDelInit/(v_nRaceways+1e-3)"

variable        nDelRun       equal "v_delIntSteps*dt*v_cokeRateRun/v_avMass"
variable        fDelRun       equal "v_nDelRun/(v_nRaceways+1e-3)"




# timestep
timestep        1e-4

# cfd coupling
fix             cfd all couple/cfd couple_every 100 mpi
nevery as specified in LIGGGHTS is overriden by calling external program (/home/ht45454/CFDEM/LIGGGHTS/src/cfd_datacoupling_mpi.cpp:56)
fix             cfd2 all couple/cfd/force/implicit

# heat transfer
fix             m7 all property/global thermalConductivity peratomtype ${particlekRun} # lambda in [W/(K*m)]
fix             m7 all property/global thermalConductivity peratomtype 40 
fix             m8 all property/global thermalCapacity     peratomtype ${particleCp}   # cp in [J/(kg*K)]
fix             m8 all property/global thermalCapacity     peratomtype 870   
fix             heattransfer all heat/gran/conduction initial_temperature ${Tinlet}
fix             heattransfer all heat/gran/conduction initial_temperature 1823.15
Resetting global state of Fix Temp Style property/atom from restart file info
Resetting per-atom state of Fix Temp Style property/atom from restart file info
Resetting global state of Fix heatFlux Style property/atom from restart file info
Resetting per-atom state of Fix heatFlux Style property/atom from restart file info
Resetting global state of Fix heatSource Style property/atom from restart file info
Resetting per-atom state of Fix heatSource Style property/atom from restart file info
fix             cfd3 all couple/cfd/convection T0 ${Tinlet}
fix             cfd3 all couple/cfd/convection T0 1823.15

# mass transfer
fix             cfd4 all couple/cfd/dissolve rmin ${rRemove}
fix             cfd4 all couple/cfd/dissolve rmin 0.001

# walls
include         ../DEM/in.wall_settings
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature ${Twall} curvature 1e-5
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature 1423.15 curvature 1e-5
Resetting global state of Fix sides Style mesh/surface from restart file info
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature ${Twall}
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature 1423.15
Resetting global state of Fix bottom Style mesh/surface from restart file info
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature ${Twall}
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature 1423.15
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
Resetting global state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting global state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting global state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting global state of Fix tracker_bottom Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_bottom Style contacthistory/mesh from restart file info

# gravity
fix		gravi all gravity 9.81 vector 0.0 0.0 -1.0

######################################

# particle distribution
include	   	../DEM/in.particleSizeDistribution1
# Particle size distribution for LIGGGHTS

# mean radius = 0.0100000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts1 all particletemplate/sphere 10007 atom_type 1 density constant 900 radius constant 0.01
Resetting global state of Fix pts1 Style particletemplate/sphere from restart file info

fix	pdd1 all particledistribution/discrete 10009 1 pts1 1.000000
Fix particledistribution/discrete (id pdd1): distribution based on mass%:
    pts1: d=2.000000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd1): distribution based on number%:
    pts1: d=2.000000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd1 Style particledistribution/discrete from restart file info
include	   	../DEM/in.particleSizeDistribution2
# Particle size distribution for LIGGGHTS

# mean radius = 0.0125000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts2 all particletemplate/sphere 10037 atom_type 1 density constant 900 radius constant 0.0125
Resetting global state of Fix pts2 Style particletemplate/sphere from restart file info

fix	pdd2 all particledistribution/discrete 10039 1 pts2 1.000000
Fix particledistribution/discrete (id pdd2): distribution based on mass%:
    pts2: d=2.500000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd2): distribution based on number%:
    pts2: d=2.500000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd2 Style particledistribution/discrete from restart file info

# raceways
include		../DEM/in.raceways
# Raceway definition for LIGGGHTS

# reactor radius = 0.500000 m
# raceway height = 0.500000 m
# raceway diameter = 0.100000 m
# raceway length = 0.100000 m
# number of raceways = 8

variable angle1 equal 0.000000
region raceway1 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle1 0 0 0 0 0 1
variable angle2 equal 0.785398
region raceway2 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle2 0 0 0 0 0 1
variable angle3 equal 1.570796
region raceway3 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle3 0 0 0 0 0 1
variable angle4 equal 2.356194
region raceway4 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle4 0 0 0 0 0 1
variable angle5 equal 3.141593
region raceway5 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle5 0 0 0 0 0 1
variable angle6 equal 3.926991
region raceway6 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle6 0 0 0 0 0 1
variable angle7 equal 4.712389
region raceway7 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle7 0 0 0 0 0 1
variable angle8 equal 5.497787
region raceway8 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle8 0 0 0 0 0 1

region raceways union 8 raceway1 raceway2 raceway3 raceway4 raceway5 raceway6 raceway7 raceway8

# burden weight
include         ../DEM/in.pressure_profile
# Pressure profile definition for LIGGGHTS

# reactor radius = 0.500000 m
# R1 = 0.150000 m
# R2 = 0.400000 m
# number of bins = 12

# Region01
region   forceReg01		 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side in  	# center region
region   forceReg01		 cylinder z 0 0 0.15	0.7 ${forceZmax} side in  	
region   forceReg01		 cylinder z 0 0 0.15	0.7 0.8 side in  	
variable nForceReg01	 equal count(all,forceReg01) 								# number of particles inside
variable forceRegArea01	 equal 0.070686												# ring area (m2)
variable forceFact01	 equal 1												# force factor [0-1] (-)
variable totalForce01	 equal "-(v_forceFact01*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea01"	# total force (N)
variable forcePerPart01	 equal "v_totalForce01/(v_nForceReg01+1e-3)"				# force per particle (N)
fix      force01		 all addforce 0 0 v_forcePerPart01 region forceReg01		# apply force

# Region02
region   forceRegIn02	 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 ${forceZmax} side out 	
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 0.8 side out 	
region   forceRegOut02	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side in  	
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 0.8 side in  	
region   forceReg02		 intersect 2 forceRegIn02 forceRegOut02						# annular region
variable nForceReg02	 equal count(all,forceReg02) 								# number of particles inside
variable forceRegArea02	 equal 0.020998												# ring area (m2)
variable forceFact02	 equal 0.95833												# force factor [0-1] (-)
variable totalForce02	 equal "-(v_forceFact02*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea02"	# total force (N)
variable forcePerPart02	 equal "v_totalForce02/(v_nForceReg02+1e-3)"				# force per particle (N)
fix      force02		 all addforce 0 0 v_forcePerPart02 region forceReg02		# apply force

# Region03
region   forceRegIn03	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side out 	
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 0.8 side out 	
region   forceRegOut03	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side in  	
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 0.8 side in  	
region   forceReg03		 intersect 2 forceRegIn03 forceRegOut03						# annular region
variable nForceReg03	 equal count(all,forceReg03) 								# number of particles inside
variable forceRegArea03	 equal 0.023726												# ring area (m2)
variable forceFact03	 equal 0.875												# force factor [0-1] (-)
variable totalForce03	 equal "-(v_forceFact03*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea03"	# total force (N)
variable forcePerPart03	 equal "v_totalForce03/(v_nForceReg03+1e-3)"				# force per particle (N)
fix      force03		 all addforce 0 0 v_forcePerPart03 region forceReg03		# apply force

# Region04
region   forceRegIn04	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side out 	
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 0.8 side out 	
region   forceRegOut04	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side in  	
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 0.8 side in  	
region   forceReg04		 intersect 2 forceRegIn04 forceRegOut04						# annular region
variable nForceReg04	 equal count(all,forceReg04) 								# number of particles inside
variable forceRegArea04	 equal 0.026453												# ring area (m2)
variable forceFact04	 equal 0.79167												# force factor [0-1] (-)
variable totalForce04	 equal "-(v_forceFact04*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea04"	# total force (N)
variable forcePerPart04	 equal "v_totalForce04/(v_nForceReg04+1e-3)"				# force per particle (N)
fix      force04		 all addforce 0 0 v_forcePerPart04 region forceReg04		# apply force

# Region05
region   forceRegIn05	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side out 	
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 0.8 side out 	
region   forceRegOut05	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side in  	
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 0.8 side in  	
region   forceReg05		 intersect 2 forceRegIn05 forceRegOut05						# annular region
variable nForceReg05	 equal count(all,forceReg05) 								# number of particles inside
variable forceRegArea05	 equal 0.02918												# ring area (m2)
variable forceFact05	 equal 0.70833												# force factor [0-1] (-)
variable totalForce05	 equal "-(v_forceFact05*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea05"	# total force (N)
variable forcePerPart05	 equal "v_totalForce05/(v_nForceReg05+1e-3)"				# force per particle (N)
fix      force05		 all addforce 0 0 v_forcePerPart05 region forceReg05		# apply force

# Region06
region   forceRegIn06	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side out 	
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 0.8 side out 	
region   forceRegOut06	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side in  	
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 0.8 side in  	
region   forceReg06		 intersect 2 forceRegIn06 forceRegOut06						# annular region
variable nForceReg06	 equal count(all,forceReg06) 								# number of particles inside
variable forceRegArea06	 equal 0.031907												# ring area (m2)
variable forceFact06	 equal 0.625												# force factor [0-1] (-)
variable totalForce06	 equal "-(v_forceFact06*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea06"	# total force (N)
variable forcePerPart06	 equal "v_totalForce06/(v_nForceReg06+1e-3)"				# force per particle (N)
fix      force06		 all addforce 0 0 v_forcePerPart06 region forceReg06		# apply force

# Region07
region   forceRegIn07	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side out 	
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 0.8 side out 	
region   forceRegOut07	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 ${forceZmax} side in  	
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 0.8 side in  	
region   forceReg07		 intersect 2 forceRegIn07 forceRegOut07						# annular region
variable nForceReg07	 equal count(all,forceReg07) 								# number of particles inside
variable forceRegArea07	 equal 0.034634												# ring area (m2)
variable forceFact07	 equal 0.54167												# force factor [0-1] (-)
variable totalForce07	 equal "-(v_forceFact07*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea07"	# total force (N)
variable forcePerPart07	 equal "v_totalForce07/(v_nForceReg07+1e-3)"				# force per particle (N)
fix      force07		 all addforce 0 0 v_forcePerPart07 region forceReg07		# apply force

# Region08
region   forceRegIn08	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 ${forceZmax} side out 	
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 0.8 side out 	
region   forceRegOut08	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side in  	
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 0.8 side in  	
region   forceReg08		 intersect 2 forceRegIn08 forceRegOut08						# annular region
variable nForceReg08	 equal count(all,forceReg08) 								# number of particles inside
variable forceRegArea08	 equal 0.037361												# ring area (m2)
variable forceFact08	 equal 0.45833												# force factor [0-1] (-)
variable totalForce08	 equal "-(v_forceFact08*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea08"	# total force (N)
variable forcePerPart08	 equal "v_totalForce08/(v_nForceReg08+1e-3)"				# force per particle (N)
fix      force08		 all addforce 0 0 v_forcePerPart08 region forceReg08		# apply force

# Region09
region   forceRegIn09	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side out 	
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 0.8 side out 	
region   forceRegOut09	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side in  	
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 0.8 side in  	
region   forceReg09		 intersect 2 forceRegIn09 forceRegOut09						# annular region
variable nForceReg09	 equal count(all,forceReg09) 								# number of particles inside
variable forceRegArea09	 equal 0.040088												# ring area (m2)
variable forceFact09	 equal 0.375												# force factor [0-1] (-)
variable totalForce09	 equal "-(v_forceFact09*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea09"	# total force (N)
variable forcePerPart09	 equal "v_totalForce09/(v_nForceReg09+1e-3)"				# force per particle (N)
fix      force09		 all addforce 0 0 v_forcePerPart09 region forceReg09		# apply force

# Region10
region   forceRegIn10	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side out 	
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 0.8 side out 	
region   forceRegOut10	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side in  	
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 0.8 side in  	
region   forceReg10		 intersect 2 forceRegIn10 forceRegOut10						# annular region
variable nForceReg10	 equal count(all,forceReg10) 								# number of particles inside
variable forceRegArea10	 equal 0.042815												# ring area (m2)
variable forceFact10	 equal 0.29167												# force factor [0-1] (-)
variable totalForce10	 equal "-(v_forceFact10*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea10"	# total force (N)
variable forcePerPart10	 equal "v_totalForce10/(v_nForceReg10+1e-3)"				# force per particle (N)
fix      force10		 all addforce 0 0 v_forcePerPart10 region forceReg10		# apply force

# Region11
region   forceRegIn11	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side out 	
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 0.8 side out 	
region   forceRegOut11	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side in  	
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 0.8 side in  	
region   forceReg11		 intersect 2 forceRegIn11 forceRegOut11						# annular region
variable nForceReg11	 equal count(all,forceReg11) 								# number of particles inside
variable forceRegArea11	 equal 0.045542												# ring area (m2)
variable forceFact11	 equal 0.20833												# force factor [0-1] (-)
variable totalForce11	 equal "-(v_forceFact11*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea11"	# total force (N)
variable forcePerPart11	 equal "v_totalForce11/(v_nForceReg11+1e-3)"				# force per particle (N)
fix      force11		 all addforce 0 0 v_forcePerPart11 region forceReg11		# apply force

# Region12
region   forceRegIn12	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side out 	
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 0.8 side out 	
region   forceRegOut12	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side in  	
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 0.8 side in  	
region   forceReg12		 intersect 2 forceRegIn12 forceRegOut12						# annular region
variable nForceReg12	 equal count(all,forceReg12) 								# number of particles inside
variable forceRegArea12	 equal 0.048269												# ring area (m2)
variable forceFact12	 equal 0.125												# force factor [0-1] (-)
variable totalForce12	 equal "-(v_forceFact12*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea12"	# total force (N)
variable forcePerPart12	 equal "v_totalForce12/(v_nForceReg12+1e-3)"				# force per particle (N)
fix      force12		 all addforce 0 0 v_forcePerPart12 region forceReg12		# apply force

# Region13
region   forceRegIn13	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side out 	
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 0.8 side out 	
region   forceRegOut13	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 ${forceZmax} side in  	
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 0.8 side in  	
region   forceReg13		 intersect 2 forceRegIn13 forceRegOut13						# annular region
variable nForceReg13	 equal count(all,forceReg13) 								# number of particles inside
variable forceRegArea13	 equal 0.050996												# ring area (m2)
variable forceFact13	 equal 0.041667												# force factor [0-1] (-)
variable totalForce13	 equal "-(v_forceFact13*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea13"	# total force (N)
variable forcePerPart13	 equal "v_totalForce13/(v_nForceReg13+1e-3)"				# force per particle (N)
fix      force13		 all addforce 0 0 v_forcePerPart13 region forceReg13		# apply force

# Region14
region   forceRegIn14	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 ${forceZmax} side out 	
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 0.8 side out 	
region   forceRegOut14	 cylinder z 0 0 0.5	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 ${forceZmax} side in  	
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 0.8 side in  	
region   forceReg14		 intersect 2 forceRegIn14 forceRegOut14						# annular region
variable nForceReg14	 equal count(all,forceReg14) 								# number of particles inside
variable forceRegArea14	 equal 0.28274												# ring area (m2)
variable forceFact14	 equal 0												# force factor [0-1] (-)
variable totalForce14	 equal "-(v_forceFact14*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea14"	# total force (N)
variable forcePerPart14	 equal "v_totalForce14/(v_nForceReg14+1e-3)"				# force per particle (N)
fix      force14		 all addforce 0 0 v_forcePerPart14 region forceReg14		# apply force

variable totalForce		 equal "v_forcePerPart01*v_nForceReg01+v_forcePerPart02*v_nForceReg02+v_forcePerPart03*v_nForceReg03+v_forcePerPart04*v_nForceReg04+v_forcePerPart05*v_nForceReg05+v_forcePerPart06*v_nForceReg06+v_forcePerPart07*v_nForceReg07+v_forcePerPart08*v_nForceReg08+v_forcePerPart09*v_nForceReg09+v_forcePerPart10*v_nForceReg10+v_forcePerPart11*v_nForceReg11+v_forcePerPart12*v_nForceReg12+v_forcePerPart13*v_nForceReg13+v_forcePerPart14*v_nForceReg14" 	# sum of all forces (N)
variable nForceReg		 equal "v_nForceReg01+v_nForceReg02+v_nForceReg03+v_nForceReg04+v_nForceReg05+v_nForceReg06+v_nForceReg07+v_nForceReg08+v_nForceReg09+v_nForceReg10+v_nForceReg11+v_nForceReg12+v_nForceReg13+v_nForceReg14" 	# sum of all numbers of particles (N)
variable avForcePerPart	 equal "v_totalForce/(v_nForceReg+1e-3)"	# average force per particle (N)

# insert in insertion volume
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every ${delIntSteps} overlapcheck yes region insShellReg volumefraction_region 0.7
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every 1000 overlapcheck yes region insShellReg volumefraction_region 0.7
INFO: Resetting random generator for region insShellReg
Resetting global state of Fix ins3 Style insert/pack from restart file info
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every ${delIntSteps} overlapcheck yes region insCoreReg  volumefraction_region 0.7
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every 1000 overlapcheck yes region insCoreReg  volumefraction_region 0.7
INFO: Resetting random generator for region insCoreReg
Resetting global state of Fix ins4 Style insert/pack from restart file info

######################################

# apply nve integration to all particles
fix             integr all nve/sphere

# output settings
thermo_style    custom step time atoms ke v_totalForce v_avForcePerPart v_nDelRun
thermo          10

# dump settings
dump            dmp all custom 5000 ../DEM/post/dump*.liggghts_run id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius density f_Temp[0] f_convectiveHeatFlux[0]
# the /couple/cfd/dissolve seems not working, so I commend this out: f_convectiveMassFlux[0]
#5000
run             0
Resetting global state of Fix contacthistory Style contacthistory from restart file info
Resetting per-atom state of Fix contacthistory Style contacthistory from restart file info
Setting up run ...
Import and parallelization of mesh sides containing 2592 triangle(s) successful
Import and parallelization of mesh bottom containing 1024 triangle(s) successful
INFO: Resetting random generator for region insShellReg
INFO: Particle insertion ins3: inserting every 1000 steps
INFO: Resetting random generator for region insCoreReg
INFO: Particle insertion ins4: inserting every 1000 steps
Memory usage per processor = 24.93 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
ERROR: Divide by 0 in variable formula (/home/ht45454/CFDEM/LIGGGHTS/src/variable.cpp:1569)
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[1260,1],0]
  Exit code:    1
--------------------------------------------------------------------------

//      //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Jan 18 2025
Time   : 09:55:13
Host   : "TUE035485"
PID    : 9248
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.9249"
"TUE035485.9250"
"TUE035485.9251"
"TUE035485.9252"
"TUE035485.9253"
"TUE035485.9254"
"TUE035485.9255"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0


PIMPLE: Operating solver in PISO mode


Reading momentum exchange field Ksl


Reading voidfraction field voidfraction = (Vgas/Vparticle)

Reading particle velocity field Us

Reading field p_rgh

Reading field U

Reading/calculating face flux field phi

Selecting incompressible transport model Newtonian
Selecting incompressible transport model Newtonian
Reading/creating thermal fields

Reading/creating concentration fields

Selecting turbulence model type laminar

Reading g

Reading hRef
Calculating field g.h

No finite volume options present

GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
time step continuity errors : sum local = 0, global = 0, cumulative = 0
Courant Number mean: 0 max: 0
Selecting dataExchangeModel twoWayMPI
Starting up LIGGGHTS for first time execution
Executing input script '../DEM/in.liggghts_run'
LIGGGHTS (Version LIGGGHTS-PFM 24.01, compiled 2025-01-17-18:01:04 by ht45454, git commit d075b97762ce4302707903718dda170920e630bd, based on LAMMPS 23 Nov 2013)
log             ../log/log.liggghts_run
thermo_log      ../log/thermo.txt

atom_style      granular
atom_modify     map array
boundary        f f f
newton          off

communicate     single vel yes

units           si
processors      2 2 2

# read the restart file
read_restart    ../DEM/post/restart/liggghts.restartSequence
Reading restart file ...
  orthogonal box = (-0.5 -0.5 -0.0025) to (0.5 0.5 1)
  2 by 2 by 2 MPI processor grid
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
  80888 atoms

neighbor        0.007 bin
neigh_modify    delay 0

# contact model
include         ../DEM/in.contact_settings
# Material properties required for granular pair styles
fix             m1 all property/global youngsModulus	                peratomtype       5.e6
fix             m2 all property/global poissonsRatio 	                peratomtype	  0.3
fix             m3 all property/global coefficientRestitution           peratomtypepair 1 0.3
fix             m4 all property/global coefficientFriction 	        peratomtypepair 1 0.5
fix             m5 all property/global coefficientRollingFriction       peratomtypepair 1 0.2
fix             m6 all property/global coefficientRollingViscousDamping peratomtypepair 1 0.3

# pair style
pair_style	gran model hertz tangential history rolling_friction epsd
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
pair_coeff  	* *

# hearth settings
include         ../DEM/in.hearth_settings
# hearth settings
variable        hearthRadius  equal 0.5     # hearth radius (m)
variable        coreRadius    equal 0.15    # radius of core region (m)
variable        liquidLevel   equal 0.4     # initial liquid level (m) [set in setFieldsDict as well!]
variable        liquidDensity equal 6700.   # liquid density (kg/m3)

# heat/mass transfer settings
variable        particlekInit equal 5000    # particle thermal conductivity during init (W/Km)
variable        particlekRun  equal 40.0    # particle thermal conductivity during run  (W/Km) [sped up! 2.0*20!]
variable        particleCp    equal 870     # particle heat capacity (J/kgK)
variable        Tinlet        equal 1823.15 # particle inlet temperature (K) [set in CFD as well!]
variable        Tinit         equal 1623.15 # initial temperature (K) [set in CFD as well!]
variable        Twall         equal 1423.15 # wall temperature (K) [set in CFD as well!]
variable        rRemove       equal 0.001   # radius at which dissolved particles are removed (m)

# zone definitions
variable        forceZmin     equal 0.70    # lower boundary of force zone (m)
variable        forceZmax     equal 0.80    # upper boundary of force zone (m)
variable        insZmin       equal 0.70    # lower boundary of insertion zone (m)
variable        insZmax       equal 0.80    # upper boundary of insertion zone (m)

region          bedReg        cylinder z 0 0 ${hearthRadius} 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            0.8
region          coreReg       cylinder z 0 0 ${coreRadius}   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            0.8 side in
region          invCoreReg    cylinder z 0 0 ${coreRadius}   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            0.8 side out
region          shellReg      intersect 2 bedReg invCoreReg

region		insReg        cylinder z 0 0 ${hearthRadius} ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   0.8
region          insCoreReg    intersect 2 insReg coreReg
region          insShellReg   intersect 2 insReg invCoreReg

region		forceReg      cylinder z 0 0 ${hearthRadius} ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 0.8
region          freeboard     cylinder z 0 0 ${hearthRadius} ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 0.8 INF

region          mushroom      block 0.4 0.5 -0.05 0.05 0.2 0.3 side out # mushroom cutout
region          initReg       intersect 2 bedReg mushroom # entire bed minus mushroom
region          initCoreReg   intersect 2 initReg coreReg
region          initShellReg  intersect 2 initReg invCoreReg

# total burden weight
variable        pressureMin   equal 2000    # lower pressure value (Pa), near wall
variable        pressureMax   equal 20000   # upper pressure value (Pa), near core

# kinetic energy
variable        kinEn         equal ke      # kinetic energy (J)
variable        kinEnMax      equal 2.      # kinetic energy threshold for init (J)

# coke removal settings
variable        cokeRateInit  equal 20.     # coke combustion rate during init (kg/s)
variable        cokeRateRun   equal 1.      # coke combustion rate during run (kg/s)
variable        delInt        equal 0.1     # removal interval (s) [set in liggghtsCommands as well!]

variable        nFreeboard    equal count(all,freeboard)

variable        nRaceways     equal count(all,raceways)
variable        mRaceways     equal mass(all,raceways)
variable        avMass        equal "v_mRaceways/(v_nRaceways+1e-3)"

variable        delIntSteps   equal "floor(v_delInt/dt)"

variable        nDelInit      equal "v_delIntSteps*dt*v_cokeRateInit/v_avMass"
variable        fDelInit      equal "v_nDelInit/(v_nRaceways+1e-3)"

variable        nDelRun       equal "v_delIntSteps*dt*v_cokeRateRun/v_avMass"
variable        fDelRun       equal "v_nDelRun/(v_nRaceways+1e-3)"




# timestep
timestep        1e-4

# cfd coupling
fix             cfd all couple/cfd couple_every 100 mpi
nevery as specified in LIGGGHTS is overriden by calling external program (/home/ht45454/CFDEM/LIGGGHTS/src/cfd_datacoupling_mpi.cpp:56)
fix             cfd2 all couple/cfd/force/implicit

# heat transfer
fix             m7 all property/global thermalConductivity peratomtype ${particlekRun} # lambda in [W/(K*m)]
fix             m7 all property/global thermalConductivity peratomtype 40 
fix             m8 all property/global thermalCapacity     peratomtype ${particleCp}   # cp in [J/(kg*K)]
fix             m8 all property/global thermalCapacity     peratomtype 870   
fix             heattransfer all heat/gran/conduction initial_temperature ${Tinlet}
fix             heattransfer all heat/gran/conduction initial_temperature 1823.15
Resetting global state of Fix Temp Style property/atom from restart file info
Resetting per-atom state of Fix Temp Style property/atom from restart file info
Resetting global state of Fix heatFlux Style property/atom from restart file info
Resetting per-atom state of Fix heatFlux Style property/atom from restart file info
Resetting global state of Fix heatSource Style property/atom from restart file info
Resetting per-atom state of Fix heatSource Style property/atom from restart file info
fix             cfd3 all couple/cfd/convection T0 ${Tinlet}
fix             cfd3 all couple/cfd/convection T0 1823.15

# mass transfer
fix             cfd4 all couple/cfd/dissolve rmin ${rRemove}
fix             cfd4 all couple/cfd/dissolve rmin 0.001

# walls
include         ../DEM/in.wall_settings
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature ${Twall} curvature 1e-5
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature 1423.15 curvature 1e-5
Resetting global state of Fix sides Style mesh/surface from restart file info
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature ${Twall}
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature 1423.15
Resetting global state of Fix bottom Style mesh/surface from restart file info
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature ${Twall}
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature 1423.15
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
Resetting global state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting global state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting global state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting global state of Fix tracker_bottom Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_bottom Style contacthistory/mesh from restart file info

# gravity
fix		gravi all gravity 9.81 vector 0.0 0.0 -1.0

######################################

# particle distribution
include	   	../DEM/in.particleSizeDistribution1
# Particle size distribution for LIGGGHTS

# mean radius = 0.0100000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts1 all particletemplate/sphere 10007 atom_type 1 density constant 900 radius constant 0.01
Resetting global state of Fix pts1 Style particletemplate/sphere from restart file info

fix	pdd1 all particledistribution/discrete 10009 1 pts1 1.000000
Fix particledistribution/discrete (id pdd1): distribution based on mass%:
    pts1: d=2.000000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd1): distribution based on number%:
    pts1: d=2.000000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd1 Style particledistribution/discrete from restart file info
include	   	../DEM/in.particleSizeDistribution2
# Particle size distribution for LIGGGHTS

# mean radius = 0.0125000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts2 all particletemplate/sphere 10037 atom_type 1 density constant 900 radius constant 0.0125
Resetting global state of Fix pts2 Style particletemplate/sphere from restart file info

fix	pdd2 all particledistribution/discrete 10039 1 pts2 1.000000
Fix particledistribution/discrete (id pdd2): distribution based on mass%:
    pts2: d=2.500000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd2): distribution based on number%:
    pts2: d=2.500000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd2 Style particledistribution/discrete from restart file info

# raceways
include		../DEM/in.raceways
# Raceway definition for LIGGGHTS

# reactor radius = 0.500000 m
# raceway height = 0.500000 m
# raceway diameter = 0.100000 m
# raceway length = 0.100000 m
# number of raceways = 8

variable angle1 equal 0.000000
region raceway1 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle1 0 0 0 0 0 1
variable angle2 equal 0.785398
region raceway2 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle2 0 0 0 0 0 1
variable angle3 equal 1.570796
region raceway3 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle3 0 0 0 0 0 1
variable angle4 equal 2.356194
region raceway4 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle4 0 0 0 0 0 1
variable angle5 equal 3.141593
region raceway5 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle5 0 0 0 0 0 1
variable angle6 equal 3.926991
region raceway6 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle6 0 0 0 0 0 1
variable angle7 equal 4.712389
region raceway7 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle7 0 0 0 0 0 1
variable angle8 equal 5.497787
region raceway8 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle8 0 0 0 0 0 1

region raceways union 8 raceway1 raceway2 raceway3 raceway4 raceway5 raceway6 raceway7 raceway8

# burden weight
include         ../DEM/in.pressure_profile
# Pressure profile definition for LIGGGHTS

# reactor radius = 0.500000 m
# R1 = 0.150000 m
# R2 = 0.400000 m
# number of bins = 12

# Region01
region   forceReg01		 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side in  	# center region
region   forceReg01		 cylinder z 0 0 0.15	0.7 ${forceZmax} side in  	
region   forceReg01		 cylinder z 0 0 0.15	0.7 0.8 side in  	
variable nForceReg01	 equal count(all,forceReg01) 								# number of particles inside
variable forceRegArea01	 equal 0.070686												# ring area (m2)
variable forceFact01	 equal 1												# force factor [0-1] (-)
variable totalForce01	 equal "-(v_forceFact01*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea01"	# total force (N)
variable forcePerPart01	 equal "v_totalForce01/(v_nForceReg01+1e-3)"				# force per particle (N)
fix      force01		 all addforce 0 0 v_forcePerPart01 region forceReg01		# apply force

# Region02
region   forceRegIn02	 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 ${forceZmax} side out 	
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 0.8 side out 	
region   forceRegOut02	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side in  	
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 0.8 side in  	
region   forceReg02		 intersect 2 forceRegIn02 forceRegOut02						# annular region
variable nForceReg02	 equal count(all,forceReg02) 								# number of particles inside
variable forceRegArea02	 equal 0.020998												# ring area (m2)
variable forceFact02	 equal 0.95833												# force factor [0-1] (-)
variable totalForce02	 equal "-(v_forceFact02*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea02"	# total force (N)
variable forcePerPart02	 equal "v_totalForce02/(v_nForceReg02+1e-3)"				# force per particle (N)
fix      force02		 all addforce 0 0 v_forcePerPart02 region forceReg02		# apply force

# Region03
region   forceRegIn03	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side out 	
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 0.8 side out 	
region   forceRegOut03	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side in  	
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 0.8 side in  	
region   forceReg03		 intersect 2 forceRegIn03 forceRegOut03						# annular region
variable nForceReg03	 equal count(all,forceReg03) 								# number of particles inside
variable forceRegArea03	 equal 0.023726												# ring area (m2)
variable forceFact03	 equal 0.875												# force factor [0-1] (-)
variable totalForce03	 equal "-(v_forceFact03*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea03"	# total force (N)
variable forcePerPart03	 equal "v_totalForce03/(v_nForceReg03+1e-3)"				# force per particle (N)
fix      force03		 all addforce 0 0 v_forcePerPart03 region forceReg03		# apply force

# Region04
region   forceRegIn04	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side out 	
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 0.8 side out 	
region   forceRegOut04	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side in  	
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 0.8 side in  	
region   forceReg04		 intersect 2 forceRegIn04 forceRegOut04						# annular region
variable nForceReg04	 equal count(all,forceReg04) 								# number of particles inside
variable forceRegArea04	 equal 0.026453												# ring area (m2)
variable forceFact04	 equal 0.79167												# force factor [0-1] (-)
variable totalForce04	 equal "-(v_forceFact04*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea04"	# total force (N)
variable forcePerPart04	 equal "v_totalForce04/(v_nForceReg04+1e-3)"				# force per particle (N)
fix      force04		 all addforce 0 0 v_forcePerPart04 region forceReg04		# apply force

# Region05
region   forceRegIn05	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side out 	
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 0.8 side out 	
region   forceRegOut05	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side in  	
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 0.8 side in  	
region   forceReg05		 intersect 2 forceRegIn05 forceRegOut05						# annular region
variable nForceReg05	 equal count(all,forceReg05) 								# number of particles inside
variable forceRegArea05	 equal 0.02918												# ring area (m2)
variable forceFact05	 equal 0.70833												# force factor [0-1] (-)
variable totalForce05	 equal "-(v_forceFact05*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea05"	# total force (N)
variable forcePerPart05	 equal "v_totalForce05/(v_nForceReg05+1e-3)"				# force per particle (N)
fix      force05		 all addforce 0 0 v_forcePerPart05 region forceReg05		# apply force

# Region06
region   forceRegIn06	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side out 	
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 0.8 side out 	
region   forceRegOut06	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side in  	
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 0.8 side in  	
region   forceReg06		 intersect 2 forceRegIn06 forceRegOut06						# annular region
variable nForceReg06	 equal count(all,forceReg06) 								# number of particles inside
variable forceRegArea06	 equal 0.031907												# ring area (m2)
variable forceFact06	 equal 0.625												# force factor [0-1] (-)
variable totalForce06	 equal "-(v_forceFact06*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea06"	# total force (N)
variable forcePerPart06	 equal "v_totalForce06/(v_nForceReg06+1e-3)"				# force per particle (N)
fix      force06		 all addforce 0 0 v_forcePerPart06 region forceReg06		# apply force

# Region07
region   forceRegIn07	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side out 	
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 0.8 side out 	
region   forceRegOut07	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 ${forceZmax} side in  	
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 0.8 side in  	
region   forceReg07		 intersect 2 forceRegIn07 forceRegOut07						# annular region
variable nForceReg07	 equal count(all,forceReg07) 								# number of particles inside
variable forceRegArea07	 equal 0.034634												# ring area (m2)
variable forceFact07	 equal 0.54167												# force factor [0-1] (-)
variable totalForce07	 equal "-(v_forceFact07*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea07"	# total force (N)
variable forcePerPart07	 equal "v_totalForce07/(v_nForceReg07+1e-3)"				# force per particle (N)
fix      force07		 all addforce 0 0 v_forcePerPart07 region forceReg07		# apply force

# Region08
region   forceRegIn08	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 ${forceZmax} side out 	
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 0.8 side out 	
region   forceRegOut08	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side in  	
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 0.8 side in  	
region   forceReg08		 intersect 2 forceRegIn08 forceRegOut08						# annular region
variable nForceReg08	 equal count(all,forceReg08) 								# number of particles inside
variable forceRegArea08	 equal 0.037361												# ring area (m2)
variable forceFact08	 equal 0.45833												# force factor [0-1] (-)
variable totalForce08	 equal "-(v_forceFact08*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea08"	# total force (N)
variable forcePerPart08	 equal "v_totalForce08/(v_nForceReg08+1e-3)"				# force per particle (N)
fix      force08		 all addforce 0 0 v_forcePerPart08 region forceReg08		# apply force

# Region09
region   forceRegIn09	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side out 	
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 0.8 side out 	
region   forceRegOut09	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side in  	
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 0.8 side in  	
region   forceReg09		 intersect 2 forceRegIn09 forceRegOut09						# annular region
variable nForceReg09	 equal count(all,forceReg09) 								# number of particles inside
variable forceRegArea09	 equal 0.040088												# ring area (m2)
variable forceFact09	 equal 0.375												# force factor [0-1] (-)
variable totalForce09	 equal "-(v_forceFact09*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea09"	# total force (N)
variable forcePerPart09	 equal "v_totalForce09/(v_nForceReg09+1e-3)"				# force per particle (N)
fix      force09		 all addforce 0 0 v_forcePerPart09 region forceReg09		# apply force

# Region10
region   forceRegIn10	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side out 	
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 0.8 side out 	
region   forceRegOut10	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side in  	
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 0.8 side in  	
region   forceReg10		 intersect 2 forceRegIn10 forceRegOut10						# annular region
variable nForceReg10	 equal count(all,forceReg10) 								# number of particles inside
variable forceRegArea10	 equal 0.042815												# ring area (m2)
variable forceFact10	 equal 0.29167												# force factor [0-1] (-)
variable totalForce10	 equal "-(v_forceFact10*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea10"	# total force (N)
variable forcePerPart10	 equal "v_totalForce10/(v_nForceReg10+1e-3)"				# force per particle (N)
fix      force10		 all addforce 0 0 v_forcePerPart10 region forceReg10		# apply force

# Region11
region   forceRegIn11	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side out 	
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 0.8 side out 	
region   forceRegOut11	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side in  	
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 0.8 side in  	
region   forceReg11		 intersect 2 forceRegIn11 forceRegOut11						# annular region
variable nForceReg11	 equal count(all,forceReg11) 								# number of particles inside
variable forceRegArea11	 equal 0.045542												# ring area (m2)
variable forceFact11	 equal 0.20833												# force factor [0-1] (-)
variable totalForce11	 equal "-(v_forceFact11*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea11"	# total force (N)
variable forcePerPart11	 equal "v_totalForce11/(v_nForceReg11+1e-3)"				# force per particle (N)
fix      force11		 all addforce 0 0 v_forcePerPart11 region forceReg11		# apply force

# Region12
region   forceRegIn12	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side out 	
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 0.8 side out 	
region   forceRegOut12	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side in  	
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 0.8 side in  	
region   forceReg12		 intersect 2 forceRegIn12 forceRegOut12						# annular region
variable nForceReg12	 equal count(all,forceReg12) 								# number of particles inside
variable forceRegArea12	 equal 0.048269												# ring area (m2)
variable forceFact12	 equal 0.125												# force factor [0-1] (-)
variable totalForce12	 equal "-(v_forceFact12*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea12"	# total force (N)
variable forcePerPart12	 equal "v_totalForce12/(v_nForceReg12+1e-3)"				# force per particle (N)
fix      force12		 all addforce 0 0 v_forcePerPart12 region forceReg12		# apply force

# Region13
region   forceRegIn13	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side out 	
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 0.8 side out 	
region   forceRegOut13	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 ${forceZmax} side in  	
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 0.8 side in  	
region   forceReg13		 intersect 2 forceRegIn13 forceRegOut13						# annular region
variable nForceReg13	 equal count(all,forceReg13) 								# number of particles inside
variable forceRegArea13	 equal 0.050996												# ring area (m2)
variable forceFact13	 equal 0.041667												# force factor [0-1] (-)
variable totalForce13	 equal "-(v_forceFact13*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea13"	# total force (N)
variable forcePerPart13	 equal "v_totalForce13/(v_nForceReg13+1e-3)"				# force per particle (N)
fix      force13		 all addforce 0 0 v_forcePerPart13 region forceReg13		# apply force

# Region14
region   forceRegIn14	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 ${forceZmax} side out 	
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 0.8 side out 	
region   forceRegOut14	 cylinder z 0 0 0.5	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 ${forceZmax} side in  	
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 0.8 side in  	
region   forceReg14		 intersect 2 forceRegIn14 forceRegOut14						# annular region
variable nForceReg14	 equal count(all,forceReg14) 								# number of particles inside
variable forceRegArea14	 equal 0.28274												# ring area (m2)
variable forceFact14	 equal 0												# force factor [0-1] (-)
variable totalForce14	 equal "-(v_forceFact14*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea14"	# total force (N)
variable forcePerPart14	 equal "v_totalForce14/(v_nForceReg14+1e-3)"				# force per particle (N)
fix      force14		 all addforce 0 0 v_forcePerPart14 region forceReg14		# apply force

variable totalForce		 equal "v_forcePerPart01*v_nForceReg01+v_forcePerPart02*v_nForceReg02+v_forcePerPart03*v_nForceReg03+v_forcePerPart04*v_nForceReg04+v_forcePerPart05*v_nForceReg05+v_forcePerPart06*v_nForceReg06+v_forcePerPart07*v_nForceReg07+v_forcePerPart08*v_nForceReg08+v_forcePerPart09*v_nForceReg09+v_forcePerPart10*v_nForceReg10+v_forcePerPart11*v_nForceReg11+v_forcePerPart12*v_nForceReg12+v_forcePerPart13*v_nForceReg13+v_forcePerPart14*v_nForceReg14" 	# sum of all forces (N)
variable nForceReg		 equal "v_nForceReg01+v_nForceReg02+v_nForceReg03+v_nForceReg04+v_nForceReg05+v_nForceReg06+v_nForceReg07+v_nForceReg08+v_nForceReg09+v_nForceReg10+v_nForceReg11+v_nForceReg12+v_nForceReg13+v_nForceReg14" 	# sum of all numbers of particles (N)
variable avForcePerPart	 equal "v_totalForce/(v_nForceReg+1e-3)"	# average force per particle (N)

# insert in insertion volume
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every ${delIntSteps} overlapcheck yes region insShellReg volumefraction_region 0.7
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every 1000 overlapcheck yes region insShellReg volumefraction_region 0.7
INFO: Resetting random generator for region insShellReg
Resetting global state of Fix ins3 Style insert/pack from restart file info
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every ${delIntSteps} overlapcheck yes region insCoreReg  volumefraction_region 0.7
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every 1000 overlapcheck yes region insCoreReg  volumefraction_region 0.7
INFO: Resetting random generator for region insCoreReg
Resetting global state of Fix ins4 Style insert/pack from restart file info

######################################

# apply nve integration to all particles
fix             integr all nve/sphere

# output settings
thermo_style    custom step time atoms ke v_totalForce v_avForcePerPart v_nDelRun
thermo          10

# dump settings
dump            dmp all custom 5000 ../DEM/post/dump*.liggghts_run id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius density f_Temp[0] f_convectiveHeatFlux[0] f_convectiveMassFlux[0]
#5000
run             0
Resetting global state of Fix contacthistory Style contacthistory from restart file info
Resetting per-atom state of Fix contacthistory Style contacthistory from restart file info
Setting up run ...
Import and parallelization of mesh sides containing 2592 triangle(s) successful
Import and parallelization of mesh bottom containing 1024 triangle(s) successful
INFO: Resetting random generator for region insShellReg
INFO: Particle insertion ins3: inserting every 1000 steps
INFO: Resetting random generator for region insCoreReg
INFO: Particle insertion ins4: inserting every 1000 steps
Memory usage per processor = 24.93 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
ERROR: Divide by 0 in variable formula (/home/ht45454/CFDEM/LIGGGHTS/src/variable.cpp:1569)
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[854,1],0]
  Exit code:    1
--------------------------------------------------------------------------

//      //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Jan 18 2025
Time   : 10:41:05
Host   : "TUE035485"
PID    : 10839
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.10840"
"TUE035485.10841"
"TUE035485.10842"
"TUE035485.10843"
"TUE035485.10844"
"TUE035485.10845"
"TUE035485.10846"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0


PIMPLE: Operating solver in PISO mode


Reading momentum exchange field Ksl


Reading voidfraction field voidfraction = (Vgas/Vparticle)

Reading particle velocity field Us

Reading field p_rgh

Reading field U

Reading/calculating face flux field phi

Selecting incompressible transport model Newtonian
Selecting incompressible transport model Newtonian
Reading/creating thermal fields

Reading/creating concentration fields

Selecting turbulence model type laminar

Reading g

Reading hRef
Calculating field g.h

No finite volume options present

GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
time step continuity errors : sum local = 0, global = 0, cumulative = 0
Courant Number mean: 0 max: 0
Selecting dataExchangeModel twoWayMPI
Starting up LIGGGHTS for first time execution
Executing input script '../DEM/in.liggghts_run'
LIGGGHTS (Version LIGGGHTS-PFM 24.01, compiled 2025-01-17-18:01:04 by ht45454, git commit d075b97762ce4302707903718dda170920e630bd, based on LAMMPS 23 Nov 2013)
log             ../log/log.liggghts_run
thermo_log      ../log/thermo.txt

atom_style      granular
atom_modify     map array
boundary        f f f
newton          off

communicate     single vel yes

units           si
processors      2 2 2

# read the restart file
read_restart    ../DEM/post/restart/liggghts.restartSequence
Reading restart file ...
  orthogonal box = (-0.5 -0.5 -0.0025) to (0.5 0.5 1)
  2 by 2 by 2 MPI processor grid
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
  80888 atoms

neighbor        0.007 bin
neigh_modify    delay 0

# contact model
include         ../DEM/in.contact_settings
# Material properties required for granular pair styles
fix             m1 all property/global youngsModulus	                peratomtype       5.e6
fix             m2 all property/global poissonsRatio 	                peratomtype	  0.3
fix             m3 all property/global coefficientRestitution           peratomtypepair 1 0.3
fix             m4 all property/global coefficientFriction 	        peratomtypepair 1 0.5
fix             m5 all property/global coefficientRollingFriction       peratomtypepair 1 0.2
fix             m6 all property/global coefficientRollingViscousDamping peratomtypepair 1 0.3

# pair style
pair_style	gran model hertz tangential history rolling_friction epsd
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
pair_coeff  	* *

# hearth settings
include         ../DEM/in.hearth_settings
# hearth settings
variable        hearthRadius  equal 0.5     # hearth radius (m)
variable        coreRadius    equal 0.15    # radius of core region (m)
variable        liquidLevel   equal 0.4     # initial liquid level (m) [set in setFieldsDict as well!]
variable        liquidDensity equal 6700.   # liquid density (kg/m3)

# heat/mass transfer settings
variable        particlekInit equal 5000    # particle thermal conductivity during init (W/Km)
variable        particlekRun  equal 40.0    # particle thermal conductivity during run  (W/Km) [sped up! 2.0*20!]
variable        particleCp    equal 870     # particle heat capacity (J/kgK)
variable        Tinlet        equal 1823.15 # particle inlet temperature (K) [set in CFD as well!]
variable        Tinit         equal 1623.15 # initial temperature (K) [set in CFD as well!]
variable        Twall         equal 1423.15 # wall temperature (K) [set in CFD as well!]
variable        rRemove       equal 0.001   # radius at which dissolved particles are removed (m)

# zone definitions
variable        forceZmin     equal 0.70    # lower boundary of force zone (m)
variable        forceZmax     equal 0.80    # upper boundary of force zone (m)
variable        insZmin       equal 0.70    # lower boundary of insertion zone (m)
variable        insZmax       equal 0.80    # upper boundary of insertion zone (m)

region          bedReg        cylinder z 0 0 ${hearthRadius} 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            0.8
region          coreReg       cylinder z 0 0 ${coreRadius}   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            0.8 side in
region          invCoreReg    cylinder z 0 0 ${coreRadius}   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            0.8 side out
region          shellReg      intersect 2 bedReg invCoreReg

region		insReg        cylinder z 0 0 ${hearthRadius} ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   0.8
region          insCoreReg    intersect 2 insReg coreReg
region          insShellReg   intersect 2 insReg invCoreReg

region		forceReg      cylinder z 0 0 ${hearthRadius} ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 0.8
region          freeboard     cylinder z 0 0 ${hearthRadius} ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 0.8 INF

region          mushroom      block 0.4 0.5 -0.05 0.05 0.2 0.3 side out # mushroom cutout
region          initReg       intersect 2 bedReg mushroom # entire bed minus mushroom
region          initCoreReg   intersect 2 initReg coreReg
region          initShellReg  intersect 2 initReg invCoreReg

# total burden weight
variable        pressureMin   equal 2000    # lower pressure value (Pa), near wall
variable        pressureMax   equal 20000   # upper pressure value (Pa), near core

# kinetic energy
variable        kinEn         equal ke      # kinetic energy (J)
variable        kinEnMax      equal 2.      # kinetic energy threshold for init (J)

# coke removal settings
variable        cokeRateInit  equal 20.     # coke combustion rate during init (kg/s)
variable        cokeRateRun   equal 1.      # coke combustion rate during run (kg/s)
variable        delInt        equal 0.1     # removal interval (s) [set in liggghtsCommands as well!]

variable        nFreeboard    equal count(all,freeboard)

variable        nRaceways     equal count(all,raceways)
variable        mRaceways     equal mass(all,raceways)
variable        avMass        equal "v_mRaceways/(v_nRaceways+1e-3)"

variable        delIntSteps   equal "floor(v_delInt/dt)"

variable        nDelInit      equal "v_delIntSteps*dt*v_cokeRateInit/v_avMass"
variable        fDelInit      equal "v_nDelInit/(v_nRaceways+1e-3)"

variable        nDelRun       equal "v_delIntSteps*dt*v_cokeRateRun/v_avMass"
variable        fDelRun       equal "v_nDelRun/(v_nRaceways+1e-3)"




# timestep
timestep        1e-4

# cfd coupling
fix             cfd all couple/cfd couple_every 100 mpi
nevery as specified in LIGGGHTS is overriden by calling external program (/home/ht45454/CFDEM/LIGGGHTS/src/cfd_datacoupling_mpi.cpp:56)
fix             cfd2 all couple/cfd/force/implicit

# heat transfer
fix             m7 all property/global thermalConductivity peratomtype ${particlekRun} # lambda in [W/(K*m)]
fix             m7 all property/global thermalConductivity peratomtype 40 
fix             m8 all property/global thermalCapacity     peratomtype ${particleCp}   # cp in [J/(kg*K)]
fix             m8 all property/global thermalCapacity     peratomtype 870   
fix             heattransfer all heat/gran/conduction initial_temperature ${Tinlet}
fix             heattransfer all heat/gran/conduction initial_temperature 1823.15
Resetting global state of Fix Temp Style property/atom from restart file info
Resetting per-atom state of Fix Temp Style property/atom from restart file info
Resetting global state of Fix heatFlux Style property/atom from restart file info
Resetting per-atom state of Fix heatFlux Style property/atom from restart file info
Resetting global state of Fix heatSource Style property/atom from restart file info
Resetting per-atom state of Fix heatSource Style property/atom from restart file info
fix             cfd3 all couple/cfd/convection T0 ${Tinlet}
fix             cfd3 all couple/cfd/convection T0 1823.15

# mass transfer
fix             cfd4 all couple/cfd/dissolve rmin ${rRemove}
fix             cfd4 all couple/cfd/dissolve rmin 0.001

# walls
include         ../DEM/in.wall_settings
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature ${Twall} curvature 1e-5
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature 1423.15 curvature 1e-5
Resetting global state of Fix sides Style mesh/surface from restart file info
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature ${Twall}
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature 1423.15
Resetting global state of Fix bottom Style mesh/surface from restart file info
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature ${Twall}
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature 1423.15
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
Resetting global state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting global state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting global state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting global state of Fix tracker_bottom Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_bottom Style contacthistory/mesh from restart file info

# gravity
fix		gravi all gravity 9.81 vector 0.0 0.0 -1.0

######################################

# particle distribution
include	   	../DEM/in.particleSizeDistribution1
# Particle size distribution for LIGGGHTS

# mean radius = 0.0100000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts1 all particletemplate/sphere 10007 atom_type 1 density constant 900 radius constant 0.01
Resetting global state of Fix pts1 Style particletemplate/sphere from restart file info

fix	pdd1 all particledistribution/discrete 10009 1 pts1 1.000000
Fix particledistribution/discrete (id pdd1): distribution based on mass%:
    pts1: d=2.000000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd1): distribution based on number%:
    pts1: d=2.000000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd1 Style particledistribution/discrete from restart file info
include	   	../DEM/in.particleSizeDistribution2
# Particle size distribution for LIGGGHTS

# mean radius = 0.0125000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts2 all particletemplate/sphere 10037 atom_type 1 density constant 900 radius constant 0.0125
Resetting global state of Fix pts2 Style particletemplate/sphere from restart file info

fix	pdd2 all particledistribution/discrete 10039 1 pts2 1.000000
Fix particledistribution/discrete (id pdd2): distribution based on mass%:
    pts2: d=2.500000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd2): distribution based on number%:
    pts2: d=2.500000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd2 Style particledistribution/discrete from restart file info

# raceways
include		../DEM/in.raceways
# Raceway definition for LIGGGHTS

# reactor radius = 0.500000 m
# raceway height = 0.500000 m
# raceway diameter = 0.100000 m
# raceway length = 0.100000 m
# number of raceways = 8

variable angle1 equal 0.000000
region raceway1 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle1 0 0 0 0 0 1
variable angle2 equal 0.785398
region raceway2 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle2 0 0 0 0 0 1
variable angle3 equal 1.570796
region raceway3 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle3 0 0 0 0 0 1
variable angle4 equal 2.356194
region raceway4 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle4 0 0 0 0 0 1
variable angle5 equal 3.141593
region raceway5 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle5 0 0 0 0 0 1
variable angle6 equal 3.926991
region raceway6 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle6 0 0 0 0 0 1
variable angle7 equal 4.712389
region raceway7 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle7 0 0 0 0 0 1
variable angle8 equal 5.497787
region raceway8 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle8 0 0 0 0 0 1

region raceways union 8 raceway1 raceway2 raceway3 raceway4 raceway5 raceway6 raceway7 raceway8

# burden weight
include         ../DEM/in.pressure_profile
# Pressure profile definition for LIGGGHTS

# reactor radius = 0.500000 m
# R1 = 0.150000 m
# R2 = 0.400000 m
# number of bins = 12

# Region01
region   forceReg01		 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side in  	# center region
region   forceReg01		 cylinder z 0 0 0.15	0.7 ${forceZmax} side in  	
region   forceReg01		 cylinder z 0 0 0.15	0.7 0.8 side in  	
variable nForceReg01	 equal count(all,forceReg01) 								# number of particles inside
variable forceRegArea01	 equal 0.070686												# ring area (m2)
variable forceFact01	 equal 1												# force factor [0-1] (-)
variable totalForce01	 equal "-(v_forceFact01*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea01"	# total force (N)
variable forcePerPart01	 equal "v_totalForce01/(v_nForceReg01+1e-3)"				# force per particle (N)
fix      force01		 all addforce 0 0 v_forcePerPart01 region forceReg01		# apply force

# Region02
region   forceRegIn02	 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 ${forceZmax} side out 	
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 0.8 side out 	
region   forceRegOut02	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side in  	
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 0.8 side in  	
region   forceReg02		 intersect 2 forceRegIn02 forceRegOut02						# annular region
variable nForceReg02	 equal count(all,forceReg02) 								# number of particles inside
variable forceRegArea02	 equal 0.020998												# ring area (m2)
variable forceFact02	 equal 0.95833												# force factor [0-1] (-)
variable totalForce02	 equal "-(v_forceFact02*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea02"	# total force (N)
variable forcePerPart02	 equal "v_totalForce02/(v_nForceReg02+1e-3)"				# force per particle (N)
fix      force02		 all addforce 0 0 v_forcePerPart02 region forceReg02		# apply force

# Region03
region   forceRegIn03	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side out 	
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 0.8 side out 	
region   forceRegOut03	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side in  	
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 0.8 side in  	
region   forceReg03		 intersect 2 forceRegIn03 forceRegOut03						# annular region
variable nForceReg03	 equal count(all,forceReg03) 								# number of particles inside
variable forceRegArea03	 equal 0.023726												# ring area (m2)
variable forceFact03	 equal 0.875												# force factor [0-1] (-)
variable totalForce03	 equal "-(v_forceFact03*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea03"	# total force (N)
variable forcePerPart03	 equal "v_totalForce03/(v_nForceReg03+1e-3)"				# force per particle (N)
fix      force03		 all addforce 0 0 v_forcePerPart03 region forceReg03		# apply force

# Region04
region   forceRegIn04	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side out 	
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 0.8 side out 	
region   forceRegOut04	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side in  	
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 0.8 side in  	
region   forceReg04		 intersect 2 forceRegIn04 forceRegOut04						# annular region
variable nForceReg04	 equal count(all,forceReg04) 								# number of particles inside
variable forceRegArea04	 equal 0.026453												# ring area (m2)
variable forceFact04	 equal 0.79167												# force factor [0-1] (-)
variable totalForce04	 equal "-(v_forceFact04*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea04"	# total force (N)
variable forcePerPart04	 equal "v_totalForce04/(v_nForceReg04+1e-3)"				# force per particle (N)
fix      force04		 all addforce 0 0 v_forcePerPart04 region forceReg04		# apply force

# Region05
region   forceRegIn05	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side out 	
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 0.8 side out 	
region   forceRegOut05	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side in  	
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 0.8 side in  	
region   forceReg05		 intersect 2 forceRegIn05 forceRegOut05						# annular region
variable nForceReg05	 equal count(all,forceReg05) 								# number of particles inside
variable forceRegArea05	 equal 0.02918												# ring area (m2)
variable forceFact05	 equal 0.70833												# force factor [0-1] (-)
variable totalForce05	 equal "-(v_forceFact05*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea05"	# total force (N)
variable forcePerPart05	 equal "v_totalForce05/(v_nForceReg05+1e-3)"				# force per particle (N)
fix      force05		 all addforce 0 0 v_forcePerPart05 region forceReg05		# apply force

# Region06
region   forceRegIn06	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side out 	
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 0.8 side out 	
region   forceRegOut06	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side in  	
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 0.8 side in  	
region   forceReg06		 intersect 2 forceRegIn06 forceRegOut06						# annular region
variable nForceReg06	 equal count(all,forceReg06) 								# number of particles inside
variable forceRegArea06	 equal 0.031907												# ring area (m2)
variable forceFact06	 equal 0.625												# force factor [0-1] (-)
variable totalForce06	 equal "-(v_forceFact06*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea06"	# total force (N)
variable forcePerPart06	 equal "v_totalForce06/(v_nForceReg06+1e-3)"				# force per particle (N)
fix      force06		 all addforce 0 0 v_forcePerPart06 region forceReg06		# apply force

# Region07
region   forceRegIn07	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side out 	
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 0.8 side out 	
region   forceRegOut07	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 ${forceZmax} side in  	
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 0.8 side in  	
region   forceReg07		 intersect 2 forceRegIn07 forceRegOut07						# annular region
variable nForceReg07	 equal count(all,forceReg07) 								# number of particles inside
variable forceRegArea07	 equal 0.034634												# ring area (m2)
variable forceFact07	 equal 0.54167												# force factor [0-1] (-)
variable totalForce07	 equal "-(v_forceFact07*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea07"	# total force (N)
variable forcePerPart07	 equal "v_totalForce07/(v_nForceReg07+1e-3)"				# force per particle (N)
fix      force07		 all addforce 0 0 v_forcePerPart07 region forceReg07		# apply force

# Region08
region   forceRegIn08	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 ${forceZmax} side out 	
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 0.8 side out 	
region   forceRegOut08	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side in  	
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 0.8 side in  	
region   forceReg08		 intersect 2 forceRegIn08 forceRegOut08						# annular region
variable nForceReg08	 equal count(all,forceReg08) 								# number of particles inside
variable forceRegArea08	 equal 0.037361												# ring area (m2)
variable forceFact08	 equal 0.45833												# force factor [0-1] (-)
variable totalForce08	 equal "-(v_forceFact08*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea08"	# total force (N)
variable forcePerPart08	 equal "v_totalForce08/(v_nForceReg08+1e-3)"				# force per particle (N)
fix      force08		 all addforce 0 0 v_forcePerPart08 region forceReg08		# apply force

# Region09
region   forceRegIn09	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side out 	
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 0.8 side out 	
region   forceRegOut09	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side in  	
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 0.8 side in  	
region   forceReg09		 intersect 2 forceRegIn09 forceRegOut09						# annular region
variable nForceReg09	 equal count(all,forceReg09) 								# number of particles inside
variable forceRegArea09	 equal 0.040088												# ring area (m2)
variable forceFact09	 equal 0.375												# force factor [0-1] (-)
variable totalForce09	 equal "-(v_forceFact09*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea09"	# total force (N)
variable forcePerPart09	 equal "v_totalForce09/(v_nForceReg09+1e-3)"				# force per particle (N)
fix      force09		 all addforce 0 0 v_forcePerPart09 region forceReg09		# apply force

# Region10
region   forceRegIn10	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side out 	
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 0.8 side out 	
region   forceRegOut10	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side in  	
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 0.8 side in  	
region   forceReg10		 intersect 2 forceRegIn10 forceRegOut10						# annular region
variable nForceReg10	 equal count(all,forceReg10) 								# number of particles inside
variable forceRegArea10	 equal 0.042815												# ring area (m2)
variable forceFact10	 equal 0.29167												# force factor [0-1] (-)
variable totalForce10	 equal "-(v_forceFact10*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea10"	# total force (N)
variable forcePerPart10	 equal "v_totalForce10/(v_nForceReg10+1e-3)"				# force per particle (N)
fix      force10		 all addforce 0 0 v_forcePerPart10 region forceReg10		# apply force

# Region11
region   forceRegIn11	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side out 	
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 0.8 side out 	
region   forceRegOut11	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side in  	
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 0.8 side in  	
region   forceReg11		 intersect 2 forceRegIn11 forceRegOut11						# annular region
variable nForceReg11	 equal count(all,forceReg11) 								# number of particles inside
variable forceRegArea11	 equal 0.045542												# ring area (m2)
variable forceFact11	 equal 0.20833												# force factor [0-1] (-)
variable totalForce11	 equal "-(v_forceFact11*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea11"	# total force (N)
variable forcePerPart11	 equal "v_totalForce11/(v_nForceReg11+1e-3)"				# force per particle (N)
fix      force11		 all addforce 0 0 v_forcePerPart11 region forceReg11		# apply force

# Region12
region   forceRegIn12	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side out 	
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 0.8 side out 	
region   forceRegOut12	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side in  	
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 0.8 side in  	
region   forceReg12		 intersect 2 forceRegIn12 forceRegOut12						# annular region
variable nForceReg12	 equal count(all,forceReg12) 								# number of particles inside
variable forceRegArea12	 equal 0.048269												# ring area (m2)
variable forceFact12	 equal 0.125												# force factor [0-1] (-)
variable totalForce12	 equal "-(v_forceFact12*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea12"	# total force (N)
variable forcePerPart12	 equal "v_totalForce12/(v_nForceReg12+1e-3)"				# force per particle (N)
fix      force12		 all addforce 0 0 v_forcePerPart12 region forceReg12		# apply force

# Region13
region   forceRegIn13	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side out 	
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 0.8 side out 	
region   forceRegOut13	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 ${forceZmax} side in  	
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 0.8 side in  	
region   forceReg13		 intersect 2 forceRegIn13 forceRegOut13						# annular region
variable nForceReg13	 equal count(all,forceReg13) 								# number of particles inside
variable forceRegArea13	 equal 0.050996												# ring area (m2)
variable forceFact13	 equal 0.041667												# force factor [0-1] (-)
variable totalForce13	 equal "-(v_forceFact13*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea13"	# total force (N)
variable forcePerPart13	 equal "v_totalForce13/(v_nForceReg13+1e-3)"				# force per particle (N)
fix      force13		 all addforce 0 0 v_forcePerPart13 region forceReg13		# apply force

# Region14
region   forceRegIn14	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 ${forceZmax} side out 	
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 0.8 side out 	
region   forceRegOut14	 cylinder z 0 0 0.5	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 ${forceZmax} side in  	
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 0.8 side in  	
region   forceReg14		 intersect 2 forceRegIn14 forceRegOut14						# annular region
variable nForceReg14	 equal count(all,forceReg14) 								# number of particles inside
variable forceRegArea14	 equal 0.28274												# ring area (m2)
variable forceFact14	 equal 0												# force factor [0-1] (-)
variable totalForce14	 equal "-(v_forceFact14*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea14"	# total force (N)
variable forcePerPart14	 equal "v_totalForce14/(v_nForceReg14+1e-3)"				# force per particle (N)
fix      force14		 all addforce 0 0 v_forcePerPart14 region forceReg14		# apply force

variable totalForce		 equal "v_forcePerPart01*v_nForceReg01+v_forcePerPart02*v_nForceReg02+v_forcePerPart03*v_nForceReg03+v_forcePerPart04*v_nForceReg04+v_forcePerPart05*v_nForceReg05+v_forcePerPart06*v_nForceReg06+v_forcePerPart07*v_nForceReg07+v_forcePerPart08*v_nForceReg08+v_forcePerPart09*v_nForceReg09+v_forcePerPart10*v_nForceReg10+v_forcePerPart11*v_nForceReg11+v_forcePerPart12*v_nForceReg12+v_forcePerPart13*v_nForceReg13+v_forcePerPart14*v_nForceReg14" 	# sum of all forces (N)
variable nForceReg		 equal "v_nForceReg01+v_nForceReg02+v_nForceReg03+v_nForceReg04+v_nForceReg05+v_nForceReg06+v_nForceReg07+v_nForceReg08+v_nForceReg09+v_nForceReg10+v_nForceReg11+v_nForceReg12+v_nForceReg13+v_nForceReg14" 	# sum of all numbers of particles (N)
variable avForcePerPart	 equal "v_totalForce/(v_nForceReg+1e-3)"	# average force per particle (N)

# insert in insertion volume
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every ${delIntSteps} overlapcheck yes region insShellReg volumefraction_region 0.7
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every 1000 overlapcheck yes region insShellReg volumefraction_region 0.7
INFO: Resetting random generator for region insShellReg
Resetting global state of Fix ins3 Style insert/pack from restart file info
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every ${delIntSteps} overlapcheck yes region insCoreReg  volumefraction_region 0.7
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every 1000 overlapcheck yes region insCoreReg  volumefraction_region 0.7
INFO: Resetting random generator for region insCoreReg
Resetting global state of Fix ins4 Style insert/pack from restart file info

######################################

# apply nve integration to all particles
fix             integr all nve/sphere

# output settings
thermo_style    custom step time atoms ke v_totalForce v_avForcePerPart v_nDelRun
thermo          10

# dump settings
dump            dmp all custom 5000 ../DEM/post/dump*.liggghts_run id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius density f_Temp[0] f_convectiveHeatFlux[0] f_convectiveMassFlux[0]
#5000
run             0
Resetting global state of Fix contacthistory Style contacthistory from restart file info
Resetting per-atom state of Fix contacthistory Style contacthistory from restart file info
Setting up run ...
Import and parallelization of mesh sides containing 2592 triangle(s) successful
Import and parallelization of mesh bottom containing 1024 triangle(s) successful
INFO: Resetting random generator for region insShellReg
INFO: Particle insertion ins3: inserting every 1000 steps
INFO: Resetting random generator for region insCoreReg
INFO: Particle insertion ins4: inserting every 1000 steps
Memory usage per processor = 24.93 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
ERROR: Divide by 0 in variable formula (/home/ht45454/CFDEM/LIGGGHTS/src/variable.cpp:1569)
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[3359,1],0]
  Exit code:    1
--------------------------------------------------------------------------

//      //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Jan 18 2025
Time   : 10:42:11
Host   : "TUE035485"
PID    : 11156
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.11157"
"TUE035485.11158"
"TUE035485.11159"
"TUE035485.11160"
"TUE035485.11161"
"TUE035485.11162"
"TUE035485.11163"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0


PIMPLE: Operating solver in PISO mode


Reading momentum exchange field Ksl


Reading voidfraction field voidfraction = (Vgas/Vparticle)

Reading particle velocity field Us

Reading field p_rgh

Reading field U

Reading/calculating face flux field phi

Selecting incompressible transport model Newtonian
Selecting incompressible transport model Newtonian
Reading/creating thermal fields

Reading/creating concentration fields

Selecting turbulence model type laminar

Reading g

Reading hRef
Calculating field g.h

No finite volume options present

GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
time step continuity errors : sum local = 0, global = 0, cumulative = 0
Courant Number mean: 0 max: 0
Selecting dataExchangeModel twoWayMPI
Starting up LIGGGHTS for first time execution
Executing input script '../DEM/in.liggghts_run'
LIGGGHTS (Version LIGGGHTS-PFM 24.01, compiled 2025-01-17-18:01:04 by ht45454, git commit d075b97762ce4302707903718dda170920e630bd, based on LAMMPS 23 Nov 2013)
log             ../log/log.liggghts_run
thermo_log      ../log/thermo.txt

atom_style      granular
atom_modify     map array
boundary        f f f
newton          off

communicate     single vel yes

units           si
processors      2 2 2

# read the restart file
read_restart    ../DEM/post/restart/liggghts.restartSequence
Reading restart file ...
  orthogonal box = (-0.5 -0.5 -0.0025) to (0.5 0.5 1)
  2 by 2 by 2 MPI processor grid
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
  80888 atoms

neighbor        0.007 bin
neigh_modify    delay 0

# contact model
include         ../DEM/in.contact_settings
# Material properties required for granular pair styles
fix             m1 all property/global youngsModulus	                peratomtype       5.e6
fix             m2 all property/global poissonsRatio 	                peratomtype	  0.3
fix             m3 all property/global coefficientRestitution           peratomtypepair 1 0.3
fix             m4 all property/global coefficientFriction 	        peratomtypepair 1 0.5
fix             m5 all property/global coefficientRollingFriction       peratomtypepair 1 0.2
fix             m6 all property/global coefficientRollingViscousDamping peratomtypepair 1 0.3

# pair style
pair_style	gran model hertz tangential history rolling_friction epsd
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
pair_coeff  	* *

# hearth settings
include         ../DEM/in.hearth_settings
# hearth settings
variable        hearthRadius  equal 0.5     # hearth radius (m)
variable        coreRadius    equal 0.15    # radius of core region (m)
variable        liquidLevel   equal 0.4     # initial liquid level (m) [set in setFieldsDict as well!]
variable        liquidDensity equal 6700.   # liquid density (kg/m3)

# heat/mass transfer settings
variable        particlekInit equal 5000    # particle thermal conductivity during init (W/Km)
variable        particlekRun  equal 40.0    # particle thermal conductivity during run  (W/Km) [sped up! 2.0*20!]
variable        particleCp    equal 870     # particle heat capacity (J/kgK)
variable        Tinlet        equal 1823.15 # particle inlet temperature (K) [set in CFD as well!]
variable        Tinit         equal 1623.15 # initial temperature (K) [set in CFD as well!]
variable        Twall         equal 1423.15 # wall temperature (K) [set in CFD as well!]
variable        rRemove       equal 0.001   # radius at which dissolved particles are removed (m)

# zone definitions
variable        forceZmin     equal 0.70    # lower boundary of force zone (m)
variable        forceZmax     equal 0.80    # upper boundary of force zone (m)
variable        insZmin       equal 0.70    # lower boundary of insertion zone (m)
variable        insZmax       equal 0.80    # upper boundary of insertion zone (m)

region          bedReg        cylinder z 0 0 ${hearthRadius} 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            0.8
region          coreReg       cylinder z 0 0 ${coreRadius}   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            0.8 side in
region          invCoreReg    cylinder z 0 0 ${coreRadius}   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            0.8 side out
region          shellReg      intersect 2 bedReg invCoreReg

region		insReg        cylinder z 0 0 ${hearthRadius} ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   0.8
region          insCoreReg    intersect 2 insReg coreReg
region          insShellReg   intersect 2 insReg invCoreReg

region		forceReg      cylinder z 0 0 ${hearthRadius} ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 0.8
region          freeboard     cylinder z 0 0 ${hearthRadius} ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 0.8 INF

region          mushroom      block 0.4 0.5 -0.05 0.05 0.2 0.3 side out # mushroom cutout
region          initReg       intersect 2 bedReg mushroom # entire bed minus mushroom
region          initCoreReg   intersect 2 initReg coreReg
region          initShellReg  intersect 2 initReg invCoreReg

# total burden weight
variable        pressureMin   equal 2000    # lower pressure value (Pa), near wall
variable        pressureMax   equal 20000   # upper pressure value (Pa), near core

# kinetic energy
variable        kinEn         equal ke      # kinetic energy (J)
variable        kinEnMax      equal 2.      # kinetic energy threshold for init (J)

# coke removal settings
variable        cokeRateInit  equal 20.     # coke combustion rate during init (kg/s)
variable        cokeRateRun   equal 1.      # coke combustion rate during run (kg/s)
variable        delInt        equal 0.1     # removal interval (s) [set in liggghtsCommands as well!]

variable        nFreeboard    equal count(all,freeboard)

variable        nRaceways     equal count(all,raceways)
variable        mRaceways     equal mass(all,raceways)
variable        avMass        equal "v_mRaceways/(v_nRaceways+1e-3)"

variable        delIntSteps   equal "floor(v_delInt/dt)"

variable        nDelInit      equal "v_delIntSteps*dt*v_cokeRateInit/v_avMass"
variable        fDelInit      equal "v_nDelInit/(v_nRaceways+1e-3)"

variable        nDelRun       equal "v_delIntSteps*dt*v_cokeRateRun/v_avMass"
variable        fDelRun       equal "v_nDelRun/(v_nRaceways+1e-3)"




# timestep
timestep        1e-4

# cfd coupling
fix             cfd all couple/cfd couple_every 100 mpi
nevery as specified in LIGGGHTS is overriden by calling external program (/home/ht45454/CFDEM/LIGGGHTS/src/cfd_datacoupling_mpi.cpp:56)
fix             cfd2 all couple/cfd/force/implicit

# heat transfer
fix             m7 all property/global thermalConductivity peratomtype ${particlekRun} # lambda in [W/(K*m)]
fix             m7 all property/global thermalConductivity peratomtype 40 
fix             m8 all property/global thermalCapacity     peratomtype ${particleCp}   # cp in [J/(kg*K)]
fix             m8 all property/global thermalCapacity     peratomtype 870   
fix             heattransfer all heat/gran/conduction initial_temperature ${Tinlet}
fix             heattransfer all heat/gran/conduction initial_temperature 1823.15
Resetting global state of Fix Temp Style property/atom from restart file info
Resetting per-atom state of Fix Temp Style property/atom from restart file info
Resetting global state of Fix heatFlux Style property/atom from restart file info
Resetting per-atom state of Fix heatFlux Style property/atom from restart file info
Resetting global state of Fix heatSource Style property/atom from restart file info
Resetting per-atom state of Fix heatSource Style property/atom from restart file info
fix             cfd3 all couple/cfd/convection T0 ${Tinlet}
fix             cfd3 all couple/cfd/convection T0 1823.15

# mass transfer
fix             cfd4 all couple/cfd/dissolve rmin ${rRemove}
fix             cfd4 all couple/cfd/dissolve rmin 0.001

# walls
include         ../DEM/in.wall_settings
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature ${Twall} curvature 1e-5
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature 1423.15 curvature 1e-5
Resetting global state of Fix sides Style mesh/surface from restart file info
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature ${Twall}
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature 1423.15
Resetting global state of Fix bottom Style mesh/surface from restart file info
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature ${Twall}
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature 1423.15
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
Resetting global state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting global state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting global state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting global state of Fix tracker_bottom Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_bottom Style contacthistory/mesh from restart file info

# gravity
fix		gravi all gravity 9.81 vector 0.0 0.0 -1.0

######################################

# particle distribution
include	   	../DEM/in.particleSizeDistribution1
# Particle size distribution for LIGGGHTS

# mean radius = 0.0100000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts1 all particletemplate/sphere 10007 atom_type 1 density constant 900 radius constant 0.01
Resetting global state of Fix pts1 Style particletemplate/sphere from restart file info

fix	pdd1 all particledistribution/discrete 10009 1 pts1 1.000000
Fix particledistribution/discrete (id pdd1): distribution based on mass%:
    pts1: d=2.000000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd1): distribution based on number%:
    pts1: d=2.000000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd1 Style particledistribution/discrete from restart file info
include	   	../DEM/in.particleSizeDistribution2
# Particle size distribution for LIGGGHTS

# mean radius = 0.0125000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts2 all particletemplate/sphere 10037 atom_type 1 density constant 900 radius constant 0.0125
Resetting global state of Fix pts2 Style particletemplate/sphere from restart file info

fix	pdd2 all particledistribution/discrete 10039 1 pts2 1.000000
Fix particledistribution/discrete (id pdd2): distribution based on mass%:
    pts2: d=2.500000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd2): distribution based on number%:
    pts2: d=2.500000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd2 Style particledistribution/discrete from restart file info

# raceways
include		../DEM/in.raceways
# Raceway definition for LIGGGHTS

# reactor radius = 0.500000 m
# raceway height = 0.500000 m
# raceway diameter = 0.100000 m
# raceway length = 0.100000 m
# number of raceways = 8

variable angle1 equal 0.000000
region raceway1 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle1 0 0 0 0 0 1
variable angle2 equal 0.785398
region raceway2 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle2 0 0 0 0 0 1
variable angle3 equal 1.570796
region raceway3 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle3 0 0 0 0 0 1
variable angle4 equal 2.356194
region raceway4 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle4 0 0 0 0 0 1
variable angle5 equal 3.141593
region raceway5 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle5 0 0 0 0 0 1
variable angle6 equal 3.926991
region raceway6 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle6 0 0 0 0 0 1
variable angle7 equal 4.712389
region raceway7 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle7 0 0 0 0 0 1
variable angle8 equal 5.497787
region raceway8 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle8 0 0 0 0 0 1

region raceways union 8 raceway1 raceway2 raceway3 raceway4 raceway5 raceway6 raceway7 raceway8

# burden weight
include         ../DEM/in.pressure_profile
# Pressure profile definition for LIGGGHTS

# reactor radius = 0.500000 m
# R1 = 0.150000 m
# R2 = 0.400000 m
# number of bins = 12

# Region01
region   forceReg01		 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side in  	# center region
region   forceReg01		 cylinder z 0 0 0.15	0.7 ${forceZmax} side in  	
region   forceReg01		 cylinder z 0 0 0.15	0.7 0.8 side in  	
variable nForceReg01	 equal count(all,forceReg01) 								# number of particles inside
variable forceRegArea01	 equal 0.070686												# ring area (m2)
variable forceFact01	 equal 1												# force factor [0-1] (-)
variable totalForce01	 equal "-(v_forceFact01*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea01"	# total force (N)
variable forcePerPart01	 equal "v_totalForce01/(v_nForceReg01+1e-3)"				# force per particle (N)
fix      force01		 all addforce 0 0 v_forcePerPart01 region forceReg01		# apply force

# Region02
region   forceRegIn02	 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 ${forceZmax} side out 	
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 0.8 side out 	
region   forceRegOut02	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side in  	
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 0.8 side in  	
region   forceReg02		 intersect 2 forceRegIn02 forceRegOut02						# annular region
variable nForceReg02	 equal count(all,forceReg02) 								# number of particles inside
variable forceRegArea02	 equal 0.020998												# ring area (m2)
variable forceFact02	 equal 0.95833												# force factor [0-1] (-)
variable totalForce02	 equal "-(v_forceFact02*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea02"	# total force (N)
variable forcePerPart02	 equal "v_totalForce02/(v_nForceReg02+1e-3)"				# force per particle (N)
fix      force02		 all addforce 0 0 v_forcePerPart02 region forceReg02		# apply force

# Region03
region   forceRegIn03	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side out 	
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 0.8 side out 	
region   forceRegOut03	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side in  	
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 0.8 side in  	
region   forceReg03		 intersect 2 forceRegIn03 forceRegOut03						# annular region
variable nForceReg03	 equal count(all,forceReg03) 								# number of particles inside
variable forceRegArea03	 equal 0.023726												# ring area (m2)
variable forceFact03	 equal 0.875												# force factor [0-1] (-)
variable totalForce03	 equal "-(v_forceFact03*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea03"	# total force (N)
variable forcePerPart03	 equal "v_totalForce03/(v_nForceReg03+1e-3)"				# force per particle (N)
fix      force03		 all addforce 0 0 v_forcePerPart03 region forceReg03		# apply force

# Region04
region   forceRegIn04	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side out 	
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 0.8 side out 	
region   forceRegOut04	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side in  	
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 0.8 side in  	
region   forceReg04		 intersect 2 forceRegIn04 forceRegOut04						# annular region
variable nForceReg04	 equal count(all,forceReg04) 								# number of particles inside
variable forceRegArea04	 equal 0.026453												# ring area (m2)
variable forceFact04	 equal 0.79167												# force factor [0-1] (-)
variable totalForce04	 equal "-(v_forceFact04*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea04"	# total force (N)
variable forcePerPart04	 equal "v_totalForce04/(v_nForceReg04+1e-3)"				# force per particle (N)
fix      force04		 all addforce 0 0 v_forcePerPart04 region forceReg04		# apply force

# Region05
region   forceRegIn05	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side out 	
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 0.8 side out 	
region   forceRegOut05	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side in  	
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 0.8 side in  	
region   forceReg05		 intersect 2 forceRegIn05 forceRegOut05						# annular region
variable nForceReg05	 equal count(all,forceReg05) 								# number of particles inside
variable forceRegArea05	 equal 0.02918												# ring area (m2)
variable forceFact05	 equal 0.70833												# force factor [0-1] (-)
variable totalForce05	 equal "-(v_forceFact05*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea05"	# total force (N)
variable forcePerPart05	 equal "v_totalForce05/(v_nForceReg05+1e-3)"				# force per particle (N)
fix      force05		 all addforce 0 0 v_forcePerPart05 region forceReg05		# apply force

# Region06
region   forceRegIn06	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side out 	
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 0.8 side out 	
region   forceRegOut06	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side in  	
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 0.8 side in  	
region   forceReg06		 intersect 2 forceRegIn06 forceRegOut06						# annular region
variable nForceReg06	 equal count(all,forceReg06) 								# number of particles inside
variable forceRegArea06	 equal 0.031907												# ring area (m2)
variable forceFact06	 equal 0.625												# force factor [0-1] (-)
variable totalForce06	 equal "-(v_forceFact06*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea06"	# total force (N)
variable forcePerPart06	 equal "v_totalForce06/(v_nForceReg06+1e-3)"				# force per particle (N)
fix      force06		 all addforce 0 0 v_forcePerPart06 region forceReg06		# apply force

# Region07
region   forceRegIn07	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side out 	
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 0.8 side out 	
region   forceRegOut07	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 ${forceZmax} side in  	
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 0.8 side in  	
region   forceReg07		 intersect 2 forceRegIn07 forceRegOut07						# annular region
variable nForceReg07	 equal count(all,forceReg07) 								# number of particles inside
variable forceRegArea07	 equal 0.034634												# ring area (m2)
variable forceFact07	 equal 0.54167												# force factor [0-1] (-)
variable totalForce07	 equal "-(v_forceFact07*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea07"	# total force (N)
variable forcePerPart07	 equal "v_totalForce07/(v_nForceReg07+1e-3)"				# force per particle (N)
fix      force07		 all addforce 0 0 v_forcePerPart07 region forceReg07		# apply force

# Region08
region   forceRegIn08	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 ${forceZmax} side out 	
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 0.8 side out 	
region   forceRegOut08	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side in  	
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 0.8 side in  	
region   forceReg08		 intersect 2 forceRegIn08 forceRegOut08						# annular region
variable nForceReg08	 equal count(all,forceReg08) 								# number of particles inside
variable forceRegArea08	 equal 0.037361												# ring area (m2)
variable forceFact08	 equal 0.45833												# force factor [0-1] (-)
variable totalForce08	 equal "-(v_forceFact08*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea08"	# total force (N)
variable forcePerPart08	 equal "v_totalForce08/(v_nForceReg08+1e-3)"				# force per particle (N)
fix      force08		 all addforce 0 0 v_forcePerPart08 region forceReg08		# apply force

# Region09
region   forceRegIn09	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side out 	
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 0.8 side out 	
region   forceRegOut09	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side in  	
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 0.8 side in  	
region   forceReg09		 intersect 2 forceRegIn09 forceRegOut09						# annular region
variable nForceReg09	 equal count(all,forceReg09) 								# number of particles inside
variable forceRegArea09	 equal 0.040088												# ring area (m2)
variable forceFact09	 equal 0.375												# force factor [0-1] (-)
variable totalForce09	 equal "-(v_forceFact09*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea09"	# total force (N)
variable forcePerPart09	 equal "v_totalForce09/(v_nForceReg09+1e-3)"				# force per particle (N)
fix      force09		 all addforce 0 0 v_forcePerPart09 region forceReg09		# apply force

# Region10
region   forceRegIn10	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side out 	
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 0.8 side out 	
region   forceRegOut10	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side in  	
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 0.8 side in  	
region   forceReg10		 intersect 2 forceRegIn10 forceRegOut10						# annular region
variable nForceReg10	 equal count(all,forceReg10) 								# number of particles inside
variable forceRegArea10	 equal 0.042815												# ring area (m2)
variable forceFact10	 equal 0.29167												# force factor [0-1] (-)
variable totalForce10	 equal "-(v_forceFact10*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea10"	# total force (N)
variable forcePerPart10	 equal "v_totalForce10/(v_nForceReg10+1e-3)"				# force per particle (N)
fix      force10		 all addforce 0 0 v_forcePerPart10 region forceReg10		# apply force

# Region11
region   forceRegIn11	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side out 	
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 0.8 side out 	
region   forceRegOut11	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side in  	
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 0.8 side in  	
region   forceReg11		 intersect 2 forceRegIn11 forceRegOut11						# annular region
variable nForceReg11	 equal count(all,forceReg11) 								# number of particles inside
variable forceRegArea11	 equal 0.045542												# ring area (m2)
variable forceFact11	 equal 0.20833												# force factor [0-1] (-)
variable totalForce11	 equal "-(v_forceFact11*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea11"	# total force (N)
variable forcePerPart11	 equal "v_totalForce11/(v_nForceReg11+1e-3)"				# force per particle (N)
fix      force11		 all addforce 0 0 v_forcePerPart11 region forceReg11		# apply force

# Region12
region   forceRegIn12	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side out 	
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 0.8 side out 	
region   forceRegOut12	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side in  	
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 0.8 side in  	
region   forceReg12		 intersect 2 forceRegIn12 forceRegOut12						# annular region
variable nForceReg12	 equal count(all,forceReg12) 								# number of particles inside
variable forceRegArea12	 equal 0.048269												# ring area (m2)
variable forceFact12	 equal 0.125												# force factor [0-1] (-)
variable totalForce12	 equal "-(v_forceFact12*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea12"	# total force (N)
variable forcePerPart12	 equal "v_totalForce12/(v_nForceReg12+1e-3)"				# force per particle (N)
fix      force12		 all addforce 0 0 v_forcePerPart12 region forceReg12		# apply force

# Region13
region   forceRegIn13	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side out 	
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 0.8 side out 	
region   forceRegOut13	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 ${forceZmax} side in  	
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 0.8 side in  	
region   forceReg13		 intersect 2 forceRegIn13 forceRegOut13						# annular region
variable nForceReg13	 equal count(all,forceReg13) 								# number of particles inside
variable forceRegArea13	 equal 0.050996												# ring area (m2)
variable forceFact13	 equal 0.041667												# force factor [0-1] (-)
variable totalForce13	 equal "-(v_forceFact13*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea13"	# total force (N)
variable forcePerPart13	 equal "v_totalForce13/(v_nForceReg13+1e-3)"				# force per particle (N)
fix      force13		 all addforce 0 0 v_forcePerPart13 region forceReg13		# apply force

# Region14
region   forceRegIn14	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 ${forceZmax} side out 	
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 0.8 side out 	
region   forceRegOut14	 cylinder z 0 0 0.5	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 ${forceZmax} side in  	
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 0.8 side in  	
region   forceReg14		 intersect 2 forceRegIn14 forceRegOut14						# annular region
variable nForceReg14	 equal count(all,forceReg14) 								# number of particles inside
variable forceRegArea14	 equal 0.28274												# ring area (m2)
variable forceFact14	 equal 0												# force factor [0-1] (-)
variable totalForce14	 equal "-(v_forceFact14*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea14"	# total force (N)
variable forcePerPart14	 equal "v_totalForce14/(v_nForceReg14+1e-3)"				# force per particle (N)
fix      force14		 all addforce 0 0 v_forcePerPart14 region forceReg14		# apply force

variable totalForce		 equal "v_forcePerPart01*v_nForceReg01+v_forcePerPart02*v_nForceReg02+v_forcePerPart03*v_nForceReg03+v_forcePerPart04*v_nForceReg04+v_forcePerPart05*v_nForceReg05+v_forcePerPart06*v_nForceReg06+v_forcePerPart07*v_nForceReg07+v_forcePerPart08*v_nForceReg08+v_forcePerPart09*v_nForceReg09+v_forcePerPart10*v_nForceReg10+v_forcePerPart11*v_nForceReg11+v_forcePerPart12*v_nForceReg12+v_forcePerPart13*v_nForceReg13+v_forcePerPart14*v_nForceReg14" 	# sum of all forces (N)
variable nForceReg		 equal "v_nForceReg01+v_nForceReg02+v_nForceReg03+v_nForceReg04+v_nForceReg05+v_nForceReg06+v_nForceReg07+v_nForceReg08+v_nForceReg09+v_nForceReg10+v_nForceReg11+v_nForceReg12+v_nForceReg13+v_nForceReg14" 	# sum of all numbers of particles (N)
variable avForcePerPart	 equal "v_totalForce/(v_nForceReg+1e-3)"	# average force per particle (N)

# insert in insertion volume
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every ${delIntSteps} overlapcheck yes region insShellReg volumefraction_region 0.7
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every 1000 overlapcheck yes region insShellReg volumefraction_region 0.7
INFO: Resetting random generator for region insShellReg
Resetting global state of Fix ins3 Style insert/pack from restart file info
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every ${delIntSteps} overlapcheck yes region insCoreReg  volumefraction_region 0.7
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every 1000 overlapcheck yes region insCoreReg  volumefraction_region 0.7
INFO: Resetting random generator for region insCoreReg
Resetting global state of Fix ins4 Style insert/pack from restart file info

######################################

# apply nve integration to all particles
fix             integr all nve/sphere

# output settings
thermo_style    custom step time atoms ke v_totalForce v_avForcePerPart v_nDelRun
thermo          10

# dump settings
dump            dmp all custom 5000 ../DEM/post/dump*.liggghts_run id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius density f_Temp[0] f_convectiveHeatFlux[0] f_convectiveMassFlux[0]
#5000
run             0
Resetting global state of Fix contacthistory Style contacthistory from restart file info
Resetting per-atom state of Fix contacthistory Style contacthistory from restart file info
Setting up run ...
Import and parallelization of mesh sides containing 2592 triangle(s) successful
Import and parallelization of mesh bottom containing 1024 triangle(s) successful
INFO: Resetting random generator for region insShellReg
INFO: Particle insertion ins3: inserting every 1000 steps
INFO: Resetting random generator for region insCoreReg
INFO: Particle insertion ins4: inserting every 1000 steps
Memory usage per processor = 24.93 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
ERROR: Divide by 0 in variable formula (/home/ht45454/CFDEM/LIGGGHTS/src/variable.cpp:1569)
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[3266,1],1]
  Exit code:    1
--------------------------------------------------------------------------

//      //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Jan 18 2025
Time   : 10:47:00
Host   : "TUE035485"
PID    : 11261
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.11262"
"TUE035485.11263"
"TUE035485.11264"
"TUE035485.11265"
"TUE035485.11266"
"TUE035485.11267"
"TUE035485.11268"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0


PIMPLE: Operating solver in PISO mode


Reading momentum exchange field Ksl


Reading voidfraction field voidfraction = (Vgas/Vparticle)

Reading particle velocity field Us

Reading field p_rgh

Reading field U

Reading/calculating face flux field phi

Selecting incompressible transport model Newtonian
Selecting incompressible transport model Newtonian
Reading/creating thermal fields

Reading/creating concentration fields

Selecting turbulence model type laminar

Reading g

Reading hRef
Calculating field g.h

No finite volume options present

GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
time step continuity errors : sum local = 0, global = 0, cumulative = 0
Courant Number mean: 0 max: 0
Selecting dataExchangeModel twoWayMPI
Starting up LIGGGHTS for first time execution
Executing input script '../DEM/in.liggghts_run'
LIGGGHTS (Version LIGGGHTS-PFM 24.01, compiled 2025-01-17-18:01:04 by ht45454, git commit d075b97762ce4302707903718dda170920e630bd, based on LAMMPS 23 Nov 2013)
log             ../log/log.liggghts_run
thermo_log      ../log/thermo.txt

atom_style      granular
atom_modify     map array
boundary        f f f
newton          off

communicate     single vel yes

units           si
processors      2 2 2

# read the restart file
read_restart    ../DEM/post/restart/liggghts.restartSequence
Reading restart file ...
  orthogonal box = (-0.5 -0.5 -0.0025) to (0.5 0.5 1)
  2 by 2 by 2 MPI processor grid
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
  80888 atoms

neighbor        0.007 bin
neigh_modify    delay 0

# contact model
include         ../DEM/in.contact_settings
# Material properties required for granular pair styles
fix             m1 all property/global youngsModulus	                peratomtype       5.e6
fix             m2 all property/global poissonsRatio 	                peratomtype	  0.3
fix             m3 all property/global coefficientRestitution           peratomtypepair 1 0.3
fix             m4 all property/global coefficientFriction 	        peratomtypepair 1 0.5
fix             m5 all property/global coefficientRollingFriction       peratomtypepair 1 0.2
fix             m6 all property/global coefficientRollingViscousDamping peratomtypepair 1 0.3

# pair style
pair_style	gran model hertz tangential history rolling_friction epsd
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
pair_coeff  	* *

# hearth settings
include         ../DEM/in.hearth_settings
# hearth settings
variable        hearthRadius  equal 0.5     # hearth radius (m)
variable        coreRadius    equal 0.15    # radius of core region (m)
variable        liquidLevel   equal 0.4     # initial liquid level (m) [set in setFieldsDict as well!]
variable        liquidDensity equal 6700.   # liquid density (kg/m3)

# heat/mass transfer settings
variable        particlekInit equal 5000    # particle thermal conductivity during init (W/Km)
variable        particlekRun  equal 40.0    # particle thermal conductivity during run  (W/Km) [sped up! 2.0*20!]
variable        particleCp    equal 870     # particle heat capacity (J/kgK)
variable        Tinlet        equal 1823.15 # particle inlet temperature (K) [set in CFD as well!]
variable        Tinit         equal 1623.15 # initial temperature (K) [set in CFD as well!]
variable        Twall         equal 1423.15 # wall temperature (K) [set in CFD as well!]
variable        rRemove       equal 0.001   # radius at which dissolved particles are removed (m)

# zone definitions
variable        forceZmin     equal 0.70    # lower boundary of force zone (m)
variable        forceZmax     equal 0.80    # upper boundary of force zone (m)
variable        insZmin       equal 0.70    # lower boundary of insertion zone (m)
variable        insZmax       equal 0.80    # upper boundary of insertion zone (m)

region          bedReg        cylinder z 0 0 ${hearthRadius} 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            0.8
region          coreReg       cylinder z 0 0 ${coreRadius}   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            0.8 side in
region          invCoreReg    cylinder z 0 0 ${coreRadius}   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            0.8 side out
region          shellReg      intersect 2 bedReg invCoreReg

region		insReg        cylinder z 0 0 ${hearthRadius} ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   0.8
region          insCoreReg    intersect 2 insReg coreReg
region          insShellReg   intersect 2 insReg invCoreReg

region		forceReg      cylinder z 0 0 ${hearthRadius} ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 0.8
region          freeboard     cylinder z 0 0 ${hearthRadius} ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 0.8 INF

region          mushroom      block 0.4 0.5 -0.05 0.05 0.2 0.3 side out # mushroom cutout
region          initReg       intersect 2 bedReg mushroom # entire bed minus mushroom
region          initCoreReg   intersect 2 initReg coreReg
region          initShellReg  intersect 2 initReg invCoreReg

# total burden weight
variable        pressureMin   equal 2000    # lower pressure value (Pa), near wall
variable        pressureMax   equal 20000   # upper pressure value (Pa), near core

# kinetic energy
variable        kinEn         equal ke      # kinetic energy (J)
variable        kinEnMax      equal 2.      # kinetic energy threshold for init (J)

# coke removal settings
variable        cokeRateInit  equal 20.     # coke combustion rate during init (kg/s)
variable        cokeRateRun   equal 1.      # coke combustion rate during run (kg/s)
variable        delInt        equal 0.1     # removal interval (s) [set in liggghtsCommands as well!]

variable        nFreeboard    equal count(all,freeboard)

variable        nRaceways     equal count(all,raceways)
variable        mRaceways     equal mass(all,raceways)
variable        avMass        equal "v_mRaceways/(v_nRaceways+1e-3)"

variable        delIntSteps   equal "floor(v_delInt/dt)"

variable        nDelInit      equal "v_delIntSteps*dt*v_cokeRateInit/v_avMass"
variable        fDelInit      equal "v_nDelInit/(v_nRaceways+1e-3)"

variable        nDelRun       equal "v_delIntSteps*dt*v_cokeRateRun/v_avMass"
variable        fDelRun       equal "v_nDelRun/(v_nRaceways+1e-3)"




# timestep
timestep        1e-4

# cfd coupling
fix             cfd all couple/cfd couple_every 100 mpi
nevery as specified in LIGGGHTS is overriden by calling external program (/home/ht45454/CFDEM/LIGGGHTS/src/cfd_datacoupling_mpi.cpp:56)
fix             cfd2 all couple/cfd/force/implicit

# heat transfer
fix             m7 all property/global thermalConductivity peratomtype ${particlekRun} # lambda in [W/(K*m)]
fix             m7 all property/global thermalConductivity peratomtype 40 
fix             m8 all property/global thermalCapacity     peratomtype ${particleCp}   # cp in [J/(kg*K)]
fix             m8 all property/global thermalCapacity     peratomtype 870   
fix             heattransfer all heat/gran/conduction initial_temperature ${Tinlet}
fix             heattransfer all heat/gran/conduction initial_temperature 1823.15
Resetting global state of Fix Temp Style property/atom from restart file info
Resetting per-atom state of Fix Temp Style property/atom from restart file info
Resetting global state of Fix heatFlux Style property/atom from restart file info
Resetting per-atom state of Fix heatFlux Style property/atom from restart file info
Resetting global state of Fix heatSource Style property/atom from restart file info
Resetting per-atom state of Fix heatSource Style property/atom from restart file info
fix             cfd3 all couple/cfd/convection T0 ${Tinlet}
fix             cfd3 all couple/cfd/convection T0 1823.15

# mass transfer
fix             cfd4 all couple/cfd/dissolve rmin ${rRemove}
fix             cfd4 all couple/cfd/dissolve rmin 0.001

# walls
include         ../DEM/in.wall_settings
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature ${Twall} curvature 1e-5
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature 1423.15 curvature 1e-5
Resetting global state of Fix sides Style mesh/surface from restart file info
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature ${Twall}
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature 1423.15
Resetting global state of Fix bottom Style mesh/surface from restart file info
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature ${Twall}
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature 1423.15
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
Resetting global state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting global state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting global state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting global state of Fix tracker_bottom Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_bottom Style contacthistory/mesh from restart file info

# gravity
fix		gravi all gravity 9.81 vector 0.0 0.0 -1.0

######################################

# particle distribution
include	   	../DEM/in.particleSizeDistribution1
# Particle size distribution for LIGGGHTS

# mean radius = 0.0100000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts1 all particletemplate/sphere 10007 atom_type 1 density constant 900 radius constant 0.01
Resetting global state of Fix pts1 Style particletemplate/sphere from restart file info

fix	pdd1 all particledistribution/discrete 10009 1 pts1 1.000000
Fix particledistribution/discrete (id pdd1): distribution based on mass%:
    pts1: d=2.000000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd1): distribution based on number%:
    pts1: d=2.000000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd1 Style particledistribution/discrete from restart file info
include	   	../DEM/in.particleSizeDistribution2
# Particle size distribution for LIGGGHTS

# mean radius = 0.0125000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts2 all particletemplate/sphere 10037 atom_type 1 density constant 900 radius constant 0.0125
Resetting global state of Fix pts2 Style particletemplate/sphere from restart file info

fix	pdd2 all particledistribution/discrete 10039 1 pts2 1.000000
Fix particledistribution/discrete (id pdd2): distribution based on mass%:
    pts2: d=2.500000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd2): distribution based on number%:
    pts2: d=2.500000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd2 Style particledistribution/discrete from restart file info

# raceways
include		../DEM/in.raceways
# Raceway definition for LIGGGHTS

# reactor radius = 0.500000 m
# raceway height = 0.500000 m
# raceway diameter = 0.100000 m
# raceway length = 0.100000 m
# number of raceways = 8

variable angle1 equal 0.000000
region raceway1 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle1 0 0 0 0 0 1
variable angle2 equal 0.785398
region raceway2 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle2 0 0 0 0 0 1
variable angle3 equal 1.570796
region raceway3 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle3 0 0 0 0 0 1
variable angle4 equal 2.356194
region raceway4 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle4 0 0 0 0 0 1
variable angle5 equal 3.141593
region raceway5 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle5 0 0 0 0 0 1
variable angle6 equal 3.926991
region raceway6 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle6 0 0 0 0 0 1
variable angle7 equal 4.712389
region raceway7 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle7 0 0 0 0 0 1
variable angle8 equal 5.497787
region raceway8 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle8 0 0 0 0 0 1

region raceways union 8 raceway1 raceway2 raceway3 raceway4 raceway5 raceway6 raceway7 raceway8

# burden weight
include         ../DEM/in.pressure_profile
# Pressure profile definition for LIGGGHTS

# reactor radius = 0.500000 m
# R1 = 0.150000 m
# R2 = 0.400000 m
# number of bins = 12

# Region01
region   forceReg01		 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side in  	# center region
region   forceReg01		 cylinder z 0 0 0.15	0.7 ${forceZmax} side in  	
region   forceReg01		 cylinder z 0 0 0.15	0.7 0.8 side in  	
variable nForceReg01	 equal count(all,forceReg01) 								# number of particles inside
variable forceRegArea01	 equal 0.070686												# ring area (m2)
variable forceFact01	 equal 1												# force factor [0-1] (-)
variable totalForce01	 equal "-(v_forceFact01*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea01"	# total force (N)
variable forcePerPart01	 equal "v_totalForce01/(v_nForceReg01+1e-3)"				# force per particle (N)
fix      force01		 all addforce 0 0 v_forcePerPart01 region forceReg01		# apply force

# Region02
region   forceRegIn02	 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 ${forceZmax} side out 	
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 0.8 side out 	
region   forceRegOut02	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side in  	
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 0.8 side in  	
region   forceReg02		 intersect 2 forceRegIn02 forceRegOut02						# annular region
variable nForceReg02	 equal count(all,forceReg02) 								# number of particles inside
variable forceRegArea02	 equal 0.020998												# ring area (m2)
variable forceFact02	 equal 0.95833												# force factor [0-1] (-)
variable totalForce02	 equal "-(v_forceFact02*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea02"	# total force (N)
variable forcePerPart02	 equal "v_totalForce02/(v_nForceReg02+1e-3)"				# force per particle (N)
fix      force02		 all addforce 0 0 v_forcePerPart02 region forceReg02		# apply force

# Region03
region   forceRegIn03	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side out 	
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 0.8 side out 	
region   forceRegOut03	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side in  	
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 0.8 side in  	
region   forceReg03		 intersect 2 forceRegIn03 forceRegOut03						# annular region
variable nForceReg03	 equal count(all,forceReg03) 								# number of particles inside
variable forceRegArea03	 equal 0.023726												# ring area (m2)
variable forceFact03	 equal 0.875												# force factor [0-1] (-)
variable totalForce03	 equal "-(v_forceFact03*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea03"	# total force (N)
variable forcePerPart03	 equal "v_totalForce03/(v_nForceReg03+1e-3)"				# force per particle (N)
fix      force03		 all addforce 0 0 v_forcePerPart03 region forceReg03		# apply force

# Region04
region   forceRegIn04	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side out 	
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 0.8 side out 	
region   forceRegOut04	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side in  	
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 0.8 side in  	
region   forceReg04		 intersect 2 forceRegIn04 forceRegOut04						# annular region
variable nForceReg04	 equal count(all,forceReg04) 								# number of particles inside
variable forceRegArea04	 equal 0.026453												# ring area (m2)
variable forceFact04	 equal 0.79167												# force factor [0-1] (-)
variable totalForce04	 equal "-(v_forceFact04*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea04"	# total force (N)
variable forcePerPart04	 equal "v_totalForce04/(v_nForceReg04+1e-3)"				# force per particle (N)
fix      force04		 all addforce 0 0 v_forcePerPart04 region forceReg04		# apply force

# Region05
region   forceRegIn05	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side out 	
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 0.8 side out 	
region   forceRegOut05	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side in  	
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 0.8 side in  	
region   forceReg05		 intersect 2 forceRegIn05 forceRegOut05						# annular region
variable nForceReg05	 equal count(all,forceReg05) 								# number of particles inside
variable forceRegArea05	 equal 0.02918												# ring area (m2)
variable forceFact05	 equal 0.70833												# force factor [0-1] (-)
variable totalForce05	 equal "-(v_forceFact05*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea05"	# total force (N)
variable forcePerPart05	 equal "v_totalForce05/(v_nForceReg05+1e-3)"				# force per particle (N)
fix      force05		 all addforce 0 0 v_forcePerPart05 region forceReg05		# apply force

# Region06
region   forceRegIn06	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side out 	
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 0.8 side out 	
region   forceRegOut06	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side in  	
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 0.8 side in  	
region   forceReg06		 intersect 2 forceRegIn06 forceRegOut06						# annular region
variable nForceReg06	 equal count(all,forceReg06) 								# number of particles inside
variable forceRegArea06	 equal 0.031907												# ring area (m2)
variable forceFact06	 equal 0.625												# force factor [0-1] (-)
variable totalForce06	 equal "-(v_forceFact06*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea06"	# total force (N)
variable forcePerPart06	 equal "v_totalForce06/(v_nForceReg06+1e-3)"				# force per particle (N)
fix      force06		 all addforce 0 0 v_forcePerPart06 region forceReg06		# apply force

# Region07
region   forceRegIn07	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side out 	
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 0.8 side out 	
region   forceRegOut07	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 ${forceZmax} side in  	
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 0.8 side in  	
region   forceReg07		 intersect 2 forceRegIn07 forceRegOut07						# annular region
variable nForceReg07	 equal count(all,forceReg07) 								# number of particles inside
variable forceRegArea07	 equal 0.034634												# ring area (m2)
variable forceFact07	 equal 0.54167												# force factor [0-1] (-)
variable totalForce07	 equal "-(v_forceFact07*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea07"	# total force (N)
variable forcePerPart07	 equal "v_totalForce07/(v_nForceReg07+1e-3)"				# force per particle (N)
fix      force07		 all addforce 0 0 v_forcePerPart07 region forceReg07		# apply force

# Region08
region   forceRegIn08	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 ${forceZmax} side out 	
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 0.8 side out 	
region   forceRegOut08	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side in  	
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 0.8 side in  	
region   forceReg08		 intersect 2 forceRegIn08 forceRegOut08						# annular region
variable nForceReg08	 equal count(all,forceReg08) 								# number of particles inside
variable forceRegArea08	 equal 0.037361												# ring area (m2)
variable forceFact08	 equal 0.45833												# force factor [0-1] (-)
variable totalForce08	 equal "-(v_forceFact08*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea08"	# total force (N)
variable forcePerPart08	 equal "v_totalForce08/(v_nForceReg08+1e-3)"				# force per particle (N)
fix      force08		 all addforce 0 0 v_forcePerPart08 region forceReg08		# apply force

# Region09
region   forceRegIn09	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side out 	
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 0.8 side out 	
region   forceRegOut09	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side in  	
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 0.8 side in  	
region   forceReg09		 intersect 2 forceRegIn09 forceRegOut09						# annular region
variable nForceReg09	 equal count(all,forceReg09) 								# number of particles inside
variable forceRegArea09	 equal 0.040088												# ring area (m2)
variable forceFact09	 equal 0.375												# force factor [0-1] (-)
variable totalForce09	 equal "-(v_forceFact09*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea09"	# total force (N)
variable forcePerPart09	 equal "v_totalForce09/(v_nForceReg09+1e-3)"				# force per particle (N)
fix      force09		 all addforce 0 0 v_forcePerPart09 region forceReg09		# apply force

# Region10
region   forceRegIn10	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side out 	
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 0.8 side out 	
region   forceRegOut10	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side in  	
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 0.8 side in  	
region   forceReg10		 intersect 2 forceRegIn10 forceRegOut10						# annular region
variable nForceReg10	 equal count(all,forceReg10) 								# number of particles inside
variable forceRegArea10	 equal 0.042815												# ring area (m2)
variable forceFact10	 equal 0.29167												# force factor [0-1] (-)
variable totalForce10	 equal "-(v_forceFact10*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea10"	# total force (N)
variable forcePerPart10	 equal "v_totalForce10/(v_nForceReg10+1e-3)"				# force per particle (N)
fix      force10		 all addforce 0 0 v_forcePerPart10 region forceReg10		# apply force

# Region11
region   forceRegIn11	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side out 	
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 0.8 side out 	
region   forceRegOut11	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side in  	
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 0.8 side in  	
region   forceReg11		 intersect 2 forceRegIn11 forceRegOut11						# annular region
variable nForceReg11	 equal count(all,forceReg11) 								# number of particles inside
variable forceRegArea11	 equal 0.045542												# ring area (m2)
variable forceFact11	 equal 0.20833												# force factor [0-1] (-)
variable totalForce11	 equal "-(v_forceFact11*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea11"	# total force (N)
variable forcePerPart11	 equal "v_totalForce11/(v_nForceReg11+1e-3)"				# force per particle (N)
fix      force11		 all addforce 0 0 v_forcePerPart11 region forceReg11		# apply force

# Region12
region   forceRegIn12	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side out 	
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 0.8 side out 	
region   forceRegOut12	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side in  	
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 0.8 side in  	
region   forceReg12		 intersect 2 forceRegIn12 forceRegOut12						# annular region
variable nForceReg12	 equal count(all,forceReg12) 								# number of particles inside
variable forceRegArea12	 equal 0.048269												# ring area (m2)
variable forceFact12	 equal 0.125												# force factor [0-1] (-)
variable totalForce12	 equal "-(v_forceFact12*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea12"	# total force (N)
variable forcePerPart12	 equal "v_totalForce12/(v_nForceReg12+1e-3)"				# force per particle (N)
fix      force12		 all addforce 0 0 v_forcePerPart12 region forceReg12		# apply force

# Region13
region   forceRegIn13	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side out 	
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 0.8 side out 	
region   forceRegOut13	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 ${forceZmax} side in  	
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 0.8 side in  	
region   forceReg13		 intersect 2 forceRegIn13 forceRegOut13						# annular region
variable nForceReg13	 equal count(all,forceReg13) 								# number of particles inside
variable forceRegArea13	 equal 0.050996												# ring area (m2)
variable forceFact13	 equal 0.041667												# force factor [0-1] (-)
variable totalForce13	 equal "-(v_forceFact13*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea13"	# total force (N)
variable forcePerPart13	 equal "v_totalForce13/(v_nForceReg13+1e-3)"				# force per particle (N)
fix      force13		 all addforce 0 0 v_forcePerPart13 region forceReg13		# apply force

# Region14
region   forceRegIn14	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 ${forceZmax} side out 	
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 0.8 side out 	
region   forceRegOut14	 cylinder z 0 0 0.5	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 ${forceZmax} side in  	
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 0.8 side in  	
region   forceReg14		 intersect 2 forceRegIn14 forceRegOut14						# annular region
variable nForceReg14	 equal count(all,forceReg14) 								# number of particles inside
variable forceRegArea14	 equal 0.28274												# ring area (m2)
variable forceFact14	 equal 0												# force factor [0-1] (-)
variable totalForce14	 equal "-(v_forceFact14*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea14"	# total force (N)
variable forcePerPart14	 equal "v_totalForce14/(v_nForceReg14+1e-3)"				# force per particle (N)
fix      force14		 all addforce 0 0 v_forcePerPart14 region forceReg14		# apply force

variable totalForce		 equal "v_forcePerPart01*v_nForceReg01+v_forcePerPart02*v_nForceReg02+v_forcePerPart03*v_nForceReg03+v_forcePerPart04*v_nForceReg04+v_forcePerPart05*v_nForceReg05+v_forcePerPart06*v_nForceReg06+v_forcePerPart07*v_nForceReg07+v_forcePerPart08*v_nForceReg08+v_forcePerPart09*v_nForceReg09+v_forcePerPart10*v_nForceReg10+v_forcePerPart11*v_nForceReg11+v_forcePerPart12*v_nForceReg12+v_forcePerPart13*v_nForceReg13+v_forcePerPart14*v_nForceReg14" 	# sum of all forces (N)
variable nForceReg		 equal "v_nForceReg01+v_nForceReg02+v_nForceReg03+v_nForceReg04+v_nForceReg05+v_nForceReg06+v_nForceReg07+v_nForceReg08+v_nForceReg09+v_nForceReg10+v_nForceReg11+v_nForceReg12+v_nForceReg13+v_nForceReg14" 	# sum of all numbers of particles (N)
variable avForcePerPart	 equal "v_totalForce/(v_nForceReg+1e-3)"	# average force per particle (N)

# insert in insertion volume
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every ${delIntSteps} overlapcheck yes region insShellReg volumefraction_region 0.7
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every 1000 overlapcheck yes region insShellReg volumefraction_region 0.7
INFO: Resetting random generator for region insShellReg
Resetting global state of Fix ins3 Style insert/pack from restart file info
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every ${delIntSteps} overlapcheck yes region insCoreReg  volumefraction_region 0.7
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every 1000 overlapcheck yes region insCoreReg  volumefraction_region 0.7
INFO: Resetting random generator for region insCoreReg
Resetting global state of Fix ins4 Style insert/pack from restart file info

######################################

# apply nve integration to all particles
fix             integr all nve/sphere

# output settings
thermo_style    custom step time atoms ke v_totalForce v_avForcePerPart v_nDelRun
thermo          10

# dump settings
dump            dmp all custom 5000 ../DEM/post/dump*.liggghts_run id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius density f_Temp[0] f_convectiveHeatFlux[0] f_convectiveMassFlux[0]
#5000
run             0
Resetting global state of Fix contacthistory Style contacthistory from restart file info
Resetting per-atom state of Fix contacthistory Style contacthistory from restart file info
Setting up run ...
Import and parallelization of mesh sides containing 2592 triangle(s) successful
Import and parallelization of mesh bottom containing 1024 triangle(s) successful
INFO: Resetting random generator for region insShellReg
INFO: Particle insertion ins3: inserting every 1000 steps
INFO: Resetting random generator for region insCoreReg
INFO: Particle insertion ins4: inserting every 1000 steps
Memory usage per processor = 24.93 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
ERROR: Divide by 0 in variable formula (/home/ht45454/CFDEM/LIGGGHTS/src/variable.cpp:1569)
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[3253,1],1]
  Exit code:    1
--------------------------------------------------------------------------

//      //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Jan 18 2025
Time   : 10:52:56
Host   : "TUE035485"
PID    : 11430
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.11431"
"TUE035485.11432"
"TUE035485.11433"
"TUE035485.11434"
"TUE035485.11435"
"TUE035485.11436"
"TUE035485.11437"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0


PIMPLE: Operating solver in PISO mode


Reading momentum exchange field Ksl


Reading voidfraction field voidfraction = (Vgas/Vparticle)

Reading particle velocity field Us

Reading field p_rgh

Reading field U

Reading/calculating face flux field phi

Selecting incompressible transport model Newtonian
Selecting incompressible transport model Newtonian
Reading/creating thermal fields

Reading/creating concentration fields

Selecting turbulence model type laminar

Reading g

Reading hRef
Calculating field g.h

No finite volume options present

GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
time step continuity errors : sum local = 0, global = 0, cumulative = 0
Courant Number mean: 0 max: 0
Selecting dataExchangeModel twoWayMPI
Starting up LIGGGHTS for first time execution
Executing input script '../DEM/in.liggghts_run'
LIGGGHTS (Version LIGGGHTS-PFM 24.01, compiled 2025-01-17-18:01:04 by ht45454, git commit d075b97762ce4302707903718dda170920e630bd, based on LAMMPS 23 Nov 2013)
log             ../log/log.liggghts_run
thermo_log      ../log/thermo.txt

atom_style      granular
atom_modify     map array
boundary        f f f
newton          off

communicate     single vel yes

units           si
processors      2 2 2

# read the restart file
read_restart    ../DEM/post/restart/liggghts.restartSequence
Reading restart file ...
  orthogonal box = (-0.5 -0.5 -0.0025) to (0.5 0.5 1)
  2 by 2 by 2 MPI processor grid
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
  80888 atoms

neighbor        0.007 bin
neigh_modify    delay 0

# contact model
include         ../DEM/in.contact_settings
# Material properties required for granular pair styles
fix             m1 all property/global youngsModulus	                peratomtype       5.e6
fix             m2 all property/global poissonsRatio 	                peratomtype	  0.3
fix             m3 all property/global coefficientRestitution           peratomtypepair 1 0.3
fix             m4 all property/global coefficientFriction 	        peratomtypepair 1 0.5
fix             m5 all property/global coefficientRollingFriction       peratomtypepair 1 0.2
fix             m6 all property/global coefficientRollingViscousDamping peratomtypepair 1 0.3

# pair style
pair_style	gran model hertz tangential history rolling_friction epsd
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
pair_coeff  	* *

# hearth settings
include         ../DEM/in.hearth_settings
# hearth settings
variable        hearthRadius  equal 0.5     # hearth radius (m)
variable        coreRadius    equal 0.15    # radius of core region (m)
variable        liquidLevel   equal 0.4     # initial liquid level (m) [set in setFieldsDict as well!]
variable        liquidDensity equal 6700.   # liquid density (kg/m3)

# heat/mass transfer settings
variable        particlekInit equal 5000    # particle thermal conductivity during init (W/Km)
variable        particlekRun  equal 40.0    # particle thermal conductivity during run  (W/Km) [sped up! 2.0*20!]
variable        particleCp    equal 870     # particle heat capacity (J/kgK)
variable        Tinlet        equal 1823.15 # particle inlet temperature (K) [set in CFD as well!]
variable        Tinit         equal 1623.15 # initial temperature (K) [set in CFD as well!]
variable        Twall         equal 1423.15 # wall temperature (K) [set in CFD as well!]
variable        rRemove       equal 0.001   # radius at which dissolved particles are removed (m)

# zone definitions
variable        forceZmin     equal 0.70    # lower boundary of force zone (m)
variable        forceZmax     equal 0.80    # upper boundary of force zone (m)
variable        insZmin       equal 0.70    # lower boundary of insertion zone (m)
variable        insZmax       equal 0.80    # upper boundary of insertion zone (m)

region          bedReg        cylinder z 0 0 ${hearthRadius} 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            0.8
region          coreReg       cylinder z 0 0 ${coreRadius}   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            0.8 side in
region          invCoreReg    cylinder z 0 0 ${coreRadius}   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            0.8 side out
region          shellReg      intersect 2 bedReg invCoreReg

region		insReg        cylinder z 0 0 ${hearthRadius} ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   0.8
region          insCoreReg    intersect 2 insReg coreReg
region          insShellReg   intersect 2 insReg invCoreReg

region		forceReg      cylinder z 0 0 ${hearthRadius} ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 0.8
region          freeboard     cylinder z 0 0 ${hearthRadius} ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 0.8 INF

region          mushroom      block 0.4 0.5 -0.05 0.05 0.2 0.3 side out # mushroom cutout
region          initReg       intersect 2 bedReg mushroom # entire bed minus mushroom
region          initCoreReg   intersect 2 initReg coreReg
region          initShellReg  intersect 2 initReg invCoreReg

# total burden weight
variable        pressureMin   equal 2000    # lower pressure value (Pa), near wall
variable        pressureMax   equal 20000   # upper pressure value (Pa), near core

# kinetic energy
variable        kinEn         equal ke      # kinetic energy (J)
variable        kinEnMax      equal 2.      # kinetic energy threshold for init (J)

# coke removal settings
variable        cokeRateInit  equal 20.     # coke combustion rate during init (kg/s)
variable        cokeRateRun   equal 1.      # coke combustion rate during run (kg/s)
variable        delInt        equal 0.1     # removal interval (s) [set in liggghtsCommands as well!]

variable        nFreeboard    equal count(all,freeboard)

variable        nRaceways     equal count(all,raceways)
variable        mRaceways     equal mass(all,raceways)
variable        avMass        equal "v_mRaceways/(v_nRaceways+1e-3)"

variable        delIntSteps   equal "floor(v_delInt/dt)"

variable        nDelInit      equal "v_delIntSteps*dt*v_cokeRateInit/v_avMass"
variable        fDelInit      equal "v_nDelInit/(v_nRaceways+1e-3)"

variable        nDelRun       equal "v_delIntSteps*dt*v_cokeRateRun/(v_avMass+1e-3)"
variable        fDelRun       equal "v_nDelRun/(v_nRaceways+1e-3)"




# timestep
timestep        1e-4

# cfd coupling
fix             cfd all couple/cfd couple_every 100 mpi
nevery as specified in LIGGGHTS is overriden by calling external program (/home/ht45454/CFDEM/LIGGGHTS/src/cfd_datacoupling_mpi.cpp:56)
fix             cfd2 all couple/cfd/force/implicit

# heat transfer
fix             m7 all property/global thermalConductivity peratomtype ${particlekRun} # lambda in [W/(K*m)]
fix             m7 all property/global thermalConductivity peratomtype 40 
fix             m8 all property/global thermalCapacity     peratomtype ${particleCp}   # cp in [J/(kg*K)]
fix             m8 all property/global thermalCapacity     peratomtype 870   
fix             heattransfer all heat/gran/conduction initial_temperature ${Tinlet}
fix             heattransfer all heat/gran/conduction initial_temperature 1823.15
Resetting global state of Fix Temp Style property/atom from restart file info
Resetting per-atom state of Fix Temp Style property/atom from restart file info
Resetting global state of Fix heatFlux Style property/atom from restart file info
Resetting per-atom state of Fix heatFlux Style property/atom from restart file info
Resetting global state of Fix heatSource Style property/atom from restart file info
Resetting per-atom state of Fix heatSource Style property/atom from restart file info
fix             cfd3 all couple/cfd/convection T0 ${Tinlet}
fix             cfd3 all couple/cfd/convection T0 1823.15

# mass transfer
fix             cfd4 all couple/cfd/dissolve rmin ${rRemove}
fix             cfd4 all couple/cfd/dissolve rmin 0.001

# walls
include         ../DEM/in.wall_settings
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature ${Twall} curvature 1e-5
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature 1423.15 curvature 1e-5
Resetting global state of Fix sides Style mesh/surface from restart file info
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature ${Twall}
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature 1423.15
Resetting global state of Fix bottom Style mesh/surface from restart file info
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature ${Twall}
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature 1423.15
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
Resetting global state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting global state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting global state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting global state of Fix tracker_bottom Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_bottom Style contacthistory/mesh from restart file info

# gravity
fix		gravi all gravity 9.81 vector 0.0 0.0 -1.0

######################################

# particle distribution
include	   	../DEM/in.particleSizeDistribution1
# Particle size distribution for LIGGGHTS

# mean radius = 0.0100000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts1 all particletemplate/sphere 10007 atom_type 1 density constant 900 radius constant 0.01
Resetting global state of Fix pts1 Style particletemplate/sphere from restart file info

fix	pdd1 all particledistribution/discrete 10009 1 pts1 1.000000
Fix particledistribution/discrete (id pdd1): distribution based on mass%:
    pts1: d=2.000000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd1): distribution based on number%:
    pts1: d=2.000000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd1 Style particledistribution/discrete from restart file info
include	   	../DEM/in.particleSizeDistribution2
# Particle size distribution for LIGGGHTS

# mean radius = 0.0125000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts2 all particletemplate/sphere 10037 atom_type 1 density constant 900 radius constant 0.0125
Resetting global state of Fix pts2 Style particletemplate/sphere from restart file info

fix	pdd2 all particledistribution/discrete 10039 1 pts2 1.000000
Fix particledistribution/discrete (id pdd2): distribution based on mass%:
    pts2: d=2.500000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd2): distribution based on number%:
    pts2: d=2.500000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd2 Style particledistribution/discrete from restart file info

# raceways
include		../DEM/in.raceways
# Raceway definition for LIGGGHTS

# reactor radius = 0.500000 m
# raceway height = 0.500000 m
# raceway diameter = 0.100000 m
# raceway length = 0.100000 m
# number of raceways = 8

variable angle1 equal 0.000000
region raceway1 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle1 0 0 0 0 0 1
variable angle2 equal 0.785398
region raceway2 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle2 0 0 0 0 0 1
variable angle3 equal 1.570796
region raceway3 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle3 0 0 0 0 0 1
variable angle4 equal 2.356194
region raceway4 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle4 0 0 0 0 0 1
variable angle5 equal 3.141593
region raceway5 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle5 0 0 0 0 0 1
variable angle6 equal 3.926991
region raceway6 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle6 0 0 0 0 0 1
variable angle7 equal 4.712389
region raceway7 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle7 0 0 0 0 0 1
variable angle8 equal 5.497787
region raceway8 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle8 0 0 0 0 0 1

region raceways union 8 raceway1 raceway2 raceway3 raceway4 raceway5 raceway6 raceway7 raceway8

# burden weight
include         ../DEM/in.pressure_profile
# Pressure profile definition for LIGGGHTS

# reactor radius = 0.500000 m
# R1 = 0.150000 m
# R2 = 0.400000 m
# number of bins = 12

# Region01
region   forceReg01		 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side in  	# center region
region   forceReg01		 cylinder z 0 0 0.15	0.7 ${forceZmax} side in  	
region   forceReg01		 cylinder z 0 0 0.15	0.7 0.8 side in  	
variable nForceReg01	 equal count(all,forceReg01) 								# number of particles inside
variable forceRegArea01	 equal 0.070686												# ring area (m2)
variable forceFact01	 equal 1												# force factor [0-1] (-)
variable totalForce01	 equal "-(v_forceFact01*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea01"	# total force (N)
variable forcePerPart01	 equal "v_totalForce01/(v_nForceReg01+1e-3)"				# force per particle (N)
fix      force01		 all addforce 0 0 v_forcePerPart01 region forceReg01		# apply force

# Region02
region   forceRegIn02	 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 ${forceZmax} side out 	
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 0.8 side out 	
region   forceRegOut02	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side in  	
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 0.8 side in  	
region   forceReg02		 intersect 2 forceRegIn02 forceRegOut02						# annular region
variable nForceReg02	 equal count(all,forceReg02) 								# number of particles inside
variable forceRegArea02	 equal 0.020998												# ring area (m2)
variable forceFact02	 equal 0.95833												# force factor [0-1] (-)
variable totalForce02	 equal "-(v_forceFact02*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea02"	# total force (N)
variable forcePerPart02	 equal "v_totalForce02/(v_nForceReg02+1e-3)"				# force per particle (N)
fix      force02		 all addforce 0 0 v_forcePerPart02 region forceReg02		# apply force

# Region03
region   forceRegIn03	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side out 	
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 0.8 side out 	
region   forceRegOut03	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side in  	
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 0.8 side in  	
region   forceReg03		 intersect 2 forceRegIn03 forceRegOut03						# annular region
variable nForceReg03	 equal count(all,forceReg03) 								# number of particles inside
variable forceRegArea03	 equal 0.023726												# ring area (m2)
variable forceFact03	 equal 0.875												# force factor [0-1] (-)
variable totalForce03	 equal "-(v_forceFact03*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea03"	# total force (N)
variable forcePerPart03	 equal "v_totalForce03/(v_nForceReg03+1e-3)"				# force per particle (N)
fix      force03		 all addforce 0 0 v_forcePerPart03 region forceReg03		# apply force

# Region04
region   forceRegIn04	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side out 	
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 0.8 side out 	
region   forceRegOut04	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side in  	
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 0.8 side in  	
region   forceReg04		 intersect 2 forceRegIn04 forceRegOut04						# annular region
variable nForceReg04	 equal count(all,forceReg04) 								# number of particles inside
variable forceRegArea04	 equal 0.026453												# ring area (m2)
variable forceFact04	 equal 0.79167												# force factor [0-1] (-)
variable totalForce04	 equal "-(v_forceFact04*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea04"	# total force (N)
variable forcePerPart04	 equal "v_totalForce04/(v_nForceReg04+1e-3)"				# force per particle (N)
fix      force04		 all addforce 0 0 v_forcePerPart04 region forceReg04		# apply force

# Region05
region   forceRegIn05	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side out 	
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 0.8 side out 	
region   forceRegOut05	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side in  	
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 0.8 side in  	
region   forceReg05		 intersect 2 forceRegIn05 forceRegOut05						# annular region
variable nForceReg05	 equal count(all,forceReg05) 								# number of particles inside
variable forceRegArea05	 equal 0.02918												# ring area (m2)
variable forceFact05	 equal 0.70833												# force factor [0-1] (-)
variable totalForce05	 equal "-(v_forceFact05*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea05"	# total force (N)
variable forcePerPart05	 equal "v_totalForce05/(v_nForceReg05+1e-3)"				# force per particle (N)
fix      force05		 all addforce 0 0 v_forcePerPart05 region forceReg05		# apply force

# Region06
region   forceRegIn06	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side out 	
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 0.8 side out 	
region   forceRegOut06	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side in  	
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 0.8 side in  	
region   forceReg06		 intersect 2 forceRegIn06 forceRegOut06						# annular region
variable nForceReg06	 equal count(all,forceReg06) 								# number of particles inside
variable forceRegArea06	 equal 0.031907												# ring area (m2)
variable forceFact06	 equal 0.625												# force factor [0-1] (-)
variable totalForce06	 equal "-(v_forceFact06*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea06"	# total force (N)
variable forcePerPart06	 equal "v_totalForce06/(v_nForceReg06+1e-3)"				# force per particle (N)
fix      force06		 all addforce 0 0 v_forcePerPart06 region forceReg06		# apply force

# Region07
region   forceRegIn07	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side out 	
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 0.8 side out 	
region   forceRegOut07	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 ${forceZmax} side in  	
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 0.8 side in  	
region   forceReg07		 intersect 2 forceRegIn07 forceRegOut07						# annular region
variable nForceReg07	 equal count(all,forceReg07) 								# number of particles inside
variable forceRegArea07	 equal 0.034634												# ring area (m2)
variable forceFact07	 equal 0.54167												# force factor [0-1] (-)
variable totalForce07	 equal "-(v_forceFact07*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea07"	# total force (N)
variable forcePerPart07	 equal "v_totalForce07/(v_nForceReg07+1e-3)"				# force per particle (N)
fix      force07		 all addforce 0 0 v_forcePerPart07 region forceReg07		# apply force

# Region08
region   forceRegIn08	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 ${forceZmax} side out 	
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 0.8 side out 	
region   forceRegOut08	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side in  	
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 0.8 side in  	
region   forceReg08		 intersect 2 forceRegIn08 forceRegOut08						# annular region
variable nForceReg08	 equal count(all,forceReg08) 								# number of particles inside
variable forceRegArea08	 equal 0.037361												# ring area (m2)
variable forceFact08	 equal 0.45833												# force factor [0-1] (-)
variable totalForce08	 equal "-(v_forceFact08*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea08"	# total force (N)
variable forcePerPart08	 equal "v_totalForce08/(v_nForceReg08+1e-3)"				# force per particle (N)
fix      force08		 all addforce 0 0 v_forcePerPart08 region forceReg08		# apply force

# Region09
region   forceRegIn09	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side out 	
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 0.8 side out 	
region   forceRegOut09	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side in  	
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 0.8 side in  	
region   forceReg09		 intersect 2 forceRegIn09 forceRegOut09						# annular region
variable nForceReg09	 equal count(all,forceReg09) 								# number of particles inside
variable forceRegArea09	 equal 0.040088												# ring area (m2)
variable forceFact09	 equal 0.375												# force factor [0-1] (-)
variable totalForce09	 equal "-(v_forceFact09*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea09"	# total force (N)
variable forcePerPart09	 equal "v_totalForce09/(v_nForceReg09+1e-3)"				# force per particle (N)
fix      force09		 all addforce 0 0 v_forcePerPart09 region forceReg09		# apply force

# Region10
region   forceRegIn10	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side out 	
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 0.8 side out 	
region   forceRegOut10	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side in  	
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 0.8 side in  	
region   forceReg10		 intersect 2 forceRegIn10 forceRegOut10						# annular region
variable nForceReg10	 equal count(all,forceReg10) 								# number of particles inside
variable forceRegArea10	 equal 0.042815												# ring area (m2)
variable forceFact10	 equal 0.29167												# force factor [0-1] (-)
variable totalForce10	 equal "-(v_forceFact10*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea10"	# total force (N)
variable forcePerPart10	 equal "v_totalForce10/(v_nForceReg10+1e-3)"				# force per particle (N)
fix      force10		 all addforce 0 0 v_forcePerPart10 region forceReg10		# apply force

# Region11
region   forceRegIn11	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side out 	
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 0.8 side out 	
region   forceRegOut11	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side in  	
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 0.8 side in  	
region   forceReg11		 intersect 2 forceRegIn11 forceRegOut11						# annular region
variable nForceReg11	 equal count(all,forceReg11) 								# number of particles inside
variable forceRegArea11	 equal 0.045542												# ring area (m2)
variable forceFact11	 equal 0.20833												# force factor [0-1] (-)
variable totalForce11	 equal "-(v_forceFact11*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea11"	# total force (N)
variable forcePerPart11	 equal "v_totalForce11/(v_nForceReg11+1e-3)"				# force per particle (N)
fix      force11		 all addforce 0 0 v_forcePerPart11 region forceReg11		# apply force

# Region12
region   forceRegIn12	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side out 	
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 0.8 side out 	
region   forceRegOut12	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side in  	
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 0.8 side in  	
region   forceReg12		 intersect 2 forceRegIn12 forceRegOut12						# annular region
variable nForceReg12	 equal count(all,forceReg12) 								# number of particles inside
variable forceRegArea12	 equal 0.048269												# ring area (m2)
variable forceFact12	 equal 0.125												# force factor [0-1] (-)
variable totalForce12	 equal "-(v_forceFact12*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea12"	# total force (N)
variable forcePerPart12	 equal "v_totalForce12/(v_nForceReg12+1e-3)"				# force per particle (N)
fix      force12		 all addforce 0 0 v_forcePerPart12 region forceReg12		# apply force

# Region13
region   forceRegIn13	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side out 	
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 0.8 side out 	
region   forceRegOut13	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 ${forceZmax} side in  	
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 0.8 side in  	
region   forceReg13		 intersect 2 forceRegIn13 forceRegOut13						# annular region
variable nForceReg13	 equal count(all,forceReg13) 								# number of particles inside
variable forceRegArea13	 equal 0.050996												# ring area (m2)
variable forceFact13	 equal 0.041667												# force factor [0-1] (-)
variable totalForce13	 equal "-(v_forceFact13*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea13"	# total force (N)
variable forcePerPart13	 equal "v_totalForce13/(v_nForceReg13+1e-3)"				# force per particle (N)
fix      force13		 all addforce 0 0 v_forcePerPart13 region forceReg13		# apply force

# Region14
region   forceRegIn14	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 ${forceZmax} side out 	
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 0.8 side out 	
region   forceRegOut14	 cylinder z 0 0 0.5	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 ${forceZmax} side in  	
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 0.8 side in  	
region   forceReg14		 intersect 2 forceRegIn14 forceRegOut14						# annular region
variable nForceReg14	 equal count(all,forceReg14) 								# number of particles inside
variable forceRegArea14	 equal 0.28274												# ring area (m2)
variable forceFact14	 equal 0												# force factor [0-1] (-)
variable totalForce14	 equal "-(v_forceFact14*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea14"	# total force (N)
variable forcePerPart14	 equal "v_totalForce14/(v_nForceReg14+1e-3)"				# force per particle (N)
fix      force14		 all addforce 0 0 v_forcePerPart14 region forceReg14		# apply force

variable totalForce		 equal "v_forcePerPart01*v_nForceReg01+v_forcePerPart02*v_nForceReg02+v_forcePerPart03*v_nForceReg03+v_forcePerPart04*v_nForceReg04+v_forcePerPart05*v_nForceReg05+v_forcePerPart06*v_nForceReg06+v_forcePerPart07*v_nForceReg07+v_forcePerPart08*v_nForceReg08+v_forcePerPart09*v_nForceReg09+v_forcePerPart10*v_nForceReg10+v_forcePerPart11*v_nForceReg11+v_forcePerPart12*v_nForceReg12+v_forcePerPart13*v_nForceReg13+v_forcePerPart14*v_nForceReg14" 	# sum of all forces (N)
variable nForceReg		 equal "v_nForceReg01+v_nForceReg02+v_nForceReg03+v_nForceReg04+v_nForceReg05+v_nForceReg06+v_nForceReg07+v_nForceReg08+v_nForceReg09+v_nForceReg10+v_nForceReg11+v_nForceReg12+v_nForceReg13+v_nForceReg14" 	# sum of all numbers of particles (N)
variable avForcePerPart	 equal "v_totalForce/(v_nForceReg+1e-3)"	# average force per particle (N)

# insert in insertion volume
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every ${delIntSteps} overlapcheck yes region insShellReg volumefraction_region 0.7
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every 1000 overlapcheck yes region insShellReg volumefraction_region 0.7
INFO: Resetting random generator for region insShellReg
Resetting global state of Fix ins3 Style insert/pack from restart file info
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every ${delIntSteps} overlapcheck yes region insCoreReg  volumefraction_region 0.7
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every 1000 overlapcheck yes region insCoreReg  volumefraction_region 0.7
INFO: Resetting random generator for region insCoreReg
Resetting global state of Fix ins4 Style insert/pack from restart file info

######################################

# apply nve integration to all particles
fix             integr all nve/sphere

# output settings
thermo_style    custom step time atoms ke v_totalForce v_avForcePerPart v_nDelRun
thermo          10

# dump settings
dump            dmp all custom 5000 ../DEM/post/dump*.liggghts_run id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius density f_Temp[0] f_convectiveHeatFlux[0] f_convectiveMassFlux[0]
#5000
run             0
Resetting global state of Fix contacthistory Style contacthistory from restart file info
Resetting per-atom state of Fix contacthistory Style contacthistory from restart file info
Setting up run ...
Import and parallelization of mesh sides containing 2592 triangle(s) successful
Import and parallelization of mesh bottom containing 1024 triangle(s) successful
INFO: Resetting random generator for region insShellReg
INFO: Particle insertion ins3: inserting every 1000 steps
INFO: Resetting random generator for region insCoreReg
INFO: Particle insertion ins4: inserting every 1000 steps
Memory usage per processor = 24.93 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107001            0    80888  0.084448594   -6145.8938   -0.6678141          100 
Loop time of 5.304e-06 on 8 procs for 0 steps with 80888 atoms
Max time of 5.978e-06 on 8 procs for 0 steps with 80888 atoms

Pair  time (%) = 0 (0)
Max Pair time (ib) = 0 (0)
Neigh time (%) = 0 (0)
Max Neigh time (ib) = 0 (0)
Comm  time (%) = 0 (0)
Max Comm time (ib) = 0 (0)
Outpt time (%) = 0 (0)
Max Outpt time (ib) = 0 (0)
Other time (%) = 5.304e-06 (100)
Max Other time (ib) = 5.978e-06 (12.7074)

Nlocal:    10111 ave 12700 max 7448 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:    2253.75 ave 2657 max 1844 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:    57335.1 ave 71932 max 42273 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 458681
Ave neighs/atom = 5.67057
Neighbor list builds = 0
Dangerous builds = 0

Selecting locateModel engine
Selecting IOModel basicIO
Selecting probeModel off
Selecting voidFractionModel divided
Selecting averagingModel dense
Selecting clockModel standardClock
start clock measurement at t >0.0005
Selecting smoothingModel constDiffSmoothing
Selecting meshMotionModel noMeshMotion

CFDEMcoupling version: 24.01
compatible to LIGGGHTS version: 24.01
compatible to OpenFOAM version: 4.x

You are currently using:
OpenFOAM version: 4.x
OpenFOAM build: 4.x-d214c8dfd5ba
CFDEM build: 

If BC are important, please provide volScalarFields -imp/expParticleForces-
Selecting momCoupleModel implicitCouple

implicit momentum exchange field calculate if alphaP larger than : 1
Selecting forceModel BeetstraDrag
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for implForceDEM ...
	implForceDEM = true
  looking for verbose ...
	verbose = false
  looking for interpolation ...
	interpolation = true
  looking for scalarViscosity ...
	scalarViscosity = false

--> FOAM Warning : Please make sure you use the new nomenclature for verbose force model settings, please have a look at the forceSubModel doc.
Selecting forceModel MeiLift
Lift model: including shear-induced term.
Lift model: including spin-induced term.
Make sure to use a rolling friction model in LIGGGHTS!
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for verbose ...
	verbose = false
  looking for interpolation ...
	interpolation = true
  looking for scalarViscosity ...
	scalarViscosity = false

--> FOAM Warning : Please make sure you use the new nomenclature for verbose force model settings, please have a look at the forceSubModel doc.
Selecting forceModel virtualMassForce
Selecting smoothingModel constDiffAndTemporalSmoothing
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for interpolation ...
	interpolation = true

Virtual mass model: using averaged Us 
WARNING: ignoring virtual mass of relative particle motion/collisions 
Virtual mass model: using Cadd correlation by Felderhof 
WARNING: ignoring user-set Cadd 
Selecting forceModel ParmarBassetForce
Selecting smoothingModel constDiffAndTemporalSmoothing
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for verbose ...
	verbose = false
  looking for interpolation ...
	interpolation = true

Selecting forceModel viscForce
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for treatForceDEM ...
	treatForceDEM = false
  looking for interpolation ...
	interpolation = false
  looking for scalarViscosity ...
	scalarViscosity = false

Using treatForceDEM true!
Selecting forceModel gradPForceSmooth
Selecting smoothingModel temporalSmoothing
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for treatForceDEM ...
	treatForceDEM = false
  looking for interpolation ...
	interpolation = false

Using treatForceDEM true!
Selecting forceModel surfaceTensionForce
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false

check if interpolation really works - use directly interpolationCellPoint<vector> ???
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand delete_atoms porosity raceways ${fDelRun} 123457 compress no 
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand write_restart ../DEM/post/restart/liggghts.restartSequence
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand delete_atoms region freeboard compress no 
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand set region raceways property/atom Temp ${Tinlet}
Selecting liggghtsCommandModel runLiggghts, provide dicts, numbered from 0 to n
Selecting liggghtsCommandModel writeLiggghts, provide dicts, numbered from 0 to n
writeLiggghts: A restart file writeName_write_restart ../DEM/post/restart/liggghts.restartCFDEM is written.
cg is set to: 1
Selecting thermCondModel SyamlalThermCond
Selecting diffCoeffModel SyamlalDiffCoeff
Selecting energyModel heatTransferGunn
Particle temperature field activated.
Selecting energyModel wallHeatTransferYagi
Selecting massTransferModel massTransferGunn
Selecting chemistryModel off
solving volume averaged Navier Stokes equations of type A
check if Archimedes lift is necessary (depends on pressure formulation)


Starting time loop


Debugging........

Courant Number mean: 0 max: 0

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.0005


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms porosity raceways ${fDelRun} 123457 compress no '
delete_atoms porosity raceways ${fDelRun} 123457 compress no 
delete_atoms porosity raceways 100000 123457 compress no 
Deleted 0 atoms, new total = 80888
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80888
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  0 settings made for property/atom
Executing command: 'run 5    '
run 5    
Setting up run ...
Memory usage per processor = 24.9304 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107001            0    80888  0.084448594   -6145.8938   -0.6678141          100 
insertion: proc 1 at 0 %
insertion: proc 3 at 0 %
insertion: proc 5 at 0 %
insertion: proc 7 at 0 %
INFO: Particle insertion ins3: inserted 63 particle templates (mass 0.237504) at step 107002
 - a total of 6239 particle templates (mass 23.520476) inserted so far.
WARNING: Particle insertion: Less insertions than requested (/home/ht45454/CFDEM/LIGGGHTS/src/fix_insert.cpp:814)
insertion: proc 1 at 0 %
insertion: proc 3 at 0 %
insertion: proc 5 at 0 %
insertion: proc 7 at 0 %
INFO: Particle insertion ins4: inserted 1 particle templates (mass 0.007363) at step 107002
 - a total of 289 particle templates (mass 2.127938) inserted so far.
WARNING: Particle insertion: Less insertions than requested (/home/ht45454/CFDEM/LIGGGHTS/src/fix_insert.cpp:814)
  107006       0.0005    80952    0.1909491   -6145.8939  -0.66313048    20.981317 
Loop time of 0.192204 on 8 procs for 5 steps with 80952 atoms
Max time of 0.192204 on 8 procs for 5 steps with 80952 atoms

Pair  time (%) = 0.0136863 (7.12073)
Max Pair time (ib) = 0.0232061 (69.5568)
Neigh time (%) = 0.00980936 (5.10363)
Max Neigh time (ib) = 0.0131961 (34.5261)
Comm  time (%) = 0.00978486 (5.09088)
Max Comm time (ib) = 0.0152244 (55.5913)
Outpt time (%) = 0.0153009 (7.96078)
Max Outpt time (ib) = 0.0153545 (0.350372)
Other time (%) = 0.143622 (74.724)
Max Other time (ib) = 0.146725 (2.16012)

Nlocal:    10119 ave 12700 max 7475 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:    2255.62 ave 2657 max 1849 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:    57372.9 ave 71932 max 42411 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 458983
Ave neighs/atom = 5.66982
Neighbor list builds = 1
Dangerous builds = 0
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804666, Final residual = 8.52051e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 3.87428e-05, Final residual = 3.87428e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 5.9341e-05, Final residual = 5.9341e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 1.20545e-05, Final residual = 1.20545e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.532871, Final residual = 5.58457e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.601756, Final residual = 8.22109e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.201819, Final residual = 4.98672e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1532.39
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.435725
U : (0 0 0) m/s
G : (0 0 0) kg/m2s
mG: 0 kg/m2s
Re: 0
Pr: 0.045
JH: 200
h : 0 J/m2sK
Tw: 1473.15 K
Tf: 1623.15 K
dT: -150 K
q : -0 J/m2s
A : 0.00245342 m2
Q : -0 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.438786
U : (0 0 0) m/s
G : (0 0 0) kg/m2s
mG: 0 kg/m2s
Re: 0
Pr: 0.045
JH: 200
h : 0 J/m2sK
Tw: 1473.15 K
Tf: 1623.15 K
dT: -150 K
q : -0 J/m2s
A : 0.00245336 m2
Q : -0 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: 0
Maximum Fluid Concentration: 235
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.755554, Final residual = 7.11445e-05, No Iterations 17
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.748133, Final residual = 8.84575e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.596, Final residual = 7.34851e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-47.2138 37.2366 -1028.14)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399432 0 1
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600568 0 1
Phase-sum volume fraction, min, max = 1 1 1
DILUPBiCGStab:  Solving for T, Initial residual = 1, Final residual = 1.82566e-09, No Iterations 1
DILUPBiCGStab:  Solving for C, Initial residual = 1.61579e-05, Final residual = 1.04791e-13, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 1, Final residual = 4.13543e-10, No Iterations 2
smoothSolver:  Solving for Uy, Initial residual = 1, Final residual = 2.14092e-10, No Iterations 2
smoothSolver:  Solving for Uz, Initial residual = 1, Final residual = 2.14186e-11, No Iterations 3
GAMG:  Solving for p_rgh, Initial residual = 1, Final residual = 7.23021e-07, No Iterations 5
GAMG:  Solving for p_rgh, Initial residual = 5.59773e-05, Final residual = 9.98001e-09, No Iterations 9
time step continuity errors : sum local = 4.66941e-09, global = -4.25438e-09, cumulative = -4.25438e-09
GAMG:  Solving for p_rgh, Initial residual = 0.00197122, Final residual = 5.81787e-09, No Iterations 10
GAMGPCG:  Solving for p_rgh, Initial residual = 5.04291e-05, Final residual = 5.50712e-09, No Iterations 4
time step continuity errors : sum local = 2.6169e-09, global = 2.05596e-11, cumulative = -4.23382e-09
total convective particle-fluid heat flux [W] = 1.05309e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 3.01671
ExecutionTime = 0.91 s  ClockTime = 1 s

Courant Number mean: 2.68783e-05 max: 0.00150604

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.001


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  1 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107006       0.0005    80952    0.1909491   -6145.8939  -0.66313048    20.981317 
  107010       0.0009    80952    0.5010505   -6145.8939  -0.66313048    20.973035 
  107011        0.001    80952    0.6462202   -6145.8939  -0.66320204    20.973035 
Loop time of 0.0999705 on 8 procs for 5 steps with 80952 atoms
Max time of 0.0999709 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804695, Final residual = 8.51569e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 4.22312e-05, Final residual = 4.22312e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 6.65871e-05, Final residual = 6.65871e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.29768e-05, Final residual = 2.29768e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.769976, Final residual = 6.78172e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.77664, Final residual = 8.53308e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.356366, Final residual = 6.30911e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.558653, Final residual = 9.85745e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.793916, Final residual = 4.2482e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.325431, Final residual = 5.76511e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.769914, Final residual = 6.78589e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.779669, Final residual = 8.57829e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.356366, Final residual = 6.30916e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1534.36
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.435757
U : (-1.36444e-05 -8.45792e-05 -0.000120117) m/s
G : (-1.48641e-06 -9.21398e-06 -1.30855e-05) kg/m2s
mG: 1.60729e-05 kg/m2s
Re: 0.00428609
Pr: 0.045
JH: 0.595138
h : 0.0905425 J/m2sK
Tw: 1473.15 K
Tf: 1586.95 K
dT: -113.799 K
q : -10.3037 J/m2s
A : 0.00245342 m2
Q : -0.0252792 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.438816
U : (5.5241e-05 0.00300945 -0.000135728) m/s
G : (6.06016e-06 0.000330149 -1.489e-05) kg/m2s
mG: 0.00033054 kg/m2s
Re: 0.0881441
Pr: 0.045
JH: 0.325081
h : 1.01709 J/m2sK
Tw: 1473.15 K
Tf: 1591.58 K
dT: -118.43 K
q : -120.453 J/m2s
A : 0.00245336 m2
Q : -0.295516 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -1.1953e-19
Maximum Fluid Concentration: 235.017
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.732304, Final residual = 6.37882e-05, No Iterations 20
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.752341, Final residual = 9.18958e-05, No Iterations 19
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.809054, Final residual = 7.0196e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-1870.11 -1105.4 -12246.9)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399453 0 1.00424
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600541 0 1.00649
Phase-sum volume fraction, min, max = 0.999994 0.996058 1.00649
DILUPBiCGStab:  Solving for T, Initial residual = 0.069141, Final residual = 7.80364e-11, No Iterations 1
DILUPBiCGStab:  Solving for C, Initial residual = 6.31211e-05, Final residual = 1.09693e-10, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.280068, Final residual = 1.11005e-09, No Iterations 2
smoothSolver:  Solving for Uy, Initial residual = 0.302328, Final residual = 7.07389e-10, No Iterations 2
smoothSolver:  Solving for Uz, Initial residual = 0.37781, Final residual = 2.02713e-09, No Iterations 2
GAMG:  Solving for p_rgh, Initial residual = 0.00178681, Final residual = 9.39077e-09, No Iterations 17
GAMG:  Solving for p_rgh, Initial residual = 4.94062e-05, Final residual = 7.91606e-09, No Iterations 9
time step continuity errors : sum local = 4.83002e-05, global = -2.11866e-06, cumulative = -2.1229e-06
GAMG:  Solving for p_rgh, Initial residual = 9.50256e-06, Final residual = 8.95295e-09, No Iterations 6
GAMGPCG:  Solving for p_rgh, Initial residual = 2.04892e-06, Final residual = 2.59258e-09, No Iterations 3
time step continuity errors : sum local = 4.82983e-05, global = -2.11677e-06, cumulative = -4.23967e-06
total convective particle-fluid heat flux [W] = 1.25063e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 4.0478
ExecutionTime = 1.36 s  ClockTime = 2 s

Courant Number mean: 0.000277889 max: 0.0464516

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.0015


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  2 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107011        0.001    80952    0.6462202   -6145.8939  -0.66320204    20.973035 
  107016       0.0015    80952    3.1194676   -6145.8939  -0.66320204    20.973035 
Loop time of 0.074595 on 8 procs for 5 steps with 80952 atoms
Max time of 0.0745978 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804603, Final residual = 8.50695e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 5.43655e-05, Final residual = 5.43655e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 7.96581e-05, Final residual = 7.96581e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.40845e-05, Final residual = 2.40845e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.79118, Final residual = 4.48377e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.660705, Final residual = 6.16402e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.312614, Final residual = 6.67674e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.696575, Final residual = 5.87414e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.809811, Final residual = 8.439e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.506228, Final residual = 5.58372e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.789388, Final residual = 5.40482e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.626131, Final residual = 6.61533e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.31278, Final residual = 6.67125e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1536.71
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249982 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.435849
U : (1.79985e-05 -6.29641e-05 0.000668721) m/s
G : (1.96101e-06 -6.86022e-06 7.28601e-05) kg/m2s
mG: 7.32086e-05 kg/m2s
Re: 0.0195223
Pr: 0.045
JH: 0.439465
h : 0.304528 J/m2sK
Tw: 1473.15 K
Tf: 1557.95 K
dT: -84.8031 K
q : -25.8249 J/m2s
A : 0.00245342 m2
Q : -0.0633593 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249983 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.438897
U : (0.00128147 0.0405205 0.0180313) m/s
G : (0.000140599 0.00444577 0.00197833) kg/m2s
mG: 0.00486811 kg/m2s
Re: 1.29816
Pr: 0.045
JH: 0.18983
h : 8.74714 J/m2sK
Tw: 1473.15 K
Tf: 1565.08 K
dT: -91.9292 K
q : -804.118 J/m2s
A : 0.00245336 m2
Q : -1.97279 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -2.01006e-08
Maximum Fluid Concentration: 236.027
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.870036, Final residual = 6.33352e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.884246, Final residual = 6.40372e-05, No Iterations 19
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.844642, Final residual = 6.88597e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-607.976 15728.4 -28589.6)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399514 0 1.00626
MULES: Solving for alpha.air
air volume fraction, min, max = 0.60048 0 1.00323
Phase-sum volume fraction, min, max = 0.999994 0.994894 1.00626
DILUPBiCGStab:  Solving for T, Initial residual = 0.0775018, Final residual = 9.4052e-10, No Iterations 2
DILUPBiCGStab:  Solving for C, Initial residual = 0.000130202, Final residual = 4.11006e-10, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.348533, Final residual = 1.37337e-10, No Iterations 4
smoothSolver:  Solving for Uy, Initial residual = 0.309375, Final residual = 4.09908e-10, No Iterations 4
smoothSolver:  Solving for Uz, Initial residual = 0.43151, Final residual = 4.76444e-11, No Iterations 4
GAMG:  Solving for p_rgh, Initial residual = 0.00204473, Final residual = 6.13358e-09, No Iterations 11
GAMG:  Solving for p_rgh, Initial residual = 0.00048033, Final residual = 9.38327e-09, No Iterations 11
time step continuity errors : sum local = 7.47794e-05, global = -3.00935e-06, cumulative = -7.24902e-06
GAMG:  Solving for p_rgh, Initial residual = 0.000144247, Final residual = 3.88714e-09, No Iterations 9
GAMGPCG:  Solving for p_rgh, Initial residual = 2.31169e-05, Final residual = 3.5357e-09, No Iterations 4
time step continuity errors : sum local = 7.47807e-05, global = -3.01014e-06, cumulative = -1.02592e-05
total convective particle-fluid heat flux [W] = 1.97484e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 8.27213
ExecutionTime = 1.78 s  ClockTime = 2 s

Courant Number mean: 0.00102525 max: 0.0913121

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.002


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  2 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107016       0.0015    80952    3.1194676   -6145.8939  -0.66320204    20.973035 
  107020       0.0019    80952    9.9523209   -6145.8939  -0.66305894    20.973035 
  107021        0.002    80952    11.000175   -6145.8939  -0.66327361    20.973035 
Loop time of 0.143002 on 8 procs for 5 steps with 80952 atoms
Max time of 0.143002 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804597, Final residual = 8.47738e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 7.17222e-05, Final residual = 7.17222e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.000114464, Final residual = 4.95494e-07, No Iterations 1
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.13039e-05, Final residual = 2.13039e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.783495, Final residual = 7.22834e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.826856, Final residual = 9.34462e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.333454, Final residual = 7.22982e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.738581, Final residual = 8.69456e-05, No Iterations 9
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.825012, Final residual = 7.42394e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.673825, Final residual = 4.93063e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.779492, Final residual = 8.50166e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.759813, Final residual = 5.4333e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.326851, Final residual = 6.99623e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1540.42
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249947 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.436029
U : (-0.000245284 0.000171376 0.00128158) m/s
G : (-2.67321e-05 1.86773e-05 0.000139672) kg/m2s
mG: 0.000143429 kg/m2s
Re: 0.0382477
Pr: 0.045
JH: 0.384157
h : 0.521539 J/m2sK
Tw: 1473.15 K
Tf: 1533.59 K
dT: -60.4431 K
q : -31.5234 J/m2s
A : 0.00245342 m2
Q : -0.0773401 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249954 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.439038
U : (-0.00611282 -0.174135 0.0688358) m/s
G : (-0.000670817 -0.0191094 0.007554) kg/m2s
mG: 0.0205593 kg/m2s
Re: 5.48247
Pr: 0.045
JH: 0.14231
h : 27.6939 J/m2sK
Tw: 1473.15 K
Tf: 1541.23 K
dT: -68.0832 K
q : -1885.49 J/m2s
A : 0.00245336 m2
Q : -4.62579 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -9.39414e-08
Maximum Fluid Concentration: 236.62
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.83241, Final residual = 7.91475e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.877353, Final residual = 7.85209e-05, No Iterations 19
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.85145, Final residual = 6.84209e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (41549.9 56247.3 -310731)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399607 0 1.0116
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600381 0 1.00307
Phase-sum volume fraction, min, max = 0.999988 0.992527 1.0116
DILUPBiCGStab:  Solving for T, Initial residual = 0.118723, Final residual = 4.63741e-09, No Iterations 2
DILUPBiCGStab:  Solving for C, Initial residual = 0.000230003, Final residual = 2.69793e-09, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.268334, Final residual = 4.26235e-10, No Iterations 6
smoothSolver:  Solving for Uy, Initial residual = 0.319223, Final residual = 6.0612e-10, No Iterations 6
smoothSolver:  Solving for Uz, Initial residual = 0.245136, Final residual = 3.89192e-09, No Iterations 5
GAMG:  Solving for p_rgh, Initial residual = 0.011164, Final residual = 6.52808e-09, No Iterations 16
GAMG:  Solving for p_rgh, Initial residual = 0.00139439, Final residual = 4.90283e-09, No Iterations 10
time step continuity errors : sum local = 0.00010807, global = -6.08479e-06, cumulative = -1.6344e-05
GAMG:  Solving for p_rgh, Initial residual = 0.000755602, Final residual = 4.41577e-09, No Iterations 14
GAMGPCG:  Solving for p_rgh, Initial residual = 0.000183361, Final residual = 4.28289e-09, No Iterations 5
time step continuity errors : sum local = 0.00010807, global = -6.08367e-06, cumulative = -2.24276e-05
total convective particle-fluid heat flux [W] = 3.20105e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 16.7751
ExecutionTime = 2.26 s  ClockTime = 3 s

Courant Number mean: 0.00404292 max: 0.354337

Debugging zero!

Interface Courant Number mean: 2.82149e-06 max: 0.0140143

Debugging one!

Time = 0.0025


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  2 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107021        0.002    80952    11.000175   -6145.8939  -0.66327361    20.973035 
  107026       0.0025    80952    873.08833   -6145.8939  -0.66320204    20.970274 
Loop time of 0.155678 on 8 procs for 5 steps with 80952 atoms
Max time of 0.155678 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.805241, Final residual = 8.34232e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.000108572, Final residual = 1.51438e-05, No Iterations 1
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 7.89313e-05, Final residual = 7.89313e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.40877e-05, Final residual = 2.40877e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.800064, Final residual = 6.7443e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.809848, Final residual = 7.2322e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.634914, Final residual = 9.42144e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.752017, Final residual = 4.45517e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.830925, Final residual = 7.25065e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.750135, Final residual = 8.29366e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.780386, Final residual = 8.98455e-05, No Iterations 9
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.760298, Final residual = 8.31448e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.602006, Final residual = 4.89779e-05, No Iterations 11
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1546.43
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249897 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.436226
U : (-0.000309424 6.20479e-05 0.000883881) m/s
G : (-3.37308e-05 6.76393e-06 9.63532e-05) kg/m2s
mG: 0.000102311 kg/m2s
Re: 0.0272828
Pr: 0.045
JH: 0.41101
h : 0.398029 J/m2sK
Tw: 1473.15 K
Tf: 1513.51 K
dT: -40.3588 K
q : -16.0639 J/m2s
A : 0.00245342 m2
Q : -0.0394115 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249919 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.439216
U : (-0.045517 -1.34533 0.137405) m/s
G : (-0.00499633 -0.147675 0.0150827) kg/m2s
mG: 0.148528 kg/m2s
Re: 39.6074
Pr: 0.045
JH: 0.0958241
h : 134.718 J/m2sK
Tw: 1473.15 K
Tf: 1521.4 K
dT: -48.2495 K
q : -6500.06 J/m2s
A : 0.00245336 m2
Q : -15.947 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -2.29299e-07
Maximum Fluid Concentration: 238.642
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.87753, Final residual = 9.46591e-05, No Iterations 17
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.880138, Final residual = 7.60144e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.929878, Final residual = 7.66469e-05, No Iterations 14
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (269811 -7.44771e+06 -1.96583e+06)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399729 -3.21732e-12 1.07441
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600256 0 1.00387
Phase-sum volume fraction, min, max = 0.999985 0.9504 1.07441
DILUPBiCGStab:  Solving for T, Initial residual = 0.208573, Final residual = 3.27785e-09, No Iterations 3
DILUPBiCGStab:  Solving for C, Initial residual = 0.000600127, Final residual = 2.22256e-09, No Iterations 2
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.272692, Final residual = 5.55696e-09, No Iterations 6
smoothSolver:  Solving for Uy, Initial residual = 0.201779, Final residual = 9.5322e-10, No Iterations 7
smoothSolver:  Solving for Uz, Initial residual = 0.128616, Final residual = 2.00696e-09, No Iterations 6
GAMG:  Solving for p_rgh, Initial residual = 0.0824754, Final residual = 2.73916e-08, No Iterations 12
GAMG:  Solving for p_rgh, Initial residual = 0.00218674, Final residual = 4.37545e-09, No Iterations 11
time step continuity errors : sum local = 0.000256362, global = -1.26812e-05, cumulative = -3.51088e-05
GAMG:  Solving for p_rgh, Initial residual = 0.00396083, Final residual = 2.53106e-09, No Iterations 12
GAMGPCG:  Solving for p_rgh, Initial residual = 0.000672197, Final residual = 1.78783e-09, No Iterations 6
time step continuity errors : sum local = 0.000256359, global = -1.26784e-05, cumulative = -4.77872e-05
total convective particle-fluid heat flux [W] = 5.05906e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 41.8721
ExecutionTime = 2.75 s  ClockTime = 3 s

Courant Number mean: 0.0142474 max: 1.05681

Debugging zero!

Interface Courant Number mean: 0.000557874 max: 0.685109

Debugging one!

Time = 0.003


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  3 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107026       0.0025    80952    873.08833   -6145.8939  -0.66320204    20.970274 
  107030       0.0029    80915    1024841.8   -6145.8939   -0.6633452    20.970274 
  107031        0.003    80893    1000652.8   -6145.8939  -0.66305894    20.970274 
Loop time of 0.197916 on 8 procs for 5 steps with 80893 atoms
Max time of 0.197916 on 8 procs for 5 steps with 80893 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.809624, Final residual = 8.03763e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.000138533, Final residual = 1.7266e-07, No Iterations 1
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 9.86569e-05, Final residual = 9.86569e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 8.95795e-05, Final residual = 8.95795e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.833576, Final residual = 8.78291e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.85732, Final residual = 6.06212e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.800251, Final residual = 8.17132e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.790704, Final residual = 6.07373e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.817657, Final residual = 8.24425e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.773337, Final residual = 6.78431e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.794959, Final residual = 6.19652e-05, No Iterations 9
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.773186, Final residual = 8.06108e-05, No Iterations 9
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.787518, Final residual = 6.05866e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1555.91
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249887 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.436466
U : (0.000938151 -0.00267914 -0.00333014) m/s
G : (0.000102321 -0.000292206 -0.000363209) kg/m2s
mG: 0.000477258 kg/m2s
Re: 0.127269
Pr: 0.045
JH: 0.302055
h : 1.36452 J/m2sK
Tw: 1473.15 K
Tf: 1497.2 K
dT: -24.0527 K
q : -32.8205 J/m2s
A : 0.00245342 m2
Q : -0.0805223 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249899 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.439522
U : (0.526251 15.2354 -0.237731) m/s
G : (0.0578013 1.6734 -0.0261115) kg/m2s
mG: 1.6746 kg/m2s
Re: 446.561
Pr: 0.045
JH: 0.0590274
h : 935.637 J/m2sK
Tw: 1473.15 K
Tf: 1502.2 K
dT: -29.0523 K
q : -27182.4 J/m2s
A : 0.00245336 m2
Q : -66.6883 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -6.26879e-06
Maximum Fluid Concentration: 252.245
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.926525, Final residual = 8.48233e-05, No Iterations 14
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.917591, Final residual = 7.91568e-05, No Iterations 15
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.939596, Final residual = 9.90937e-05, No Iterations 13
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-1.19213e+08 2.06514e+07 -1.11767e+08)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.398995 -1.0084e-11 1.0375
MULES: Solving for alpha.air
air volume fraction, min, max = 0.5999 0 1.00351
Phase-sum volume fraction, min, max = 0.998895 0.766999 1.0375
DILUPBiCGStab:  Solving for T, Initial residual = 0.42766, Final residual = 6.82605e-10, No Iterations 4
DILUPBiCGStab:  Solving for C, Initial residual = 0.0023569, Final residual = 1.71386e-09, No Iterations 3
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.380919, Final residual = 1.47104e-09, No Iterations 5
smoothSolver:  Solving for Uy, Initial residual = 0.0170896, Final residual = 9.29686e-09, No Iterations 4
smoothSolver:  Solving for Uz, Initial residual = 0.181624, Final residual = 9.61616e-09, No Iterations 4
GAMG:  Solving for p_rgh, Initial residual = 0.217184, Final residual = 1.19466e-07, No Iterations 13
GAMG:  Solving for p_rgh, Initial residual = 0.000551806, Final residual = 4.961e-09, No Iterations 9
time step continuity errors : sum local = 0.000967814, global = -0.000515286, cumulative = -0.000563073
GAMG:  Solving for p_rgh, Initial residual = 0.00272813, Final residual = 3.94493e-09, No Iterations 12
GAMGPCG:  Solving for p_rgh, Initial residual = 0.00519721, Final residual = 9.11077e-09, No Iterations 6
time step continuity errors : sum local = 0.000967803, global = -0.000515278, cumulative = -0.00107835
total convective particle-fluid heat flux [W] = 3.66135e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 155.238
ExecutionTime = 3.31 s  ClockTime = 4 s

Courant Number mean: 0.0826828 max: 8.48367

Debugging zero!

Interface Courant Number mean: 0.0131597 max: 5.95947

Debugging one!

Time = 0.0035


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80893
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  3 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107031        0.003    80893    1000652.8   -6145.8939  -0.66305894    20.970274 
  107036       0.0035    78567     11402178   -6145.8939  -0.66327361    20.970274 
Loop time of 0.174787 on 8 procs for 5 steps with 78567 atoms
Max time of 0.174787 on 8 procs for 5 steps with 78567 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.835468, Final residual = 8.17158e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.000203724, Final residual = 2.65571e-06, No Iterations 1
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.000162713, Final residual = 7.26413e-07, No Iterations 1
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.000176996, Final residual = 4.17968e-06, No Iterations 1

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.828685, Final residual = 7.14694e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.835342, Final residual = 8.59193e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.819991, Final residual = 6.4898e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.822281, Final residual = 7.58351e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.828744, Final residual = 9.03771e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.798999, Final residual = 5.68506e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.818753, Final residual = 4.82681e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.821628, Final residual = 6.57547e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.839558, Final residual = 6.76168e-05, No Iterations 8
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1563.87
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249862 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.437168
U : (0.00112095 -0.0010341 -0.00948336) m/s
G : (0.000122444 -0.000112957 -0.00103589) kg/m2s
mG: 0.0010492 kg/m2s
Re: 0.279786
Pr: 0.045
JH: 0.258027
h : 2.5625 J/m2sK
Tw: 1473.15 K
Tf: 1482.52 K
dT: -9.37214 K
q : -24.0161 J/m2s
A : 0.00245342 m2
Q : -0.0589214 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249826 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.44026
U : (4.24092 125.59 -10.8644) m/s
G : (0.466451 13.8134 -1.19495) kg/m2s
mG: 13.8729 kg/m2s
Re: 3699.43
Pr: 0.045
JH: 0.0386726
h : 5078.21 J/m2sK
Tw: 1473.15 K
Tf: 1480.24 K
dT: -7.09062 K
q : -36007.7 J/m2s
A : 0.00245336 m2
Q : -88.3398 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -8.80751e-06
Maximum Fluid Concentration: 250.032
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.939791, Final residual = 7.55829e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.94005, Final residual = 6.70477e-05, No Iterations 13
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.945704, Final residual = 8.18714e-05, No Iterations 14
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-1.04992e+09 3.22671e+09 9.1591e+08)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.375428 -0.125127 1.47723
MULES: Solving for alpha.air
air volume fraction, min, max = 0.597081 -0.634523 1.0386
Phase-sum volume fraction, min, max = 0.972509 0.286358 1.37733
DILUPBiCGStab:  Solving for T, Initial residual = 0.818089, Final residual = 9.80879e-09, No Iterations 5
DILUPBiCGStab:  Solving for C, Initial residual = 0.0271802, Final residual = 3.13823e-09, No Iterations 6
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.445435, Final residual = 1.17569e-09, No Iterations 10
smoothSolver:  Solving for Uy, Initial residual = 0.05719, Final residual = 4.89233e-09, No Iterations 9
smoothSolver:  Solving for Uz, Initial residual = 0.188401, Final residual = 3.22484e-09, No Iterations 9
GAMG:  Solving for p_rgh, Initial residual = 0.639933, Final residual = 6.38567e-07, No Iterations 28
GAMG:  Solving for p_rgh, Initial residual = 0.00241871, Final residual = 6.86304e-09, No Iterations 19
time step continuity errors : sum local = 0.0154942, global = -0.0147224, cumulative = -0.0158008
GAMG:  Solving for p_rgh, Initial residual = 0.0315335, Final residual = 3.08769e-08, No Iterations 25
GAMGPCG:  Solving for p_rgh, Initial residual = 0.00559435, Final residual = 2.0497e-09, No Iterations 7
time step continuity errors : sum local = 0.0154938, global = -0.0147219, cumulative = -0.0305227
total convective particle-fluid heat flux [W] = -7.45218e+10
total convective particle-fluid mass flux [kg/s] (Eulerian) = 499.255
ExecutionTime = 3.83 s  ClockTime = 5 s

Courant Number mean: 2.95736 max: 377.599

Debugging zero!

Interface Courant Number mean: 2.57219 max: 377.599

Debugging one!

Time = 0.004


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 78567
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  3 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107036       0.0035    78567     11402178   -6145.8939  -0.66327361    20.970274 
[0] #0  Foam::error::printStack(Foam::Ostream&) at ??:?
[0] #1  Foam::sigFpe::sigHandler(int) at ??:?
[0] #2  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[0] #3  ? in "/lib/x86_64-linux-gnu/libm.so.6"
[0] #4  ? at fix_heat_gran_conduction.cpp:?
[0] #5  LAMMPS_NS::FixHeatGranCond::post_force(int) at ??:?
[0] #6  LAMMPS_NS::Modify::post_force(int) at ??:?
[0] #7  LAMMPS_NS::Verlet::run(int) at ??:?
[0] #8  LAMMPS_NS::Run::command(int, char**) at ??:?
[0] #9  void LAMMPS_NS::Input::command_creator<LAMMPS_NS::Run>(LAMMPS_NS::LAMMPS*, int, char**) at ??:?
[0] #10  LAMMPS_NS::Input::execute_command() at ??:?
[0] #11  LAMMPS_NS::Input::one(char const*) at ??:?
[0] #12  Foam::twoWayMPI::couple(int) at ??:?
[0] #13  Foam::cfdemCloud::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[0] #14  Foam::cfdemCloudEnergy::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[0] #15  main in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[0] #16  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[0] #17  __libc_start_main in "/lib/x86_64-linux-gnu/libc.so.6"
[0] #18  ? in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[TUE035485:11430] *** Process received signal ***
[TUE035485:11430] Signal: Floating point exception (8)
[TUE035485:11430] Signal code:  (-6)
[TUE035485:11430] Failing at address: 0x3e800002ca6
[TUE035485:11430] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x45320)[0x7f3f33549320]
[TUE035485:11430] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x11c)[0x7f3f335a2b1c]
[TUE035485:11430] [ 2] /lib/x86_64-linux-gnu/libc.so.6(gsignal+0x1e)[0x7f3f3354926e]
[TUE035485:11430] [ 3] /lib/x86_64-linux-gnu/libc.so.6(+0x45320)[0x7f3f33549320]
[TUE035485:11430] [ 4] /lib/x86_64-linux-gnu/libm.so.6(+0x153a4)[0x7f3f3375b3a4]
[TUE035485:11430] [ 5] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(+0x109fe41)[0x7f3f30aeee41]
[TUE035485:11430] [ 6] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS15FixHeatGranCond10post_forceEi+0xb2)[0x7f3f30aef6d2]
[TUE035485:11430] [ 7] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Modify10post_forceEi+0x57)[0x7f3f31ec9fc7]
[TUE035485:11430] [ 8] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Verlet3runEi+0x3e2)[0x7f3f3202c1f2]
[TUE035485:11430] [ 9] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS3Run7commandEiPPc+0x2b0)[0x7f3f31fc7e00]
[TUE035485:11430] [10] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15command_creatorINS_3RunEEEvPNS_6LAMMPSEiPPc+0x42)[0x7f3f31e862c2]
[TUE035485:11430] [11] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15execute_commandEv+0x820)[0x7f3f31e842a0]
[TUE035485:11430] [12] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input3oneEPKc+0x89)[0x7f3f31e84e09]
[TUE035485:11430] [13] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam9twoWayMPI6coupleEi+0x8d3)[0x7f3f3485d4a3]
[TUE035485:11430] [14] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam10cfdemCloud6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x7d5)[0x7f3f3455bde5]
[TUE035485:11430] [15] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam16cfdemCloudEnergy6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x2a)[0x7f3f345be7aa]
[TUE035485:11430] [16] cfdemSolverMultiphaseScalar(main+0x4d2f)[0x556723bb6eef]
[TUE035485:11430] [17] /lib/x86_64-linux-gnu/libc.so.6(+0x2a1ca)[0x7f3f3352e1ca]
[TUE035485:11430] [18] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x8b)[0x7f3f3352e28b]
[TUE035485:11430] [19] cfdemSolverMultiphaseScalar(+0x41875)[0x556723bbd875]
[TUE035485:11430] *** End of error message ***
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun noticed that process rank 0 with PID 0 on node TUE035485 exited on signal 8 (Floating point exception).
--------------------------------------------------------------------------

//   small_hearth   //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Jan 23 2025
Time   : 10:15:40
Host   : "TUE035485"
PID    : 2449
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.2450"
"TUE035485.2451"
"TUE035485.2452"
"TUE035485.2453"
"TUE035485.2454"
"TUE035485.2455"
"TUE035485.2456"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0


PIMPLE: Operating solver in PISO mode


Reading momentum exchange field Ksl


Reading voidfraction field voidfraction = (Vgas/Vparticle)

Reading particle velocity field Us

Reading field p_rgh

Reading field U

Reading/calculating face flux field phi

Selecting incompressible transport model Newtonian
Selecting incompressible transport model Newtonian
Reading/creating thermal fields

Reading/creating concentration fields

Selecting turbulence model type laminar

Reading g

Reading hRef
Calculating field g.h

No finite volume options present

GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
time step continuity errors : sum local = 0, global = 0, cumulative = 0
Courant Number mean: 0 max: 0
Selecting dataExchangeModel twoWayMPI
Starting up LIGGGHTS for first time execution
Executing input script '../DEM/in.liggghts_run'
LIGGGHTS (Version LIGGGHTS-PFM 24.01, compiled 2025-01-17-18:01:04 by ht45454, git commit d075b97762ce4302707903718dda170920e630bd, based on LAMMPS 23 Nov 2013)
log             ../log/log.liggghts_run
thermo_log      ../log/thermo.txt

atom_style      granular
atom_modify     map array
boundary        f f f
newton          off

communicate     single vel yes

units           si
processors      2 2 2

# read the restart file
read_restart    ../DEM/post/restart/liggghts.restartSequence
Reading restart file ...
  orthogonal box = (-0.5 -0.5 -0.0025) to (0.5 0.5 1)
  2 by 2 by 2 MPI processor grid
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
  80888 atoms

neighbor        0.007 bin
neigh_modify    delay 0

# contact model
include         ../DEM/in.contact_settings
# Material properties required for granular pair styles
fix             m1 all property/global youngsModulus	                peratomtype       5.e6
fix             m2 all property/global poissonsRatio 	                peratomtype	  0.3
fix             m3 all property/global coefficientRestitution           peratomtypepair 1 0.3
fix             m4 all property/global coefficientFriction 	        peratomtypepair 1 0.5
fix             m5 all property/global coefficientRollingFriction       peratomtypepair 1 0.2
fix             m6 all property/global coefficientRollingViscousDamping peratomtypepair 1 0.3

# pair style
pair_style	gran model hertz tangential history rolling_friction epsd
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
pair_coeff  	* *

# hearth settings
include         ../DEM/in.hearth_settings
# hearth settings
variable        hearthRadius  equal 0.5     # hearth radius (m)
variable        coreRadius    equal 0.15    # radius of core region (m)
variable        liquidLevel   equal 0.4     # initial liquid level (m) [set in setFieldsDict as well!]
variable        liquidDensity equal 6700.   # liquid density (kg/m3)

# heat/mass transfer settings
variable        particlekInit equal 5000    # particle thermal conductivity during init (W/Km)
variable        particlekRun  equal 40.0    # particle thermal conductivity during run  (W/Km) [sped up! 2.0*20!]
variable        particleCp    equal 870     # particle heat capacity (J/kgK)
variable        Tinlet        equal 1823.15 # particle inlet temperature (K) [set in CFD as well!]
variable        Tinit         equal 1623.15 # initial temperature (K) [set in CFD as well!]
variable        Twall         equal 1423.15 # wall temperature (K) [set in CFD as well!]
variable        rRemove       equal 0.001   # radius at which dissolved particles are removed (m)

# zone definitions
variable        forceZmin     equal 0.70    # lower boundary of force zone (m)
variable        forceZmax     equal 0.80    # upper boundary of force zone (m)
variable        insZmin       equal 0.70    # lower boundary of insertion zone (m)
variable        insZmax       equal 0.80    # upper boundary of insertion zone (m)

region          bedReg        cylinder z 0 0 ${hearthRadius} 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            0.8
region          coreReg       cylinder z 0 0 ${coreRadius}   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            0.8 side in
region          invCoreReg    cylinder z 0 0 ${coreRadius}   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            0.8 side out
region          shellReg      intersect 2 bedReg invCoreReg

region		insReg        cylinder z 0 0 ${hearthRadius} ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   0.8
region          insCoreReg    intersect 2 insReg coreReg
region          insShellReg   intersect 2 insReg invCoreReg

region		forceReg      cylinder z 0 0 ${hearthRadius} ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 0.8
region          freeboard     cylinder z 0 0 ${hearthRadius} ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 0.8 INF

region          mushroom      block 0.4 0.5 -0.05 0.05 0.2 0.3 side out # mushroom cutout
region          initReg       intersect 2 bedReg mushroom # entire bed minus mushroom
region          initCoreReg   intersect 2 initReg coreReg
region          initShellReg  intersect 2 initReg invCoreReg

# total burden weight
variable        pressureMin   equal 2000    # lower pressure value (Pa), near wall
variable        pressureMax   equal 20000   # upper pressure value (Pa), near core

# kinetic energy
variable        kinEn         equal ke      # kinetic energy (J)
variable        kinEnMax      equal 2.      # kinetic energy threshold for init (J)

# coke removal settings
variable        cokeRateInit  equal 20.     # coke combustion rate during init (kg/s)
variable        cokeRateRun   equal 1.      # coke combustion rate during run (kg/s)
variable        delInt        equal 0.1     # removal interval (s) [set in liggghtsCommands as well!]

variable        nFreeboard    equal count(all,freeboard)

variable        nRaceways     equal count(all,raceways)
variable        mRaceways     equal mass(all,raceways)
variable        avMass        equal "v_mRaceways/(v_nRaceways+1e-3)"

variable        delIntSteps   equal "floor(v_delInt/dt)"

variable        nDelInit      equal "v_delIntSteps*dt*v_cokeRateInit/v_avMass"
variable        fDelInit      equal "v_nDelInit/(v_nRaceways+1e-3)"

variable        nDelRun       equal "v_delIntSteps*dt*v_cokeRateRun/(v_avMass+1e-3)"
variable        fDelRun       equal "v_nDelRun/(v_nRaceways+1e-3)"




# timestep
timestep        1e-4

# cfd coupling
fix             cfd all couple/cfd couple_every 100 mpi
nevery as specified in LIGGGHTS is overriden by calling external program (/home/ht45454/CFDEM/LIGGGHTS/src/cfd_datacoupling_mpi.cpp:56)
fix             cfd2 all couple/cfd/force/implicit

# heat transfer
fix             m7 all property/global thermalConductivity peratomtype ${particlekRun} # lambda in [W/(K*m)]
fix             m7 all property/global thermalConductivity peratomtype 40 
fix             m8 all property/global thermalCapacity     peratomtype ${particleCp}   # cp in [J/(kg*K)]
fix             m8 all property/global thermalCapacity     peratomtype 870   
fix             heattransfer all heat/gran/conduction initial_temperature ${Tinlet}
fix             heattransfer all heat/gran/conduction initial_temperature 1823.15
Resetting global state of Fix Temp Style property/atom from restart file info
Resetting per-atom state of Fix Temp Style property/atom from restart file info
Resetting global state of Fix heatFlux Style property/atom from restart file info
Resetting per-atom state of Fix heatFlux Style property/atom from restart file info
Resetting global state of Fix heatSource Style property/atom from restart file info
Resetting per-atom state of Fix heatSource Style property/atom from restart file info
fix             cfd3 all couple/cfd/convection T0 ${Tinlet}
fix             cfd3 all couple/cfd/convection T0 1823.15

# mass transfer
fix             cfd4 all couple/cfd/dissolve rmin ${rRemove}
fix             cfd4 all couple/cfd/dissolve rmin 0.001

# walls
include         ../DEM/in.wall_settings
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature ${Twall} curvature 1e-5
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature 1423.15 curvature 1e-5
Resetting global state of Fix sides Style mesh/surface from restart file info
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature ${Twall}
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature 1423.15
Resetting global state of Fix bottom Style mesh/surface from restart file info
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature ${Twall}
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature 1423.15
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
Resetting global state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting global state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting global state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting global state of Fix tracker_bottom Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_bottom Style contacthistory/mesh from restart file info

# gravity
fix		gravi all gravity 9.81 vector 0.0 0.0 -1.0

######################################

# particle distribution
include	   	../DEM/in.particleSizeDistribution1
# Particle size distribution for LIGGGHTS

# mean radius = 0.0100000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts1 all particletemplate/sphere 10007 atom_type 1 density constant 900 radius constant 0.01
Resetting global state of Fix pts1 Style particletemplate/sphere from restart file info

fix	pdd1 all particledistribution/discrete 10009 1 pts1 1.000000
Fix particledistribution/discrete (id pdd1): distribution based on mass%:
    pts1: d=2.000000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd1): distribution based on number%:
    pts1: d=2.000000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd1 Style particledistribution/discrete from restart file info
include	   	../DEM/in.particleSizeDistribution2
# Particle size distribution for LIGGGHTS

# mean radius = 0.0125000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts2 all particletemplate/sphere 10037 atom_type 1 density constant 900 radius constant 0.0125
Resetting global state of Fix pts2 Style particletemplate/sphere from restart file info

fix	pdd2 all particledistribution/discrete 10039 1 pts2 1.000000
Fix particledistribution/discrete (id pdd2): distribution based on mass%:
    pts2: d=2.500000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd2): distribution based on number%:
    pts2: d=2.500000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd2 Style particledistribution/discrete from restart file info

# raceways
include		../DEM/in.raceways
# Raceway definition for LIGGGHTS

# reactor radius = 0.500000 m
# raceway height = 0.500000 m
# raceway diameter = 0.100000 m
# raceway length = 0.100000 m
# number of raceways = 8

variable angle1 equal 0.000000
region raceway1 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle1 0 0 0 0 0 1
variable angle2 equal 0.785398
region raceway2 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle2 0 0 0 0 0 1
variable angle3 equal 1.570796
region raceway3 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle3 0 0 0 0 0 1
variable angle4 equal 2.356194
region raceway4 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle4 0 0 0 0 0 1
variable angle5 equal 3.141593
region raceway5 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle5 0 0 0 0 0 1
variable angle6 equal 3.926991
region raceway6 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle6 0 0 0 0 0 1
variable angle7 equal 4.712389
region raceway7 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle7 0 0 0 0 0 1
variable angle8 equal 5.497787
region raceway8 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle8 0 0 0 0 0 1

region raceways union 8 raceway1 raceway2 raceway3 raceway4 raceway5 raceway6 raceway7 raceway8

# burden weight
include         ../DEM/in.pressure_profile
# Pressure profile definition for LIGGGHTS

# reactor radius = 0.500000 m
# R1 = 0.150000 m
# R2 = 0.400000 m
# number of bins = 12

# Region01
region   forceReg01		 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side in  	# center region
region   forceReg01		 cylinder z 0 0 0.15	0.7 ${forceZmax} side in  	
region   forceReg01		 cylinder z 0 0 0.15	0.7 0.8 side in  	
variable nForceReg01	 equal count(all,forceReg01) 								# number of particles inside
variable forceRegArea01	 equal 0.070686												# ring area (m2)
variable forceFact01	 equal 1												# force factor [0-1] (-)
variable totalForce01	 equal "-(v_forceFact01*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea01"	# total force (N)
variable forcePerPart01	 equal "v_totalForce01/(v_nForceReg01+1e-3)"				# force per particle (N)
fix      force01		 all addforce 0 0 v_forcePerPart01 region forceReg01		# apply force

# Region02
region   forceRegIn02	 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 ${forceZmax} side out 	
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 0.8 side out 	
region   forceRegOut02	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side in  	
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 0.8 side in  	
region   forceReg02		 intersect 2 forceRegIn02 forceRegOut02						# annular region
variable nForceReg02	 equal count(all,forceReg02) 								# number of particles inside
variable forceRegArea02	 equal 0.020998												# ring area (m2)
variable forceFact02	 equal 0.95833												# force factor [0-1] (-)
variable totalForce02	 equal "-(v_forceFact02*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea02"	# total force (N)
variable forcePerPart02	 equal "v_totalForce02/(v_nForceReg02+1e-3)"				# force per particle (N)
fix      force02		 all addforce 0 0 v_forcePerPart02 region forceReg02		# apply force

# Region03
region   forceRegIn03	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side out 	
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 0.8 side out 	
region   forceRegOut03	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side in  	
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 0.8 side in  	
region   forceReg03		 intersect 2 forceRegIn03 forceRegOut03						# annular region
variable nForceReg03	 equal count(all,forceReg03) 								# number of particles inside
variable forceRegArea03	 equal 0.023726												# ring area (m2)
variable forceFact03	 equal 0.875												# force factor [0-1] (-)
variable totalForce03	 equal "-(v_forceFact03*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea03"	# total force (N)
variable forcePerPart03	 equal "v_totalForce03/(v_nForceReg03+1e-3)"				# force per particle (N)
fix      force03		 all addforce 0 0 v_forcePerPart03 region forceReg03		# apply force

# Region04
region   forceRegIn04	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side out 	
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 0.8 side out 	
region   forceRegOut04	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side in  	
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 0.8 side in  	
region   forceReg04		 intersect 2 forceRegIn04 forceRegOut04						# annular region
variable nForceReg04	 equal count(all,forceReg04) 								# number of particles inside
variable forceRegArea04	 equal 0.026453												# ring area (m2)
variable forceFact04	 equal 0.79167												# force factor [0-1] (-)
variable totalForce04	 equal "-(v_forceFact04*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea04"	# total force (N)
variable forcePerPart04	 equal "v_totalForce04/(v_nForceReg04+1e-3)"				# force per particle (N)
fix      force04		 all addforce 0 0 v_forcePerPart04 region forceReg04		# apply force

# Region05
region   forceRegIn05	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side out 	
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 0.8 side out 	
region   forceRegOut05	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side in  	
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 0.8 side in  	
region   forceReg05		 intersect 2 forceRegIn05 forceRegOut05						# annular region
variable nForceReg05	 equal count(all,forceReg05) 								# number of particles inside
variable forceRegArea05	 equal 0.02918												# ring area (m2)
variable forceFact05	 equal 0.70833												# force factor [0-1] (-)
variable totalForce05	 equal "-(v_forceFact05*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea05"	# total force (N)
variable forcePerPart05	 equal "v_totalForce05/(v_nForceReg05+1e-3)"				# force per particle (N)
fix      force05		 all addforce 0 0 v_forcePerPart05 region forceReg05		# apply force

# Region06
region   forceRegIn06	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side out 	
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 0.8 side out 	
region   forceRegOut06	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side in  	
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 0.8 side in  	
region   forceReg06		 intersect 2 forceRegIn06 forceRegOut06						# annular region
variable nForceReg06	 equal count(all,forceReg06) 								# number of particles inside
variable forceRegArea06	 equal 0.031907												# ring area (m2)
variable forceFact06	 equal 0.625												# force factor [0-1] (-)
variable totalForce06	 equal "-(v_forceFact06*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea06"	# total force (N)
variable forcePerPart06	 equal "v_totalForce06/(v_nForceReg06+1e-3)"				# force per particle (N)
fix      force06		 all addforce 0 0 v_forcePerPart06 region forceReg06		# apply force

# Region07
region   forceRegIn07	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side out 	
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 0.8 side out 	
region   forceRegOut07	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 ${forceZmax} side in  	
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 0.8 side in  	
region   forceReg07		 intersect 2 forceRegIn07 forceRegOut07						# annular region
variable nForceReg07	 equal count(all,forceReg07) 								# number of particles inside
variable forceRegArea07	 equal 0.034634												# ring area (m2)
variable forceFact07	 equal 0.54167												# force factor [0-1] (-)
variable totalForce07	 equal "-(v_forceFact07*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea07"	# total force (N)
variable forcePerPart07	 equal "v_totalForce07/(v_nForceReg07+1e-3)"				# force per particle (N)
fix      force07		 all addforce 0 0 v_forcePerPart07 region forceReg07		# apply force

# Region08
region   forceRegIn08	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 ${forceZmax} side out 	
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 0.8 side out 	
region   forceRegOut08	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side in  	
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 0.8 side in  	
region   forceReg08		 intersect 2 forceRegIn08 forceRegOut08						# annular region
variable nForceReg08	 equal count(all,forceReg08) 								# number of particles inside
variable forceRegArea08	 equal 0.037361												# ring area (m2)
variable forceFact08	 equal 0.45833												# force factor [0-1] (-)
variable totalForce08	 equal "-(v_forceFact08*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea08"	# total force (N)
variable forcePerPart08	 equal "v_totalForce08/(v_nForceReg08+1e-3)"				# force per particle (N)
fix      force08		 all addforce 0 0 v_forcePerPart08 region forceReg08		# apply force

# Region09
region   forceRegIn09	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side out 	
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 0.8 side out 	
region   forceRegOut09	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side in  	
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 0.8 side in  	
region   forceReg09		 intersect 2 forceRegIn09 forceRegOut09						# annular region
variable nForceReg09	 equal count(all,forceReg09) 								# number of particles inside
variable forceRegArea09	 equal 0.040088												# ring area (m2)
variable forceFact09	 equal 0.375												# force factor [0-1] (-)
variable totalForce09	 equal "-(v_forceFact09*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea09"	# total force (N)
variable forcePerPart09	 equal "v_totalForce09/(v_nForceReg09+1e-3)"				# force per particle (N)
fix      force09		 all addforce 0 0 v_forcePerPart09 region forceReg09		# apply force

# Region10
region   forceRegIn10	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side out 	
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 0.8 side out 	
region   forceRegOut10	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side in  	
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 0.8 side in  	
region   forceReg10		 intersect 2 forceRegIn10 forceRegOut10						# annular region
variable nForceReg10	 equal count(all,forceReg10) 								# number of particles inside
variable forceRegArea10	 equal 0.042815												# ring area (m2)
variable forceFact10	 equal 0.29167												# force factor [0-1] (-)
variable totalForce10	 equal "-(v_forceFact10*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea10"	# total force (N)
variable forcePerPart10	 equal "v_totalForce10/(v_nForceReg10+1e-3)"				# force per particle (N)
fix      force10		 all addforce 0 0 v_forcePerPart10 region forceReg10		# apply force

# Region11
region   forceRegIn11	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side out 	
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 0.8 side out 	
region   forceRegOut11	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side in  	
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 0.8 side in  	
region   forceReg11		 intersect 2 forceRegIn11 forceRegOut11						# annular region
variable nForceReg11	 equal count(all,forceReg11) 								# number of particles inside
variable forceRegArea11	 equal 0.045542												# ring area (m2)
variable forceFact11	 equal 0.20833												# force factor [0-1] (-)
variable totalForce11	 equal "-(v_forceFact11*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea11"	# total force (N)
variable forcePerPart11	 equal "v_totalForce11/(v_nForceReg11+1e-3)"				# force per particle (N)
fix      force11		 all addforce 0 0 v_forcePerPart11 region forceReg11		# apply force

# Region12
region   forceRegIn12	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side out 	
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 0.8 side out 	
region   forceRegOut12	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side in  	
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 0.8 side in  	
region   forceReg12		 intersect 2 forceRegIn12 forceRegOut12						# annular region
variable nForceReg12	 equal count(all,forceReg12) 								# number of particles inside
variable forceRegArea12	 equal 0.048269												# ring area (m2)
variable forceFact12	 equal 0.125												# force factor [0-1] (-)
variable totalForce12	 equal "-(v_forceFact12*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea12"	# total force (N)
variable forcePerPart12	 equal "v_totalForce12/(v_nForceReg12+1e-3)"				# force per particle (N)
fix      force12		 all addforce 0 0 v_forcePerPart12 region forceReg12		# apply force

# Region13
region   forceRegIn13	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side out 	
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 0.8 side out 	
region   forceRegOut13	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 ${forceZmax} side in  	
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 0.8 side in  	
region   forceReg13		 intersect 2 forceRegIn13 forceRegOut13						# annular region
variable nForceReg13	 equal count(all,forceReg13) 								# number of particles inside
variable forceRegArea13	 equal 0.050996												# ring area (m2)
variable forceFact13	 equal 0.041667												# force factor [0-1] (-)
variable totalForce13	 equal "-(v_forceFact13*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea13"	# total force (N)
variable forcePerPart13	 equal "v_totalForce13/(v_nForceReg13+1e-3)"				# force per particle (N)
fix      force13		 all addforce 0 0 v_forcePerPart13 region forceReg13		# apply force

# Region14
region   forceRegIn14	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 ${forceZmax} side out 	
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 0.8 side out 	
region   forceRegOut14	 cylinder z 0 0 0.5	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 ${forceZmax} side in  	
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 0.8 side in  	
region   forceReg14		 intersect 2 forceRegIn14 forceRegOut14						# annular region
variable nForceReg14	 equal count(all,forceReg14) 								# number of particles inside
variable forceRegArea14	 equal 0.28274												# ring area (m2)
variable forceFact14	 equal 0												# force factor [0-1] (-)
variable totalForce14	 equal "-(v_forceFact14*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea14"	# total force (N)
variable forcePerPart14	 equal "v_totalForce14/(v_nForceReg14+1e-3)"				# force per particle (N)
fix      force14		 all addforce 0 0 v_forcePerPart14 region forceReg14		# apply force

variable totalForce		 equal "v_forcePerPart01*v_nForceReg01+v_forcePerPart02*v_nForceReg02+v_forcePerPart03*v_nForceReg03+v_forcePerPart04*v_nForceReg04+v_forcePerPart05*v_nForceReg05+v_forcePerPart06*v_nForceReg06+v_forcePerPart07*v_nForceReg07+v_forcePerPart08*v_nForceReg08+v_forcePerPart09*v_nForceReg09+v_forcePerPart10*v_nForceReg10+v_forcePerPart11*v_nForceReg11+v_forcePerPart12*v_nForceReg12+v_forcePerPart13*v_nForceReg13+v_forcePerPart14*v_nForceReg14" 	# sum of all forces (N)
variable nForceReg		 equal "v_nForceReg01+v_nForceReg02+v_nForceReg03+v_nForceReg04+v_nForceReg05+v_nForceReg06+v_nForceReg07+v_nForceReg08+v_nForceReg09+v_nForceReg10+v_nForceReg11+v_nForceReg12+v_nForceReg13+v_nForceReg14" 	# sum of all numbers of particles (N)
variable avForcePerPart	 equal "v_totalForce/(v_nForceReg+1e-3)"	# average force per particle (N)

# insert in insertion volume
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every ${delIntSteps} overlapcheck yes region insShellReg volumefraction_region 0.7
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every 1000 overlapcheck yes region insShellReg volumefraction_region 0.7
INFO: Resetting random generator for region insShellReg
Resetting global state of Fix ins3 Style insert/pack from restart file info
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every ${delIntSteps} overlapcheck yes region insCoreReg  volumefraction_region 0.7
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every 1000 overlapcheck yes region insCoreReg  volumefraction_region 0.7
INFO: Resetting random generator for region insCoreReg
Resetting global state of Fix ins4 Style insert/pack from restart file info

######################################

# apply nve integration to all particles
fix             integr all nve/sphere

# output settings
thermo_style    custom step time atoms ke v_totalForce v_avForcePerPart v_nDelRun
thermo          10

# dump settings
dump            dmp all custom 5000 ../DEM/post/dump*.liggghts_run id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius density f_Temp[0] f_convectiveHeatFlux[0] f_convectiveMassFlux[0]
#5000
run             0
Resetting global state of Fix contacthistory Style contacthistory from restart file info
Resetting per-atom state of Fix contacthistory Style contacthistory from restart file info
Setting up run ...
Import and parallelization of mesh sides containing 2592 triangle(s) successful
Import and parallelization of mesh bottom containing 1024 triangle(s) successful
INFO: Resetting random generator for region insShellReg
INFO: Particle insertion ins3: inserting every 1000 steps
INFO: Resetting random generator for region insCoreReg
INFO: Particle insertion ins4: inserting every 1000 steps
Memory usage per processor = 24.93 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107001            0    80888  0.084448594   -6145.8938   -0.6678141          100 
Loop time of 3.14425e-06 on 8 procs for 0 steps with 80888 atoms
Max time of 3.384e-06 on 8 procs for 0 steps with 80888 atoms

Pair  time (%) = 0 (0)
Max Pair time (ib) = 0 (0)
Neigh time (%) = 0 (0)
Max Neigh time (ib) = 0 (0)
Comm  time (%) = 0 (0)
Max Comm time (ib) = 0 (0)
Outpt time (%) = 0 (0)
Max Outpt time (ib) = 0 (0)
Other time (%) = 3.14425e-06 (100)
Max Other time (ib) = 3.384e-06 (7.62503)

Nlocal:    10111 ave 12700 max 7448 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:    2253.75 ave 2657 max 1844 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:    57335.1 ave 71932 max 42273 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 458681
Ave neighs/atom = 5.67057
Neighbor list builds = 0
Dangerous builds = 0

Selecting locateModel engine
Selecting IOModel basicIO
Selecting probeModel off
Selecting voidFractionModel divided
Selecting averagingModel dense
Selecting clockModel standardClock
start clock measurement at t >0.0005
Selecting smoothingModel constDiffSmoothing
Selecting meshMotionModel noMeshMotion

CFDEMcoupling version: 24.01
compatible to LIGGGHTS version: 24.01
compatible to OpenFOAM version: 4.x

You are currently using:
OpenFOAM version: 4.x
OpenFOAM build: 4.x-d214c8dfd5ba
CFDEM build: 

If BC are important, please provide volScalarFields -imp/expParticleForces-
Selecting momCoupleModel implicitCouple

implicit momentum exchange field calculate if alphaP larger than : 1
Selecting forceModel BeetstraDrag
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for implForceDEM ...
	implForceDEM = true
  looking for verbose ...
	verbose = false
  looking for interpolation ...
	interpolation = true
  looking for scalarViscosity ...
	scalarViscosity = false

--> FOAM Warning : Please make sure you use the new nomenclature for verbose force model settings, please have a look at the forceSubModel doc.
Selecting forceModel MeiLift
Lift model: including shear-induced term.
Lift model: including spin-induced term.
Make sure to use a rolling friction model in LIGGGHTS!
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for verbose ...
	verbose = false
  looking for interpolation ...
	interpolation = true
  looking for scalarViscosity ...
	scalarViscosity = false

--> FOAM Warning : Please make sure you use the new nomenclature for verbose force model settings, please have a look at the forceSubModel doc.
Selecting forceModel virtualMassForce
Selecting smoothingModel constDiffAndTemporalSmoothing
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for interpolation ...
	interpolation = true

Virtual mass model: using averaged Us 
WARNING: ignoring virtual mass of relative particle motion/collisions 
Virtual mass model: using Cadd correlation by Felderhof 
WARNING: ignoring user-set Cadd 
Selecting forceModel ParmarBassetForce
Selecting smoothingModel constDiffAndTemporalSmoothing
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for verbose ...
	verbose = false
  looking for interpolation ...
	interpolation = true

Selecting forceModel viscForce
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for treatForceDEM ...
	treatForceDEM = false
  looking for interpolation ...
	interpolation = false
  looking for scalarViscosity ...
	scalarViscosity = false

Using treatForceDEM true!
Selecting forceModel gradPForceSmooth
Selecting smoothingModel temporalSmoothing
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for treatForceDEM ...
	treatForceDEM = false
  looking for interpolation ...
	interpolation = false

Using treatForceDEM true!
Selecting forceModel surfaceTensionForce
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false

check if interpolation really works - use directly interpolationCellPoint<vector> ???
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand delete_atoms porosity raceways ${fDelRun} 123457 compress no 
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand write_restart ../DEM/post/restart/liggghts.restartSequence
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand delete_atoms region freeboard compress no 
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand set region raceways property/atom Temp ${Tinlet}
Selecting liggghtsCommandModel runLiggghts, provide dicts, numbered from 0 to n
Selecting liggghtsCommandModel writeLiggghts, provide dicts, numbered from 0 to n
writeLiggghts: A restart file writeName_write_restart ../DEM/post/restart/liggghts.restartCFDEM is written.
cg is set to: 1
Selecting thermCondModel SyamlalThermCond
Selecting diffCoeffModel SyamlalDiffCoeff
Selecting energyModel heatTransferGunn
Particle temperature field activated.
Selecting energyModel wallHeatTransferYagi
Selecting massTransferModel massTransferGunn
Selecting chemistryModel off
solving volume averaged Navier Stokes equations of type A
check if Archimedes lift is necessary (depends on pressure formulation)


Starting time loop


Debugging........

Courant Number mean: 0 max: 0

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.0005


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms porosity raceways ${fDelRun} 123457 compress no '
delete_atoms porosity raceways ${fDelRun} 123457 compress no 
delete_atoms porosity raceways 100000 123457 compress no 
Deleted 0 atoms, new total = 80888
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80888
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  0 settings made for property/atom
Executing command: 'run 5    '
run 5    
Setting up run ...
Memory usage per processor = 24.9304 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107001            0    80888  0.084448594   -6145.8938   -0.6678141          100 
insertion: proc 1 at 0 %
insertion: proc 3 at 0 %
insertion: proc 5 at 0 %
insertion: proc 7 at 0 %
INFO: Particle insertion ins3: inserted 63 particle templates (mass 0.237504) at step 107002
 - a total of 6239 particle templates (mass 23.520476) inserted so far.
WARNING: Particle insertion: Less insertions than requested (/home/ht45454/CFDEM/LIGGGHTS/src/fix_insert.cpp:814)
insertion: proc 7 at 0 %
insertion: proc 1 at 0 %
insertion: proc 3 at 0 %
insertion: proc 5 at 0 %
INFO: Particle insertion ins4: inserted 1 particle templates (mass 0.007363) at step 107002
 - a total of 289 particle templates (mass 2.127938) inserted so far.
WARNING: Particle insertion: Less insertions than requested (/home/ht45454/CFDEM/LIGGGHTS/src/fix_insert.cpp:814)
  107006       0.0005    80952    0.1909491   -6145.8939  -0.66313048    20.981317 
Loop time of 0.219344 on 8 procs for 5 steps with 80952 atoms
Max time of 0.219346 on 8 procs for 5 steps with 80952 atoms

Pair  time (%) = 0.0126767 (5.77937)
Max Pair time (ib) = 0.0211822 (67.0955)
Neigh time (%) = 0.00998402 (4.55176)
Max Neigh time (ib) = 0.0131147 (31.357)
Comm  time (%) = 0.00945628 (4.31116)
Max Comm time (ib) = 0.0154409 (63.2878)
Outpt time (%) = 0.0141038 (6.42997)
Max Outpt time (ib) = 0.0141374 (0.238122)
Other time (%) = 0.173124 (78.9277)
Max Other time (ib) = 0.17542 (1.32666)

Nlocal:    10119 ave 12700 max 7475 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:    2255.62 ave 2657 max 1849 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:    57372.9 ave 71932 max 42411 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 458983
Ave neighs/atom = 5.66982
Neighbor list builds = 1
Dangerous builds = 0
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804666, Final residual = 8.52051e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 3.87428e-05, Final residual = 3.87428e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 5.9341e-05, Final residual = 5.9341e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 1.20545e-05, Final residual = 1.20545e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.532871, Final residual = 5.58457e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.601756, Final residual = 8.22109e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.201819, Final residual = 4.98672e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1532.39
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.435725
U : (0 0 0) m/s
G : (0 0 0) kg/m2s
mG: 0 kg/m2s
Re: 0
Pr: 0.045
JH: 200
h : 0 J/m2sK
Tw: 1473.15 K
Tf: 1623.15 K
dT: -150 K
q : -0 J/m2s
A : 0.00245342 m2
Q : -0 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.438786
U : (0 0 0) m/s
G : (0 0 0) kg/m2s
mG: 0 kg/m2s
Re: 0
Pr: 0.045
JH: 200
h : 0 J/m2sK
Tw: 1473.15 K
Tf: 1623.15 K
dT: -150 K
q : -0 J/m2s
A : 0.00245336 m2
Q : -0 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: 0
Maximum Fluid Concentration: 235
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.755554, Final residual = 7.11445e-05, No Iterations 17
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.748133, Final residual = 8.84575e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.596, Final residual = 7.34851e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-47.2138 37.2366 -1028.14)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399432 0 1
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600568 0 1
Phase-sum volume fraction, min, max = 1 1 1
DILUPBiCGStab:  Solving for T, Initial residual = 1, Final residual = 1.82566e-09, No Iterations 1
DILUPBiCGStab:  Solving for C, Initial residual = 2.36622e-05, Final residual = 2.18951e-13, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 1, Final residual = 4.13543e-10, No Iterations 2
smoothSolver:  Solving for Uy, Initial residual = 1, Final residual = 2.14092e-10, No Iterations 2
smoothSolver:  Solving for Uz, Initial residual = 1, Final residual = 2.14186e-11, No Iterations 3
GAMG:  Solving for p_rgh, Initial residual = 1, Final residual = 7.23021e-07, No Iterations 5
GAMG:  Solving for p_rgh, Initial residual = 5.59773e-05, Final residual = 9.98001e-09, No Iterations 9
time step continuity errors : sum local = 4.66941e-09, global = -4.25438e-09, cumulative = -4.25438e-09
GAMG:  Solving for p_rgh, Initial residual = 0.00197122, Final residual = 5.81787e-09, No Iterations 10
GAMGPCG:  Solving for p_rgh, Initial residual = 5.04291e-05, Final residual = 5.50712e-09, No Iterations 4
time step continuity errors : sum local = 2.6169e-09, global = 2.05596e-11, cumulative = -4.23382e-09
total convective particle-fluid heat flux [W] = 1.05309e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 4.41767
ExecutionTime = 1.25 s  ClockTime = 1 s

Courant Number mean: 2.68783e-05 max: 0.00150604

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.001


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  1 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107006       0.0005    80952    0.1909491   -6145.8939  -0.66313048    20.981317 
  107010       0.0009    80952   0.50103593   -6145.8939  -0.66313048    20.973362 
  107011        0.001    80952    0.6461879   -6145.8939  -0.66320204    20.973444 
Loop time of 0.108607 on 8 procs for 5 steps with 80952 atoms
Max time of 0.108607 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804695, Final residual = 8.5156e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 4.22332e-05, Final residual = 4.22332e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 6.65886e-05, Final residual = 6.65886e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.29766e-05, Final residual = 2.29766e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.76984, Final residual = 6.78078e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.776678, Final residual = 8.53776e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.356355, Final residual = 6.30934e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.558657, Final residual = 9.8582e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.793917, Final residual = 4.24819e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.325427, Final residual = 5.76527e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.769782, Final residual = 6.785e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.779693, Final residual = 8.5844e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.356355, Final residual = 6.30939e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1534.36
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.43576
U : (-1.36444e-05 -8.45792e-05 -0.000120117) m/s
G : (-1.48643e-06 -9.21405e-06 -1.30856e-05) kg/m2s
mG: 1.6073e-05 kg/m2s
Re: 0.00428612
Pr: 0.045
JH: 0.595137
h : 0.090543 J/m2sK
Tw: 1473.15 K
Tf: 1586.95 K
dT: -113.799 K
q : -10.3037 J/m2s
A : 0.00245342 m2
Q : -0.0252793 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.438819
U : (5.5241e-05 0.00300945 -0.000135728) m/s
G : (6.0602e-06 0.000330152 -1.48901e-05) kg/m2s
mG: 0.000330543 kg/m2s
Re: 0.0881446
Pr: 0.045
JH: 0.32508
h : 1.01709 J/m2sK
Tw: 1473.15 K
Tf: 1591.58 K
dT: -118.43 K
q : -120.454 J/m2s
A : 0.00245336 m2
Q : -0.295518 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -1.1953e-19
Maximum Fluid Concentration: 235.008
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.732303, Final residual = 6.37878e-05, No Iterations 20
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.752341, Final residual = 9.18958e-05, No Iterations 19
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.809049, Final residual = 7.01984e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-1870.03 -1105.42 -12246.9)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399455 0 1.00424
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600538 0 1.00648
Phase-sum volume fraction, min, max = 0.999992 0.996064 1.00648
DILUPBiCGStab:  Solving for T, Initial residual = 0.0686948, Final residual = 7.79924e-11, No Iterations 1
DILUPBiCGStab:  Solving for C, Initial residual = 7.81235e-05, Final residual = 2.37448e-10, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.280063, Final residual = 1.11004e-09, No Iterations 2
smoothSolver:  Solving for Uy, Initial residual = 0.302326, Final residual = 7.07384e-10, No Iterations 2
smoothSolver:  Solving for Uz, Initial residual = 0.377803, Final residual = 2.02709e-09, No Iterations 2
GAMG:  Solving for p_rgh, Initial residual = 0.00180603, Final residual = 9.58822e-09, No Iterations 17
GAMG:  Solving for p_rgh, Initial residual = 4.73702e-05, Final residual = 7.5396e-09, No Iterations 9
time step continuity errors : sum local = 4.99069e-05, global = -3.11291e-06, cumulative = -3.11714e-06
GAMG:  Solving for p_rgh, Initial residual = 9.08842e-06, Final residual = 8.55641e-09, No Iterations 6
GAMGPCG:  Solving for p_rgh, Initial residual = 1.96193e-06, Final residual = 2.48021e-09, No Iterations 3
time step continuity errors : sum local = 4.99047e-05, global = -3.11102e-06, cumulative = -6.22816e-06
total convective particle-fluid heat flux [W] = 1.25072e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 5.61822
ExecutionTime = 1.76 s  ClockTime = 2 s

Courant Number mean: 0.000284655 max: 0.0464397

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.0015


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  2 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107011        0.001    80952    0.6461879   -6145.8939  -0.66320204    20.973444 
  107016       0.0015    80952    3.1189791   -6145.8939  -0.66313048    20.973937 
Loop time of 0.0933312 on 8 procs for 5 steps with 80952 atoms
Max time of 0.0933332 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804577, Final residual = 8.50707e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 5.43886e-05, Final residual = 5.43886e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 7.96604e-05, Final residual = 7.96604e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.40844e-05, Final residual = 2.40844e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.79111, Final residual = 4.48981e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.660313, Final residual = 6.18147e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.312564, Final residual = 6.67658e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.696938, Final residual = 5.86075e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.810373, Final residual = 8.43241e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.503184, Final residual = 5.55987e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.789198, Final residual = 5.39929e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.625967, Final residual = 6.62219e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.312727, Final residual = 6.67119e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1536.71
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.24998 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199999 m
ep: 0.435856
U : (1.91042e-05 -5.88365e-05 0.000765355) m/s
G : (2.0815e-06 -6.41055e-06 8.33895e-05) kg/m2s
mG: 8.36615e-05 kg/m2s
Re: 0.0223096
Pr: 0.045
JH: 0.427889
h : 0.338843 J/m2sK
Tw: 1473.15 K
Tf: 1557.95 K
dT: -84.7958 K
q : -28.7325 J/m2s
A : 0.00245342 m2
Q : -0.0704927 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249981 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199999 m
ep: 0.438904
U : (0.00121696 0.0387208 0.0204038) m/s
G : (0.000133522 0.00424836 0.00223865) kg/m2s
mG: 0.00480395 kg/m2s
Re: 1.28105
Pr: 0.045
JH: 0.190334
h : 8.6548 J/m2sK
Tw: 1473.15 K
Tf: 1565.07 K
dT: -91.9203 K
q : -795.552 J/m2s
A : 0.00245336 m2
Q : -1.95178 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -2.00982e-08
Maximum Fluid Concentration: 236.011
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.870363, Final residual = 6.25944e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.884229, Final residual = 6.29701e-05, No Iterations 19
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.843814, Final residual = 6.88154e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-554.114 15498.4 -28772.5)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399517 0 1.0063
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600474 0 1.00322
Phase-sum volume fraction, min, max = 0.999992 0.994884 1.0063
DILUPBiCGStab:  Solving for T, Initial residual = 0.0777959, Final residual = 9.29849e-10, No Iterations 2
DILUPBiCGStab:  Solving for C, Initial residual = 0.000150021, Final residual = 2.87533e-10, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.349492, Final residual = 1.39514e-10, No Iterations 4
smoothSolver:  Solving for Uy, Initial residual = 0.309333, Final residual = 3.92833e-10, No Iterations 4
smoothSolver:  Solving for Uz, Initial residual = 0.431568, Final residual = 9.8926e-09, No Iterations 3
GAMG:  Solving for p_rgh, Initial residual = 0.00195633, Final residual = 5.76696e-09, No Iterations 12
GAMG:  Solving for p_rgh, Initial residual = 0.000470057, Final residual = 8.89078e-09, No Iterations 11
time step continuity errors : sum local = 7.74661e-05, global = -4.12348e-06, cumulative = -1.03516e-05
GAMG:  Solving for p_rgh, Initial residual = 0.00014322, Final residual = 3.87342e-09, No Iterations 9
GAMGPCG:  Solving for p_rgh, Initial residual = 2.30486e-05, Final residual = 3.40948e-09, No Iterations 4
time step continuity errors : sum local = 7.74673e-05, global = -4.12428e-06, cumulative = -1.44759e-05
total convective particle-fluid heat flux [W] = 1.98537e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 9.85877
ExecutionTime = 2.27 s  ClockTime = 2 s

Courant Number mean: 0.00103508 max: 0.0907231

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.002


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  2 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107016       0.0015    80952    3.1189791   -6145.8939  -0.66313048    20.973937 
  107020       0.0019    80952    9.8517058   -6145.8939  -0.66305894    20.974687 
  107021        0.002    80952    10.894707   -6145.8939  -0.66320204    20.974875 
Loop time of 0.133338 on 8 procs for 5 steps with 80952 atoms
Max time of 0.133338 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.80458, Final residual = 8.47817e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 7.17035e-05, Final residual = 7.17035e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.000114345, Final residual = 4.97675e-07, No Iterations 1
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.13009e-05, Final residual = 2.13009e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.783222, Final residual = 7.39338e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.826907, Final residual = 9.36839e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.333575, Final residual = 7.26957e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.738742, Final residual = 8.8124e-05, No Iterations 9
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.825539, Final residual = 7.45413e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.673247, Final residual = 4.90688e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.78119, Final residual = 8.58712e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.759976, Final residual = 5.45715e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.327155, Final residual = 7.04004e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1540.44
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249945 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199999 m
ep: 0.436043
U : (-0.000240353 0.000144298 0.00139561) m/s
G : (-2.61953e-05 1.57266e-05 0.000152103) kg/m2s
mG: 0.000155141 kg/m2s
Re: 0.0413708
Pr: 0.045
JH: 0.378174
h : 0.555342 J/m2sK
Tw: 1473.15 K
Tf: 1533.54 K
dT: -60.3898 K
q : -33.537 J/m2s
A : 0.00245342 m2
Q : -0.0822803 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249952 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199998 m
ep: 0.439052
U : (-0.00593097 -0.169889 0.0675336) m/s
G : (-0.000650876 -0.018644 0.00741127) kg/m2s
mG: 0.0200736 kg/m2s
Re: 5.3529
Pr: 0.045
JH: 0.142992
h : 27.1693 J/m2sK
Tw: 1473.15 K
Tf: 1541.21 K
dT: -68.062 K
q : -1849.2 J/m2s
A : 0.00245336 m2
Q : -4.53675 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -1.06072e-07
Maximum Fluid Concentration: 236.503
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.832951, Final residual = 7.84512e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.877044, Final residual = 7.96755e-05, No Iterations 19
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.850405, Final residual = 6.82736e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (39162.8 56961.3 -315942)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399615 0 1.01155
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600372 0 1.00305
Phase-sum volume fraction, min, max = 0.999987 0.993038 1.01155
DILUPBiCGStab:  Solving for T, Initial residual = 0.118188, Final residual = 8.7212e-09, No Iterations 2
DILUPBiCGStab:  Solving for C, Initial residual = 0.000249173, Final residual = 2.13813e-09, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.267548, Final residual = 4.20075e-10, No Iterations 6
smoothSolver:  Solving for Uy, Initial residual = 0.319191, Final residual = 5.99364e-10, No Iterations 6
smoothSolver:  Solving for Uz, Initial residual = 0.243477, Final residual = 3.47532e-09, No Iterations 5
GAMG:  Solving for p_rgh, Initial residual = 0.0112744, Final residual = 7.65233e-09, No Iterations 16
GAMG:  Solving for p_rgh, Initial residual = 0.00136688, Final residual = 4.91865e-09, No Iterations 10
time step continuity errors : sum local = 0.000111641, global = -7.20463e-06, cumulative = -2.16805e-05
GAMG:  Solving for p_rgh, Initial residual = 0.00073184, Final residual = 9.64391e-09, No Iterations 13
GAMGPCG:  Solving for p_rgh, Initial residual = 0.000175917, Final residual = 4.0745e-09, No Iterations 5
time step continuity errors : sum local = 0.000111641, global = -7.20355e-06, cumulative = -2.88841e-05
total convective particle-fluid heat flux [W] = 3.20638e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 17.1794
ExecutionTime = 2.79 s  ClockTime = 3 s

Courant Number mean: 0.00404595 max: 0.353549

Debugging zero!

Interface Courant Number mean: 2.20653e-06 max: 0.013752

Debugging one!

Time = 0.0025


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  2 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107021        0.002    80952    10.894707   -6145.8939  -0.66320204    20.974875 
  107026       0.0025    80952    1108.5274   -6145.8939  -0.66327361    20.972953 
Loop time of 0.151704 on 8 procs for 5 steps with 80952 atoms
Max time of 0.151704 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.805227, Final residual = 8.34133e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.000118804, Final residual = 8.80495e-06, No Iterations 1
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 8.00823e-05, Final residual = 8.00823e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.54424e-05, Final residual = 2.54424e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.799894, Final residual = 5.78365e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.809642, Final residual = 7.19325e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.651961, Final residual = 8.38356e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.752191, Final residual = 4.48287e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.831507, Final residual = 7.31679e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.750165, Final residual = 8.17999e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.785911, Final residual = 5.3069e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.761358, Final residual = 8.13545e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.620447, Final residual = 4.68607e-05, No Iterations 11
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1546.46
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249893 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199998 m
ep: 0.436248
U : (-0.000324971 9.36401e-05 0.00110473) m/s
G : (-3.54268e-05 1.02082e-05 0.000120433) kg/m2s
mG: 0.00012595 kg/m2s
Re: 0.0335863
Pr: 0.045
JH: 0.394273
h : 0.470043 J/m2sK
Tw: 1473.15 K
Tf: 1513.5 K
dT: -40.3469 K
q : -18.9648 J/m2s
A : 0.00245342 m2
Q : -0.0465284 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249916 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199996 m
ep: 0.439238
U : (-0.0463022 -1.37052 0.143146) m/s
G : (-0.00508271 -0.150445 0.0157135) kg/m2s
mG: 0.151349 kg/m2s
Re: 40.359
Pr: 0.045
JH: 0.0954645
h : 136.761 J/m2sK
Tw: 1473.15 K
Tf: 1521.37 K
dT: -48.224 K
q : -6595.18 J/m2s
A : 0.00245336 m2
Q : -16.1804 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -4.74489e-07
Maximum Fluid Concentration: 237.766
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.878779, Final residual = 6.75485e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.882262, Final residual = 7.8021e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.922971, Final residual = 8.69998e-05, No Iterations 14
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (389917 -7.5042e+06 -2.10229e+06)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399747 -1.08499e-12 1.07919
MULES: Solving for alpha.air
air volume fraction, min, max = 0.60024 0 1.00385
Phase-sum volume fraction, min, max = 0.999987 0.948442 1.07919
DILUPBiCGStab:  Solving for T, Initial residual = 0.207608, Final residual = 3.09989e-09, No Iterations 3
DILUPBiCGStab:  Solving for C, Initial residual = 0.000624078, Final residual = 2.06857e-09, No Iterations 2
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.277505, Final residual = 6.60787e-09, No Iterations 6
smoothSolver:  Solving for Uy, Initial residual = 0.203774, Final residual = 1.10753e-09, No Iterations 7
smoothSolver:  Solving for Uz, Initial residual = 0.124679, Final residual = 2.17017e-09, No Iterations 6
GAMG:  Solving for p_rgh, Initial residual = 0.0791913, Final residual = 2.70386e-08, No Iterations 12
GAMG:  Solving for p_rgh, Initial residual = 0.00208924, Final residual = 9.42367e-09, No Iterations 10
time step continuity errors : sum local = 0.000263024, global = -1.29774e-05, cumulative = -4.18615e-05
GAMG:  Solving for p_rgh, Initial residual = 0.00364591, Final residual = 2.60604e-09, No Iterations 12
GAMGPCG:  Solving for p_rgh, Initial residual = 0.000608397, Final residual = 9.41927e-09, No Iterations 5
time step continuity errors : sum local = 0.000263027, global = -1.29815e-05, cumulative = -5.4843e-05
total convective particle-fluid heat flux [W] = 5.05597e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 36.7912
ExecutionTime = 3.31 s  ClockTime = 3 s

Courant Number mean: 0.0142592 max: 1.0421

Debugging zero!

Interface Courant Number mean: 0.000566139 max: 0.732815

Debugging one!

Time = 0.003


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  3 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107026       0.0025    80952    1108.5274   -6145.8939  -0.66327361    20.972953 
  107030       0.0029    80914    731050.14   -6145.8939   -0.6634168    20.973496 
  107031        0.003    80895    902771.96   -6145.8939  -0.66305894    20.973632 
Loop time of 0.188899 on 8 procs for 5 steps with 80895 atoms
Max time of 0.188957 on 8 procs for 5 steps with 80895 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.810101, Final residual = 8.04322e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.00015618, Final residual = 1.17802e-07, No Iterations 1
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.000109395, Final residual = 1.03859e-08, No Iterations 1
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.000104167, Final residual = 4.02902e-07, No Iterations 1

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.834662, Final residual = 8.68913e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.857741, Final residual = 6.07421e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.800438, Final residual = 9.61731e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.793387, Final residual = 6.05079e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.817347, Final residual = 8.2866e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.774494, Final residual = 6.80566e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.813279, Final residual = 4.79798e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.793102, Final residual = 9.37179e-05, No Iterations 9
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.800501, Final residual = 5.10469e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1555.94
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249882 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199997 m
ep: 0.436501
U : (0.00104337 -0.00270453 -0.00342279) m/s
G : (0.000113804 -0.000294993 -0.000373337) kg/m2s
mG: 0.000489237 kg/m2s
Re: 0.130461
Pr: 0.045
JH: 0.300562
h : 1.39186 J/m2sK
Tw: 1473.15 K
Tf: 1497.15 K
dT: -24.0014 K
q : -33.4066 J/m2s
A : 0.00245342 m2
Q : -0.0819602 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249894 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199993 m
ep: 0.439558
U : (0.542782 15.7388 -0.26211) m/s
G : (0.0596208 1.7288 -0.0287909) kg/m2s
mG: 1.73006 kg/m2s
Re: 461.335
Pr: 0.045
JH: 0.0586444
h : 960.353 J/m2sK
Tw: 1473.15 K
Tf: 1502.1 K
dT: -28.9496 K
q : -27801.9 J/m2s
A : 0.00245336 m2
Q : -68.2081 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -5.67488e-06
Maximum Fluid Concentration: 253.137
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.934186, Final residual = 7.33467e-05, No Iterations 14
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.936621, Final residual = 7.31807e-05, No Iterations 13
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.938114, Final residual = 9.13782e-05, No Iterations 13
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-1.93971e+08 8.65016e+07 -2.11139e+08)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399083 -8.42438e-11 1.03838
MULES: Solving for alpha.air
air volume fraction, min, max = 0.599882 0 1.00348
Phase-sum volume fraction, min, max = 0.998964 0.769742 1.03838
DILUPBiCGStab:  Solving for T, Initial residual = 0.427483, Final residual = 4.86423e-10, No Iterations 4
DILUPBiCGStab:  Solving for C, Initial residual = 0.00231379, Final residual = 3.32346e-09, No Iterations 3
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.404855, Final residual = 1.01433e-09, No Iterations 5
smoothSolver:  Solving for Uy, Initial residual = 0.0192365, Final residual = 7.04993e-09, No Iterations 4
smoothSolver:  Solving for Uz, Initial residual = 0.193282, Final residual = 6.97694e-09, No Iterations 4
GAMG:  Solving for p_rgh, Initial residual = 0.219714, Final residual = 1.58922e-07, No Iterations 13
GAMG:  Solving for p_rgh, Initial residual = 0.000444319, Final residual = 3.52521e-09, No Iterations 10
time step continuity errors : sum local = 0.000954079, global = -0.000482919, cumulative = -0.000537762
GAMG:  Solving for p_rgh, Initial residual = 0.00196951, Final residual = 4.24916e-09, No Iterations 13
GAMGPCG:  Solving for p_rgh, Initial residual = 0.000890865, Final residual = 4.48047e-09, No Iterations 5
time step continuity errors : sum local = 0.000954085, global = -0.000482921, cumulative = -0.00102068
total convective particle-fluid heat flux [W] = 3.80714e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 103.735
ExecutionTime = 3.89 s  ClockTime = 4 s

Courant Number mean: 0.0897478 max: 18.4464

Debugging zero!

Interface Courant Number mean: 0.0148299 max: 6.39457

Debugging one!

Time = 0.0035


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80895
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  3 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107031        0.003    80895    902771.96   -6145.8939  -0.66305894    20.973632 
  107036       0.0035    78592     10717618   -6145.8939  -0.66327361    20.974511 
Loop time of 0.167549 on 8 procs for 5 steps with 78592 atoms
Max time of 0.167549 on 8 procs for 5 steps with 78592 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.835072, Final residual = 8.29025e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.00018347, Final residual = 7.81221e-08, No Iterations 1
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.000168455, Final residual = 1.41656e-07, No Iterations 1
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.000193375, Final residual = 3.99338e-08, No Iterations 1

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.833588, Final residual = 7.51075e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.840521, Final residual = 4.33447e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.829071, Final residual = 6.46376e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.820753, Final residual = 4.8947e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.833524, Final residual = 7.82451e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.808899, Final residual = 6.47622e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.843751, Final residual = 4.5337e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.836327, Final residual = 6.52052e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.837973, Final residual = 7.96653e-05, No Iterations 8
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1564.06
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249855 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199996 m
ep: 0.437269
U : (0.00137751 -0.001416 -0.00913123) m/s
G : (0.000150498 -0.000154704 -0.000997624) kg/m2s
mG: 0.0010207 kg/m2s
Re: 0.272183
Pr: 0.045
JH: 0.259453
h : 2.50668 J/m2sK
Tw: 1473.15 K
Tf: 1482.25 K
dT: -9.10332 K
q : -22.8191 J/m2s
A : 0.00245342 m2
Q : -0.0559848 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249818 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199981 m
ep: 0.440365
U : (4.5998 136.026 -9.40316) m/s
G : (0.506029 14.9644 -1.03445) kg/m2s
mG: 15.0087 kg/m2s
Re: 4001.93
Pr: 0.045
JH: 0.0380694
h : 5408.29 J/m2sK
Tw: 1473.15 K
Tf: 1479.95 K
dT: -6.79899 K
q : -36770.9 J/m2s
A : 0.00245336 m2
Q : -90.2123 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -0.0353167
Maximum Fluid Concentration: 244.425
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.94151, Final residual = 7.50063e-05, No Iterations 13
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.945512, Final residual = 8.21013e-05, No Iterations 12
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.945659, Final residual = 8.32959e-05, No Iterations 13
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (5.73172e+08 -5.84752e+08 1.63176e+09)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.375632 -0.215322 1.45131
MULES: Solving for alpha.air
air volume fraction, min, max = 0.597135 -0.616566 1.14164
Phase-sum volume fraction, min, max = 0.972767 0.426592 1.38023
DILUPBiCGStab:  Solving for T, Initial residual = 0.817672, Final residual = 3.53345e-09, No Iterations 5
DILUPBiCGStab:  Solving for C, Initial residual = 0.0277129, Final residual = 6.13032e-09, No Iterations 9
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.49961, Final residual = 3.07318e-09, No Iterations 9
smoothSolver:  Solving for Uy, Initial residual = 0.100105, Final residual = 3.09258e-09, No Iterations 9
smoothSolver:  Solving for Uz, Initial residual = 0.186642, Final residual = 1.48835e-09, No Iterations 9
GAMG:  Solving for p_rgh, Initial residual = 0.195057, Final residual = 1.62425e-07, No Iterations 32
GAMG:  Solving for p_rgh, Initial residual = 0.00067377, Final residual = 5.35525e-09, No Iterations 10
time step continuity errors : sum local = 0.0153281, global = -0.0146018, cumulative = -0.0156225
GAMG:  Solving for p_rgh, Initial residual = 0.014119, Final residual = 1.29726e-08, No Iterations 19
GAMGPCG:  Solving for p_rgh, Initial residual = 0.00120419, Final residual = 9.05107e-09, No Iterations 6
time step continuity errors : sum local = 0.0153286, global = -0.0146025, cumulative = -0.030225
total convective particle-fluid heat flux [W] = -7.45662e+10
total convective particle-fluid mass flux [kg/s] (Eulerian) = 289.167
ExecutionTime = 4.45 s  ClockTime = 4 s

Courant Number mean: 2.71329 max: 389.262

Debugging zero!

Interface Courant Number mean: 2.35595 max: 389.262

Debugging one!

Time = 0.004


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 78592
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  3 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107036       0.0035    78592     10717618   -6145.8939  -0.66327361    20.974511 
[4] #0  [6] #0  [0] #0  Foam::error::printStack(Foam::Ostream&)Foam::error::printStack(Foam::Ostream&)Foam::error::printStack(Foam::Ostream&) at ??:?
 at ??:?
 at ??:?
[4] #1  Foam::sigFpe::sigHandler(int)[6] #1  [0] #1  Foam::sigFpe::sigHandler(int)Foam::sigFpe::sigHandler(int) at ??:?
[6] #2  ? at ??:?
[4] #2  ? at ??:?
[0] #2  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[4] #3  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[6] #3  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[0] #3  ? in "/lib/x86_64-linux-gnu/libm.so.6"
[4] #4  ? in "/lib/x86_64-linux-gnu/libm.so.6"
[6] #4  ? in "/lib/x86_64-linux-gnu/libm.so.6"
[0] #4  ? at fix_heat_gran_conduction.cpp:?
 at fix_heat_gran_conduction.cpp:?
[6] #5  LAMMPS_NS::FixHeatGranCond::post_force(int)[0] #5  LAMMPS_NS::FixHeatGranCond::post_force(int) at fix_heat_gran_conduction.cpp:?
[4] #5  LAMMPS_NS::FixHeatGranCond::post_force(int) at ??:?
 at ??:?
[6] #6  LAMMPS_NS::Modify::post_force(int)[0] #6  LAMMPS_NS::Modify::post_force(int) at ??:?
[4] #6  LAMMPS_NS::Modify::post_force(int) at ??:?
[0] #7  LAMMPS_NS::Verlet::run(int) at ??:?
 at ??:?
[4] #7  LAMMPS_NS::Verlet::run(int)[6] #7  LAMMPS_NS::Verlet::run(int) at ??:?
[4] #8  LAMMPS_NS::Run::command(int, char**) at ??:?
 at ??:?
[6] #8  LAMMPS_NS::Run::command(int, char**)[0] #8  LAMMPS_NS::Run::command(int, char**) at ??:?
[4] #9  void LAMMPS_NS::Input::command_creator<LAMMPS_NS::Run>(LAMMPS_NS::LAMMPS*, int, char**) at ??:?
 at ??:?
[0] #9[6] #9  void LAMMPS_NS::Input::command_creator<LAMMPS_NS::Run>(LAMMPS_NS::LAMMPS*, int, char**)  void LAMMPS_NS::Input::command_creator<LAMMPS_NS::Run>(LAMMPS_NS::LAMMPS*, int, char**) at ??:?
 at ??:?
[6] #10  LAMMPS_NS::Input::execute_command()[0] #10  LAMMPS_NS::Input::execute_command() at ??:?
[4] #10  LAMMPS_NS::Input::execute_command() at ??:?
 at ??:?
 at ??:?
[0] #11  LAMMPS_NS::Input::one(char const*)[4] #11  LAMMPS_NS::Input::one(char const*)[6] #11  LAMMPS_NS::Input::one(char const*) at ??:?
[6] #12  Foam::twoWayMPI::couple(int) at ??:?
[0] #12  Foam::twoWayMPI::couple(int) at ??:?
[4] #12  Foam::twoWayMPI::couple(int) at ??:?
[0] #13  Foam::cfdemCloud::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[6] #13  Foam::cfdemCloud::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[4] #13  Foam::cfdemCloud::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[6] #14  Foam::cfdemCloudEnergy::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[0] #14  Foam::cfdemCloudEnergy::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[4] #14  Foam::cfdemCloudEnergy::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[6] #15   at ??:?
[4] #15  main at ??:?
[0] #15  mainmain in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[6] #16  ? in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[4] #16  ? in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[0] #16  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[6] #17  __libc_start_main in "/lib/x86_64-linux-gnu/libc.so.6"
[0] #17  __libc_start_main in "/lib/x86_64-linux-gnu/libc.so.6"
[4] #17  __libc_start_main in "/lib/x86_64-linux-gnu/libc.so.6"
[6] #18   in "/lib/x86_64-linux-gnu/libc.so.6"
[4] #18   in "/lib/x86_64-linux-gnu/libc.so.6"
[0] #18  ??? in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[TUE035485:02455] *** Process received signal ***
[TUE035485:02455] Signal: Floating point exception (8)
[TUE035485:02455] Signal code:  (-6)
[TUE035485:02455] Failing at address: 0x3e800000997
[TUE035485:02455] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x45320)[0x7f1a3842a320]
[TUE035485:02455] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x11c)[0x7f1a38483b1c]
[TUE035485:02455] [ 2] /lib/x86_64-linux-gnu/libc.so.6(gsignal+0x1e)[0x7f1a3842a26e]
[TUE035485:02455] [ 3] /lib/x86_64-linux-gnu/libc.so.6(+0x45320)[0x7f1a3842a320]
[TUE035485:02455] [ 4] /lib/x86_64-linux-gnu/libm.so.6(+0x153a4)[0x7f1a3863c3a4]
[TUE035485:02455] [ 5] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(+0x109fe41)[0x7f1a359cfe41]
[TUE035485:02455] [ 6] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS15FixHeatGranCond10post_forceEi+0xb2)[0x7f1a359d06d2]
[TUE035485:02455] [ 7]  in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[TUE035485:02453] *** Process received signal ***
[TUE035485:02453] Signal: Floating point exception (8)
[TUE035485:02453] Signal code:  (-6)
[TUE035485:02453] Failing at address: 0x3e800000995
[TUE035485:02453] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x45320)[0x7f226036b320]
[TUE035485:02453] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x11c)[0x7f22603c4b1c]
[TUE035485:02453] [ 2] /lib/x86_64-linux-gnu/libc.so.6(gsignal+0x1e)[0x7f226036b26e]
[TUE035485:02453] [ 3] /lib/x86_64-linux-gnu/libc.so.6(+0x45320)[0x7f226036b320]
[TUE035485:02453] [ 4] /lib/x86_64-linux-gnu/libm.so.6(+0x153a4)[0x7f226057d3a4]
[TUE035485:02453] [ 5] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Modify10post_forceEi+0x57)[0x7f1a36daafc7]
[TUE035485:02455] [ 8]  in "/home/ht4/home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(+0x109fe41)[0x7f225d910e41]
[TUE035485:02453] [ 6] 5454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[TUE035485:02449] *** Process received signal ***
[TUE035485:02449] Signal: Floating point exception (8)
[TUE035485:02449] Signal code:  (-6)
[TUE035485:02449] Failing at address: 0x3e800000991
[TUE035485:02449] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x45320)[0x7f4863a55320]
[TUE035485:02449] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x11c)[0x7f4863aaeb1c]
[TUE035485:02449] [ 2] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Verlet3runEi+0x3e2)[0x7f1a36f0d1f2]
[TUE035485:02455] [ 9] /lib/x86_64-linux-gnu/libc.so.6(gsignal+0x1e)[0x7f4863a5526e]
[TUE035485:02449] [ 3] /lib/x86_64-linux-gnu/libc.so.6(+0x45320)[0x7f4863a55320]
[TUE035485:02449] [ 4] /lib/x86_64-linux-gnu/libm.so.6(+0x153a4)[0x7f4863c673a4]
[TUE035485:02449] [ 5] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS15FixHeatGranCond10post_forceEi+0xb2)[0x7f225d9116d2]
[TUE035485:02453] [ 7] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(+0x109fe41)[0x7f4860ffae41]
[TUE035485:02449] [ 6] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS3Run7commandEiPPc+0x2b0)[0x7f1a36ea8e00]
[TUE035485:02455] [10] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Modify10post_forceEi+0x57)[0x7f225ecebfc7]
[TUE035485:02453] [ 8] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS15FixHeatGranCond10post_forceEi+0xb2)[0x7f4860ffb6d2]
[TUE035485:02449] [ 7] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15command_creatorINS_3RunEEEvPNS_6LAMMPSEiPPc+0x42)[0x7f1a36d672c2]
[TUE035485:02455] [11] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Verlet3runEi+0x3e2)[0x7f225ee4e1f2]
[TUE035485:02453] [ 9] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Modify10post_forceEi+0x57)[0x7f48623d5fc7]
[TUE035485:02449] [ 8] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS3Run7commandEiPPc+0x2b0)[0x7f225ede9e00]
[TUE035485:02453] [10] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Verlet3runEi+0x3e2)[0x7f48625381f2]
[TUE035485:02449] [ 9] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15execute_commandEv+0x820)[0x7f1a36d652a0]
[TUE035485:02455] [12] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15command_creatorINS_3RunEEEvPNS_6LAMMPSEiPPc+0x42)[0x7f225eca82c2]
[TUE035485:02453] [11] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS3Run7commandEiPPc+0x2b0)[0x7f48624d3e00]
[TUE035485:02449] [10] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input3oneEPKc+0x89)[0x7f1a36d65e09]
[TUE035485:02455] [13] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15execute_commandEv+0x820)[0x7f225eca62a0]
[TUE035485:02453] [12] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam9twoWayMPI6coupleEi+0x8d3)[0x7f1a39749b83]
[TUE035485:02455] [14] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam10cfdemCloud6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x7d5)[0x7f1a3943e225]
[TUE035485:02455] [15] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam16cfdemCloudEnergy6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x2a)[0x7f1a394a0bea]
[TUE035485:02455] [16] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15command_creatorINS_3RunEEEvPNS_6LAMMPSEiPPc+0x42)[0x7f48623922c2]
[TUE035485:02449] [11] cfdemSolverMultiphaseScalar(main+0x4d2f)[0x55690b21aeef]
[TUE035485:02455] [17] /lib/x86_64-linux-gnu/libc.so.6(+0x2a1ca)[0x7f1a3840f1ca]
[TUE035485:02455] [18] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x8b)[0x7f1a3840f28b]
[TUE035485:02455] [19] cfdemSolverMultiphaseScalar(+0x41875)[0x55690b221875]
[TUE035485:02455] *** End of error message ***
/home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input3oneEPKc+0x89)[0x7f225eca6e09]
[TUE035485:02453] [13] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam9twoWayMPI6coupleEi+0x8d3)[0x7f226168ab83]
[TUE035485:02453] [14] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam10cfdemCloud6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x7d5)[0x7f226137f225]
[TUE035485:02453] [15] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam16cfdemCloudEnergy6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x2a)[0x7f22613e1bea]
[TUE035485:02453] [16] cfdemSolverMultiphaseScalar(main+0x4d2f)[0x5632486a7eef]
[TUE035485:02453] [17] /lib/x86_64-linux-gnu/libc.so.6(+0x2a1ca)[0x7f22603501ca]
[TUE035485:02453] [18] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x8b)[0x7f226035028b]
[TUE035485:02453] [19] cfdemSolverMultiphaseScalar(+0x41875)[0x5632486ae875]
[TUE035485:02453] *** End of error message ***
/home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15execute_commandEv+0x820)[0x7f48623902a0]
[TUE035485:02449] [12] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input3oneEPKc+0x89)[0x7f4862390e09]
[TUE035485:02449] [13] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam9twoWayMPI6coupleEi+0x8d3)[0x7f4864d74b83]
[TUE035485:02449] [14] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam10cfdemCloud6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x7d5)[0x7f4864a69225]
[TUE035485:02449] [15] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam16cfdemCloudEnergy6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x2a)[0x7f4864acbbea]
[TUE035485:02449] [16] cfdemSolverMultiphaseScalar(main+0x4d2f)[0x564d5f8d3eef]
[TUE035485:02449] [17] /lib/x86_64-linux-gnu/libc.so.6(+0x2a1ca)[0x7f4863a3a1ca]
[TUE035485:02449] [18] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x8b)[0x7f4863a3a28b]
[TUE035485:02449] [19] cfdemSolverMultiphaseScalar(+0x41875)[0x564d5f8da875]
[TUE035485:02449] *** End of error message ***
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun noticed that process rank 0 with PID 0 on node TUE035485 exited on signal 8 (Floating point exception).
--------------------------------------------------------------------------

//   small_hearth   //

/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD

/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  4.x                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 4.x-d214c8dfd5ba
Exec   : cfdemSolverMultiphaseScalar -parallel
Date   : Feb 27 2025
Time   : 10:21:10
Host   : "TUE035485"
PID    : 1612
Case   : /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/tutorials/cfdemSolverMultiphaseScalar/small_hearth/CFD
nProcs : 8
Slaves : 
7
(
"TUE035485.1613"
"TUE035485.1614"
"TUE035485.1615"
"TUE035485.1616"
"TUE035485.1617"
"TUE035485.1618"
"TUE035485.1619"
)

Pstream initialized with:
    floatTransfer      : 0
    nProcsSimpleSum    : 0
    commsType          : nonBlocking
    polling iterations : 0
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0


PIMPLE: Operating solver in PISO mode


Reading momentum exchange field Ksl


Reading voidfraction field voidfraction = (Vgas/Vparticle)

Reading particle velocity field Us

Reading field p_rgh

Reading field U

Reading/calculating face flux field phi

Selecting incompressible transport model Newtonian
Selecting incompressible transport model Newtonian
Reading/creating thermal fields

Reading/creating concentration fields

Selecting turbulence model type laminar

Reading g

Reading hRef
Calculating field g.h

No finite volume options present

GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
GAMGPCG:  Solving for pcorr, Initial residual = 0, Final residual = 0, No Iterations 0
time step continuity errors : sum local = 0, global = 0, cumulative = 0
Courant Number mean: 0 max: 0
Selecting dataExchangeModel twoWayMPI
Starting up LIGGGHTS for first time execution
Executing input script '../DEM/in.liggghts_run'
LIGGGHTS (Version LIGGGHTS-PFM 24.01, compiled 2025-01-17-18:01:04 by ht45454, git commit d075b97762ce4302707903718dda170920e630bd, based on LAMMPS 23 Nov 2013)
log             ../log/log.liggghts_run
thermo_log      ../log/thermo.txt

atom_style      granular
atom_modify     map array
boundary        f f f
newton          off

communicate     single vel yes

units           si
processors      2 2 2

# read the restart file
read_restart    ../DEM/post/restart/liggghts.restartSequence
Reading restart file ...
  orthogonal box = (-0.5 -0.5 -0.0025) to (0.5 0.5 1)
  2 by 2 by 2 MPI processor grid
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
  80888 atoms

neighbor        0.007 bin
neigh_modify    delay 0

# contact model
include         ../DEM/in.contact_settings
# Material properties required for granular pair styles
fix             m1 all property/global youngsModulus	                peratomtype       5.e6
fix             m2 all property/global poissonsRatio 	                peratomtype	  0.3
fix             m3 all property/global coefficientRestitution           peratomtypepair 1 0.3
fix             m4 all property/global coefficientFriction 	        peratomtypepair 1 0.5
fix             m5 all property/global coefficientRollingFriction       peratomtypepair 1 0.2
fix             m6 all property/global coefficientRollingViscousDamping peratomtypepair 1 0.3

# pair style
pair_style	gran model hertz tangential history rolling_friction epsd
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
pair_coeff  	* *

# hearth settings
include         ../DEM/in.hearth_settings
# hearth settings
variable        hearthRadius  equal 0.5     # hearth radius (m)
variable        coreRadius    equal 0.15    # radius of core region (m)
variable        liquidLevel   equal 0.4     # initial liquid level (m) [set in setFieldsDict as well!]
variable        liquidDensity equal 6700.   # liquid density (kg/m3)

# heat/mass transfer settings
variable        particlekInit equal 5000    # particle thermal conductivity during init (W/Km)
variable        particlekRun  equal 40.0    # particle thermal conductivity during run  (W/Km) [sped up! 2.0*20!]
variable        particleCp    equal 870     # particle heat capacity (J/kgK)
variable        Tinlet        equal 1823.15 # particle inlet temperature (K) [set in CFD as well!]
variable        Tinit         equal 1623.15 # initial temperature (K) [set in CFD as well!]
variable        Twall         equal 1423.15 # wall temperature (K) [set in CFD as well!]
variable        rRemove       equal 0.001   # radius at which dissolved particles are removed (m)

# zone definitions
variable        forceZmin     equal 0.70    # lower boundary of force zone (m)
variable        forceZmax     equal 0.80    # upper boundary of force zone (m)
variable        insZmin       equal 0.70    # lower boundary of insertion zone (m)
variable        insZmax       equal 0.80    # upper boundary of insertion zone (m)

region          bedReg        cylinder z 0 0 ${hearthRadius} 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            ${insZmax}
region          bedReg        cylinder z 0 0 0.5 0            0.8
region          coreReg       cylinder z 0 0 ${coreRadius}   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            ${insZmax} side in
region          coreReg       cylinder z 0 0 0.15   0            0.8 side in
region          invCoreReg    cylinder z 0 0 ${coreRadius}   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            ${insZmax} side out
region          invCoreReg    cylinder z 0 0 0.15   0            0.8 side out
region          shellReg      intersect 2 bedReg invCoreReg

region		insReg        cylinder z 0 0 ${hearthRadius} ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 ${insZmin}   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   ${insZmax}
region		insReg        cylinder z 0 0 0.5 0.7   0.8
region          insCoreReg    intersect 2 insReg coreReg
region          insShellReg   intersect 2 insReg invCoreReg

region		forceReg      cylinder z 0 0 ${hearthRadius} ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 ${forceZmin} ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 ${forceZmax}
region		forceReg      cylinder z 0 0 0.5 0.7 0.8
region          freeboard     cylinder z 0 0 ${hearthRadius} ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 ${insZmax} INF
region          freeboard     cylinder z 0 0 0.5 0.8 INF

region          mushroom      block 0.4 0.5 -0.05 0.05 0.2 0.3 side out # mushroom cutout
region          initReg       intersect 2 bedReg mushroom # entire bed minus mushroom
region          initCoreReg   intersect 2 initReg coreReg
region          initShellReg  intersect 2 initReg invCoreReg

# total burden weight
variable        pressureMin   equal 2000    # lower pressure value (Pa), near wall
variable        pressureMax   equal 20000   # upper pressure value (Pa), near core

# kinetic energy
variable        kinEn         equal ke      # kinetic energy (J)
variable        kinEnMax      equal 2.      # kinetic energy threshold for init (J)

# coke removal settings
variable        cokeRateInit  equal 20.     # coke combustion rate during init (kg/s)
variable        cokeRateRun   equal 1.      # coke combustion rate during run (kg/s)
variable        delInt        equal 0.1     # removal interval (s) [set in liggghtsCommands as well!]

variable        nFreeboard    equal count(all,freeboard)

variable        nRaceways     equal count(all,raceways)
variable        mRaceways     equal mass(all,raceways)
variable        avMass        equal "v_mRaceways/(v_nRaceways+1e-3)"

variable        delIntSteps   equal "floor(v_delInt/dt)"

variable        nDelInit      equal "v_delIntSteps*dt*v_cokeRateInit/v_avMass"
variable        fDelInit      equal "v_nDelInit/(v_nRaceways+1e-3)"

variable        nDelRun       equal "v_delIntSteps*dt*v_cokeRateRun/(v_avMass+1e-3)"
variable        fDelRun       equal "v_nDelRun/(v_nRaceways+1e-3)"




# timestep
timestep        1e-4

# cfd coupling
fix             cfd all couple/cfd couple_every 100 mpi
nevery as specified in LIGGGHTS is overriden by calling external program (/home/ht45454/CFDEM/LIGGGHTS/src/cfd_datacoupling_mpi.cpp:56)
fix             cfd2 all couple/cfd/force/implicit

# heat transfer
fix             m7 all property/global thermalConductivity peratomtype ${particlekRun} # lambda in [W/(K*m)]
fix             m7 all property/global thermalConductivity peratomtype 40 
fix             m8 all property/global thermalCapacity     peratomtype ${particleCp}   # cp in [J/(kg*K)]
fix             m8 all property/global thermalCapacity     peratomtype 870   
fix             heattransfer all heat/gran/conduction initial_temperature ${Tinlet}
fix             heattransfer all heat/gran/conduction initial_temperature 1823.15
Resetting global state of Fix Temp Style property/atom from restart file info
Resetting per-atom state of Fix Temp Style property/atom from restart file info
Resetting global state of Fix heatFlux Style property/atom from restart file info
Resetting per-atom state of Fix heatFlux Style property/atom from restart file info
Resetting global state of Fix heatSource Style property/atom from restart file info
Resetting per-atom state of Fix heatSource Style property/atom from restart file info
fix             cfd3 all couple/cfd/convection T0 ${Tinlet}
fix             cfd3 all couple/cfd/convection T0 1823.15

# mass transfer
fix             cfd4 all couple/cfd/dissolve rmin ${rRemove}
fix             cfd4 all couple/cfd/dissolve rmin 0.001

# walls
include         ../DEM/in.wall_settings
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature ${Twall} curvature 1e-5
fix		sides     all mesh/surface file ../DEM/mesh/small_hearth_sides.stl       type 1 temperature 1423.15 curvature 1e-5
Resetting global state of Fix sides Style mesh/surface from restart file info
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature ${Twall}
fix 		bottom    all mesh/surface file ../DEM/mesh/small_hearth_bottom.stl      type 1 temperature 1423.15
Resetting global state of Fix bottom Style mesh/surface from restart file info
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature ${Twall}
fix		granwalls all wall/gran model hertz tangential history rolling_friction epsd mesh n_meshes 2 meshes sides bottom temperature 1423.15
SURFACE/DEFAULT loaded
HERTZ loaded
TANGENTIAL/HISTORY loaded
EPSD loaded
Resetting global state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_sides Style property/atom from restart file info
Resetting global state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_sides Style contacthistory/mesh from restart file info
Resetting global state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting per-atom state of Fix n_neighs_mesh_bottom Style property/atom from restart file info
Resetting global state of Fix tracker_bottom Style contacthistory/mesh from restart file info
Resetting per-atom state of Fix tracker_bottom Style contacthistory/mesh from restart file info

# gravity
fix		gravi all gravity 9.81 vector 0.0 0.0 -1.0

######################################

# particle distribution
include	   	../DEM/in.particleSizeDistribution1
# Particle size distribution for LIGGGHTS

# mean radius = 0.0100000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts1 all particletemplate/sphere 10007 atom_type 1 density constant 900 radius constant 0.01
Resetting global state of Fix pts1 Style particletemplate/sphere from restart file info

fix	pdd1 all particledistribution/discrete 10009 1 pts1 1.000000
Fix particledistribution/discrete (id pdd1): distribution based on mass%:
    pts1: d=2.000000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd1): distribution based on number%:
    pts1: d=2.000000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd1 Style particledistribution/discrete from restart file info
include	   	../DEM/in.particleSizeDistribution2
# Particle size distribution for LIGGGHTS

# mean radius = 0.0125000 m
# standard deviation = 0.00000 m
# density = 900 kg/m3

fix	pts2 all particletemplate/sphere 10037 atom_type 1 density constant 900 radius constant 0.0125
Resetting global state of Fix pts2 Style particletemplate/sphere from restart file info

fix	pdd2 all particledistribution/discrete 10039 1 pts2 1.000000
Fix particledistribution/discrete (id pdd2): distribution based on mass%:
    pts2: d=2.500000e-02 (max. bounding sphere) mass%=100.000000%
Fix particledistribution/discrete (id pdd2): distribution based on number%:
    pts2: d=2.500000e-02 (max. bounding sphere) number%=100.000000%
Resetting global state of Fix pdd2 Style particledistribution/discrete from restart file info

# raceways
include		../DEM/in.raceways
# Raceway definition for LIGGGHTS

# reactor radius = 0.500000 m
# raceway height = 0.500000 m
# raceway diameter = 0.100000 m
# raceway length = 0.100000 m
# number of raceways = 8

variable angle1 equal 0.000000
region raceway1 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle1 0 0 0 0 0 1
variable angle2 equal 0.785398
region raceway2 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle2 0 0 0 0 0 1
variable angle3 equal 1.570796
region raceway3 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle3 0 0 0 0 0 1
variable angle4 equal 2.356194
region raceway4 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle4 0 0 0 0 0 1
variable angle5 equal 3.141593
region raceway5 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle5 0 0 0 0 0 1
variable angle6 equal 3.926991
region raceway6 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle6 0 0 0 0 0 1
variable angle7 equal 4.712389
region raceway7 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle7 0 0 0 0 0 1
variable angle8 equal 5.497787
region raceway8 cylinder x 0.000000 0.500000 0.050000 0.400000 0.500000 rotate v_angle8 0 0 0 0 0 1

region raceways union 8 raceway1 raceway2 raceway3 raceway4 raceway5 raceway6 raceway7 raceway8

# burden weight
include         ../DEM/in.pressure_profile
# Pressure profile definition for LIGGGHTS

# reactor radius = 0.500000 m
# R1 = 0.150000 m
# R2 = 0.400000 m
# number of bins = 12

# Region01
region   forceReg01		 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side in  	# center region
region   forceReg01		 cylinder z 0 0 0.15	0.7 ${forceZmax} side in  	
region   forceReg01		 cylinder z 0 0 0.15	0.7 0.8 side in  	
variable nForceReg01	 equal count(all,forceReg01) 								# number of particles inside
variable forceRegArea01	 equal 0.070686												# ring area (m2)
variable forceFact01	 equal 1												# force factor [0-1] (-)
variable totalForce01	 equal "-(v_forceFact01*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea01"	# total force (N)
variable forcePerPart01	 equal "v_totalForce01/(v_nForceReg01+1e-3)"				# force per particle (N)
fix      force01		 all addforce 0 0 v_forcePerPart01 region forceReg01		# apply force

# Region02
region   forceRegIn02	 cylinder z 0 0 0.15	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 ${forceZmax} side out 	
region   forceRegIn02	 cylinder z 0 0 0.15	0.7 0.8 side out 	
region   forceRegOut02	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side in  	
region   forceRegOut02	 cylinder z 0 0 0.17083	0.7 0.8 side in  	
region   forceReg02		 intersect 2 forceRegIn02 forceRegOut02						# annular region
variable nForceReg02	 equal count(all,forceReg02) 								# number of particles inside
variable forceRegArea02	 equal 0.020998												# ring area (m2)
variable forceFact02	 equal 0.95833												# force factor [0-1] (-)
variable totalForce02	 equal "-(v_forceFact02*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea02"	# total force (N)
variable forcePerPart02	 equal "v_totalForce02/(v_nForceReg02+1e-3)"				# force per particle (N)
fix      force02		 all addforce 0 0 v_forcePerPart02 region forceReg02		# apply force

# Region03
region   forceRegIn03	 cylinder z 0 0 0.17083	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 ${forceZmax} side out 	
region   forceRegIn03	 cylinder z 0 0 0.17083	0.7 0.8 side out 	
region   forceRegOut03	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side in  	
region   forceRegOut03	 cylinder z 0 0 0.19167	0.7 0.8 side in  	
region   forceReg03		 intersect 2 forceRegIn03 forceRegOut03						# annular region
variable nForceReg03	 equal count(all,forceReg03) 								# number of particles inside
variable forceRegArea03	 equal 0.023726												# ring area (m2)
variable forceFact03	 equal 0.875												# force factor [0-1] (-)
variable totalForce03	 equal "-(v_forceFact03*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea03"	# total force (N)
variable forcePerPart03	 equal "v_totalForce03/(v_nForceReg03+1e-3)"				# force per particle (N)
fix      force03		 all addforce 0 0 v_forcePerPart03 region forceReg03		# apply force

# Region04
region   forceRegIn04	 cylinder z 0 0 0.19167	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 ${forceZmax} side out 	
region   forceRegIn04	 cylinder z 0 0 0.19167	0.7 0.8 side out 	
region   forceRegOut04	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side in  	
region   forceRegOut04	 cylinder z 0 0 0.2125	0.7 0.8 side in  	
region   forceReg04		 intersect 2 forceRegIn04 forceRegOut04						# annular region
variable nForceReg04	 equal count(all,forceReg04) 								# number of particles inside
variable forceRegArea04	 equal 0.026453												# ring area (m2)
variable forceFact04	 equal 0.79167												# force factor [0-1] (-)
variable totalForce04	 equal "-(v_forceFact04*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea04"	# total force (N)
variable forcePerPart04	 equal "v_totalForce04/(v_nForceReg04+1e-3)"				# force per particle (N)
fix      force04		 all addforce 0 0 v_forcePerPart04 region forceReg04		# apply force

# Region05
region   forceRegIn05	 cylinder z 0 0 0.2125	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 ${forceZmax} side out 	
region   forceRegIn05	 cylinder z 0 0 0.2125	0.7 0.8 side out 	
region   forceRegOut05	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side in  	
region   forceRegOut05	 cylinder z 0 0 0.23333	0.7 0.8 side in  	
region   forceReg05		 intersect 2 forceRegIn05 forceRegOut05						# annular region
variable nForceReg05	 equal count(all,forceReg05) 								# number of particles inside
variable forceRegArea05	 equal 0.02918												# ring area (m2)
variable forceFact05	 equal 0.70833												# force factor [0-1] (-)
variable totalForce05	 equal "-(v_forceFact05*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea05"	# total force (N)
variable forcePerPart05	 equal "v_totalForce05/(v_nForceReg05+1e-3)"				# force per particle (N)
fix      force05		 all addforce 0 0 v_forcePerPart05 region forceReg05		# apply force

# Region06
region   forceRegIn06	 cylinder z 0 0 0.23333	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 ${forceZmax} side out 	
region   forceRegIn06	 cylinder z 0 0 0.23333	0.7 0.8 side out 	
region   forceRegOut06	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side in  	
region   forceRegOut06	 cylinder z 0 0 0.25417	0.7 0.8 side in  	
region   forceReg06		 intersect 2 forceRegIn06 forceRegOut06						# annular region
variable nForceReg06	 equal count(all,forceReg06) 								# number of particles inside
variable forceRegArea06	 equal 0.031907												# ring area (m2)
variable forceFact06	 equal 0.625												# force factor [0-1] (-)
variable totalForce06	 equal "-(v_forceFact06*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea06"	# total force (N)
variable forcePerPart06	 equal "v_totalForce06/(v_nForceReg06+1e-3)"				# force per particle (N)
fix      force06		 all addforce 0 0 v_forcePerPart06 region forceReg06		# apply force

# Region07
region   forceRegIn07	 cylinder z 0 0 0.25417	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 ${forceZmax} side out 	
region   forceRegIn07	 cylinder z 0 0 0.25417	0.7 0.8 side out 	
region   forceRegOut07	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 ${forceZmax} side in  	
region   forceRegOut07	 cylinder z 0 0 0.275	0.7 0.8 side in  	
region   forceReg07		 intersect 2 forceRegIn07 forceRegOut07						# annular region
variable nForceReg07	 equal count(all,forceReg07) 								# number of particles inside
variable forceRegArea07	 equal 0.034634												# ring area (m2)
variable forceFact07	 equal 0.54167												# force factor [0-1] (-)
variable totalForce07	 equal "-(v_forceFact07*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea07"	# total force (N)
variable forcePerPart07	 equal "v_totalForce07/(v_nForceReg07+1e-3)"				# force per particle (N)
fix      force07		 all addforce 0 0 v_forcePerPart07 region forceReg07		# apply force

# Region08
region   forceRegIn08	 cylinder z 0 0 0.275	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 ${forceZmax} side out 	
region   forceRegIn08	 cylinder z 0 0 0.275	0.7 0.8 side out 	
region   forceRegOut08	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side in  	
region   forceRegOut08	 cylinder z 0 0 0.29583	0.7 0.8 side in  	
region   forceReg08		 intersect 2 forceRegIn08 forceRegOut08						# annular region
variable nForceReg08	 equal count(all,forceReg08) 								# number of particles inside
variable forceRegArea08	 equal 0.037361												# ring area (m2)
variable forceFact08	 equal 0.45833												# force factor [0-1] (-)
variable totalForce08	 equal "-(v_forceFact08*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea08"	# total force (N)
variable forcePerPart08	 equal "v_totalForce08/(v_nForceReg08+1e-3)"				# force per particle (N)
fix      force08		 all addforce 0 0 v_forcePerPart08 region forceReg08		# apply force

# Region09
region   forceRegIn09	 cylinder z 0 0 0.29583	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 ${forceZmax} side out 	
region   forceRegIn09	 cylinder z 0 0 0.29583	0.7 0.8 side out 	
region   forceRegOut09	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side in  	
region   forceRegOut09	 cylinder z 0 0 0.31667	0.7 0.8 side in  	
region   forceReg09		 intersect 2 forceRegIn09 forceRegOut09						# annular region
variable nForceReg09	 equal count(all,forceReg09) 								# number of particles inside
variable forceRegArea09	 equal 0.040088												# ring area (m2)
variable forceFact09	 equal 0.375												# force factor [0-1] (-)
variable totalForce09	 equal "-(v_forceFact09*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea09"	# total force (N)
variable forcePerPart09	 equal "v_totalForce09/(v_nForceReg09+1e-3)"				# force per particle (N)
fix      force09		 all addforce 0 0 v_forcePerPart09 region forceReg09		# apply force

# Region10
region   forceRegIn10	 cylinder z 0 0 0.31667	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 ${forceZmax} side out 	
region   forceRegIn10	 cylinder z 0 0 0.31667	0.7 0.8 side out 	
region   forceRegOut10	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side in  	
region   forceRegOut10	 cylinder z 0 0 0.3375	0.7 0.8 side in  	
region   forceReg10		 intersect 2 forceRegIn10 forceRegOut10						# annular region
variable nForceReg10	 equal count(all,forceReg10) 								# number of particles inside
variable forceRegArea10	 equal 0.042815												# ring area (m2)
variable forceFact10	 equal 0.29167												# force factor [0-1] (-)
variable totalForce10	 equal "-(v_forceFact10*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea10"	# total force (N)
variable forcePerPart10	 equal "v_totalForce10/(v_nForceReg10+1e-3)"				# force per particle (N)
fix      force10		 all addforce 0 0 v_forcePerPart10 region forceReg10		# apply force

# Region11
region   forceRegIn11	 cylinder z 0 0 0.3375	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 ${forceZmax} side out 	
region   forceRegIn11	 cylinder z 0 0 0.3375	0.7 0.8 side out 	
region   forceRegOut11	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side in  	
region   forceRegOut11	 cylinder z 0 0 0.35833	0.7 0.8 side in  	
region   forceReg11		 intersect 2 forceRegIn11 forceRegOut11						# annular region
variable nForceReg11	 equal count(all,forceReg11) 								# number of particles inside
variable forceRegArea11	 equal 0.045542												# ring area (m2)
variable forceFact11	 equal 0.20833												# force factor [0-1] (-)
variable totalForce11	 equal "-(v_forceFact11*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea11"	# total force (N)
variable forcePerPart11	 equal "v_totalForce11/(v_nForceReg11+1e-3)"				# force per particle (N)
fix      force11		 all addforce 0 0 v_forcePerPart11 region forceReg11		# apply force

# Region12
region   forceRegIn12	 cylinder z 0 0 0.35833	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 ${forceZmax} side out 	
region   forceRegIn12	 cylinder z 0 0 0.35833	0.7 0.8 side out 	
region   forceRegOut12	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side in  	
region   forceRegOut12	 cylinder z 0 0 0.37917	0.7 0.8 side in  	
region   forceReg12		 intersect 2 forceRegIn12 forceRegOut12						# annular region
variable nForceReg12	 equal count(all,forceReg12) 								# number of particles inside
variable forceRegArea12	 equal 0.048269												# ring area (m2)
variable forceFact12	 equal 0.125												# force factor [0-1] (-)
variable totalForce12	 equal "-(v_forceFact12*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea12"	# total force (N)
variable forcePerPart12	 equal "v_totalForce12/(v_nForceReg12+1e-3)"				# force per particle (N)
fix      force12		 all addforce 0 0 v_forcePerPart12 region forceReg12		# apply force

# Region13
region   forceRegIn13	 cylinder z 0 0 0.37917	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 ${forceZmax} side out 	
region   forceRegIn13	 cylinder z 0 0 0.37917	0.7 0.8 side out 	
region   forceRegOut13	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 ${forceZmax} side in  	
region   forceRegOut13	 cylinder z 0 0 0.4	0.7 0.8 side in  	
region   forceReg13		 intersect 2 forceRegIn13 forceRegOut13						# annular region
variable nForceReg13	 equal count(all,forceReg13) 								# number of particles inside
variable forceRegArea13	 equal 0.050996												# ring area (m2)
variable forceFact13	 equal 0.041667												# force factor [0-1] (-)
variable totalForce13	 equal "-(v_forceFact13*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea13"	# total force (N)
variable forcePerPart13	 equal "v_totalForce13/(v_nForceReg13+1e-3)"				# force per particle (N)
fix      force13		 all addforce 0 0 v_forcePerPart13 region forceReg13		# apply force

# Region14
region   forceRegIn14	 cylinder z 0 0 0.4	${forceZmin} ${forceZmax} side out 	# inner region
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 ${forceZmax} side out 	
region   forceRegIn14	 cylinder z 0 0 0.4	0.7 0.8 side out 	
region   forceRegOut14	 cylinder z 0 0 0.5	${forceZmin} ${forceZmax} side in  	# outer region
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 ${forceZmax} side in  	
region   forceRegOut14	 cylinder z 0 0 0.5	0.7 0.8 side in  	
region   forceReg14		 intersect 2 forceRegIn14 forceRegOut14						# annular region
variable nForceReg14	 equal count(all,forceReg14) 								# number of particles inside
variable forceRegArea14	 equal 0.28274												# ring area (m2)
variable forceFact14	 equal 0												# force factor [0-1] (-)
variable totalForce14	 equal "-(v_forceFact14*(v_pressureMax-v_pressureMin)+v_pressureMin)*v_forceRegArea14"	# total force (N)
variable forcePerPart14	 equal "v_totalForce14/(v_nForceReg14+1e-3)"				# force per particle (N)
fix      force14		 all addforce 0 0 v_forcePerPart14 region forceReg14		# apply force

variable totalForce		 equal "v_forcePerPart01*v_nForceReg01+v_forcePerPart02*v_nForceReg02+v_forcePerPart03*v_nForceReg03+v_forcePerPart04*v_nForceReg04+v_forcePerPart05*v_nForceReg05+v_forcePerPart06*v_nForceReg06+v_forcePerPart07*v_nForceReg07+v_forcePerPart08*v_nForceReg08+v_forcePerPart09*v_nForceReg09+v_forcePerPart10*v_nForceReg10+v_forcePerPart11*v_nForceReg11+v_forcePerPart12*v_nForceReg12+v_forcePerPart13*v_nForceReg13+v_forcePerPart14*v_nForceReg14" 	# sum of all forces (N)
variable nForceReg		 equal "v_nForceReg01+v_nForceReg02+v_nForceReg03+v_nForceReg04+v_nForceReg05+v_nForceReg06+v_nForceReg07+v_nForceReg08+v_nForceReg09+v_nForceReg10+v_nForceReg11+v_nForceReg12+v_nForceReg13+v_nForceReg14" 	# sum of all numbers of particles (N)
variable avForcePerPart	 equal "v_totalForce/(v_nForceReg+1e-3)"	# average force per particle (N)

# insert in insertion volume
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every ${delIntSteps} overlapcheck yes region insShellReg volumefraction_region 0.7
fix         	ins3 all insert/pack seed 32452843 distributiontemplate pdd1 all_in yes insert_every 1000 overlapcheck yes region insShellReg volumefraction_region 0.7
INFO: Resetting random generator for region insShellReg
Resetting global state of Fix ins3 Style insert/pack from restart file info
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every ${delIntSteps} overlapcheck yes region insCoreReg  volumefraction_region 0.7
fix         	ins4 all insert/pack seed 32452843 distributiontemplate pdd2 all_in yes insert_every 1000 overlapcheck yes region insCoreReg  volumefraction_region 0.7
INFO: Resetting random generator for region insCoreReg
Resetting global state of Fix ins4 Style insert/pack from restart file info

######################################

# apply nve integration to all particles
fix             integr all nve/sphere

# output settings
thermo_style    custom step time atoms ke v_totalForce v_avForcePerPart v_nDelRun
thermo          10

# dump settings
dump            dmp all custom 5000 ../DEM/post/dump*.liggghts_run id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius density f_Temp[0] f_convectiveHeatFlux[0] f_convectiveMassFlux[0]
#5000
run             0
Resetting global state of Fix contacthistory Style contacthistory from restart file info
Resetting per-atom state of Fix contacthistory Style contacthistory from restart file info
Setting up run ...
Import and parallelization of mesh sides containing 2592 triangle(s) successful
Import and parallelization of mesh bottom containing 1024 triangle(s) successful
INFO: Resetting random generator for region insShellReg
INFO: Particle insertion ins3: inserting every 1000 steps
INFO: Resetting random generator for region insCoreReg
INFO: Particle insertion ins4: inserting every 1000 steps
Memory usage per processor = 24.93 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107001            0    80888  0.084448594   -6145.8938   -0.6678141          100 
Loop time of 4.537e-06 on 8 procs for 0 steps with 80888 atoms
Max time of 5.324e-06 on 8 procs for 0 steps with 80888 atoms

Pair  time (%) = 0 (0)
Max Pair time (ib) = 0 (0)
Neigh time (%) = 0 (0)
Max Neigh time (ib) = 0 (0)
Comm  time (%) = 0 (0)
Max Comm time (ib) = 0 (0)
Outpt time (%) = 0 (0)
Max Outpt time (ib) = 0 (0)
Other time (%) = 4.537e-06 (100)
Max Other time (ib) = 5.324e-06 (17.3463)

Nlocal:    10111 ave 12700 max 7448 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:    2253.75 ave 2657 max 1844 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:    57335.1 ave 71932 max 42273 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 458681
Ave neighs/atom = 5.67057
Neighbor list builds = 0
Dangerous builds = 0

Selecting locateModel engine
Selecting IOModel basicIO
Selecting probeModel off
Selecting voidFractionModel divided
Selecting averagingModel dense
Selecting clockModel standardClock
start clock measurement at t >0.0005
Selecting smoothingModel constDiffSmoothing
Selecting meshMotionModel noMeshMotion

CFDEMcoupling version: 24.01
compatible to LIGGGHTS version: 24.01
compatible to OpenFOAM version: 4.x

You are currently using:
OpenFOAM version: 4.x
OpenFOAM build: 4.x-d214c8dfd5ba
CFDEM build: 

If BC are important, please provide volScalarFields -imp/expParticleForces-
Selecting momCoupleModel implicitCouple

implicit momentum exchange field calculate if alphaP larger than : 1
Selecting forceModel BeetstraDrag
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for implForceDEM ...
	implForceDEM = true
  looking for verbose ...
	verbose = false
  looking for interpolation ...
	interpolation = true
  looking for scalarViscosity ...
	scalarViscosity = false

--> FOAM Warning : Please make sure you use the new nomenclature for verbose force model settings, please have a look at the forceSubModel doc.
Selecting forceModel MeiLift
Lift model: including shear-induced term.
Lift model: including spin-induced term.
Make sure to use a rolling friction model in LIGGGHTS!
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for verbose ...
	verbose = false
  looking for interpolation ...
	interpolation = true
  looking for scalarViscosity ...
	scalarViscosity = false

--> FOAM Warning : Please make sure you use the new nomenclature for verbose force model settings, please have a look at the forceSubModel doc.
Selecting forceModel virtualMassForce
Selecting smoothingModel constDiffAndTemporalSmoothing
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for interpolation ...
	interpolation = true

Virtual mass model: using averaged Us 
WARNING: ignoring virtual mass of relative particle motion/collisions 
Virtual mass model: using Cadd correlation by Felderhof 
WARNING: ignoring user-set Cadd 
Selecting forceModel ParmarBassetForce
Selecting smoothingModel constDiffAndTemporalSmoothing
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for verbose ...
	verbose = false
  looking for interpolation ...
	interpolation = true

Selecting forceModel viscForce
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for treatForceDEM ...
	treatForceDEM = false
  looking for interpolation ...
	interpolation = false
  looking for scalarViscosity ...
	scalarViscosity = false

Using treatForceDEM true!
Selecting forceModel gradPForceSmooth
Selecting smoothingModel temporalSmoothing
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false
  looking for treatForceDEM ...
	treatForceDEM = false
  looking for interpolation ...
	interpolation = false

Using treatForceDEM true!
Selecting forceModel surfaceTensionForce
nrForceSubModels()=1
Selecting forceSubModel ImEx

reading switches for forceSubModel:ImEx
  looking for treatForceExplicit ...
	treatForceExplicit = false

check if interpolation really works - use directly interpolationCellPoint<vector> ???
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand delete_atoms porosity raceways ${fDelRun} 123457 compress no 
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand write_restart ../DEM/post/restart/liggghts.restartSequence
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand delete_atoms region freeboard compress no 
Selecting liggghtsCommandModel execute, provide dicts, numbered from 0 to n
liggghtsCommand set region raceways property/atom Temp ${Tinlet}
Selecting liggghtsCommandModel runLiggghts, provide dicts, numbered from 0 to n
Selecting liggghtsCommandModel writeLiggghts, provide dicts, numbered from 0 to n
writeLiggghts: A restart file writeName_write_restart ../DEM/post/restart/liggghts.restartCFDEM is written.
cg is set to: 1
Selecting thermCondModel SyamlalThermCond
Selecting diffCoeffModel SyamlalDiffCoeff
Selecting energyModel heatTransferGunn
Particle temperature field activated.
Selecting energyModel wallHeatTransferYagi
Selecting massTransferModel massTransferGunn
Selecting chemistryModel off
solving volume averaged Navier Stokes equations of type A
check if Archimedes lift is necessary (depends on pressure formulation)


Starting time loop


Debugging........

Courant Number mean: 0 max: 0

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.0005


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms porosity raceways ${fDelRun} 123457 compress no '
delete_atoms porosity raceways ${fDelRun} 123457 compress no 
delete_atoms porosity raceways 100000 123457 compress no 
Deleted 0 atoms, new total = 80888
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80888
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  0 settings made for property/atom
Executing command: 'run 5    '
run 5    
Setting up run ...
Memory usage per processor = 24.9304 Mbytes
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107001            0    80888  0.084448594   -6145.8938   -0.6678141          100 
insertion: proc 1 at 0 %
insertion: proc 3 at 0 %
insertion: proc 5 at 0 %
insertion: proc 7 at 0 %
INFO: Particle insertion ins3: inserted 63 particle templates (mass 0.237504) at step 107002
 - a total of 6239 particle templates (mass 23.520476) inserted so far.
WARNING: Particle insertion: Less insertions than requested (/home/ht45454/CFDEM/LIGGGHTS/src/fix_insert.cpp:814)
insertion: proc 7 at 0 %
insertion: proc 3 at 0 %
insertion: proc 5 at 0 %
insertion: proc 1 at 0 %
INFO: Particle insertion ins4: inserted 1 particle templates (mass 0.007363) at step 107002
 - a total of 289 particle templates (mass 2.127938) inserted so far.
WARNING: Particle insertion: Less insertions than requested (/home/ht45454/CFDEM/LIGGGHTS/src/fix_insert.cpp:814)
  107006       0.0005    80952    0.1909491   -6145.8939  -0.66313048    20.981317 
Loop time of 0.187155 on 8 procs for 5 steps with 80952 atoms
Max time of 0.187155 on 8 procs for 5 steps with 80952 atoms

Pair  time (%) = 0.0158415 (8.46435)
Max Pair time (ib) = 0.0244217 (54.163)
Neigh time (%) = 0.00913827 (4.88273)
Max Neigh time (ib) = 0.0125734 (37.5906)
Comm  time (%) = 0.00995206 (5.31755)
Max Comm time (ib) = 0.0164581 (65.3743)
Outpt time (%) = 0.0103893 (5.5512)
Max Outpt time (ib) = 0.0104209 (0.30418)
Other time (%) = 0.141834 (75.7842)
Max Other time (ib) = 0.145103 (2.30533)

Nlocal:    10119 ave 12700 max 7475 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:    2255.62 ave 2657 max 1849 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:    57372.9 ave 71932 max 42411 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 458983
Ave neighs/atom = 5.66982
Neighbor list builds = 1
Dangerous builds = 0
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804666, Final residual = 8.52051e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 3.87428e-05, Final residual = 3.87428e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 5.9341e-05, Final residual = 5.9341e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 1.20545e-05, Final residual = 1.20545e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.532871, Final residual = 5.58457e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.601756, Final residual = 8.22109e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.201819, Final residual = 4.98672e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1532.39
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.435725
U : (0 0 0) m/s
G : (0 0 0) kg/m2s
mG: 0 kg/m2s
Re: 0
Pr: 0.045
JH: 200
h : 0 J/m2sK
Tw: 1473.15 K
Tf: 1623.15 K
dT: -150 K
q : -0 J/m2s
A : 0.00245342 m2
Q : -0 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.438786
U : (0 0 0) m/s
G : (0 0 0) kg/m2s
mG: 0 kg/m2s
Re: 0
Pr: 0.045
JH: 200
h : 0 J/m2sK
Tw: 1473.15 K
Tf: 1623.15 K
dT: -150 K
q : -0 J/m2s
A : 0.00245336 m2
Q : -0 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: 0
Maximum Fluid Concentration: 235
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.755554, Final residual = 7.11445e-05, No Iterations 17
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.748133, Final residual = 8.84575e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.596, Final residual = 7.34851e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-47.2138 37.2366 -1028.14)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399432 0 1
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600568 0 1
Phase-sum volume fraction, min, max = 1 1 1
DILUPBiCGStab:  Solving for T, Initial residual = 1, Final residual = 1.82566e-09, No Iterations 1
DILUPBiCGStab:  Solving for C, Initial residual = 2.36622e-05, Final residual = 2.18951e-13, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 1, Final residual = 4.13543e-10, No Iterations 2
smoothSolver:  Solving for Uy, Initial residual = 1, Final residual = 2.14092e-10, No Iterations 2
smoothSolver:  Solving for Uz, Initial residual = 1, Final residual = 2.14186e-11, No Iterations 3
GAMG:  Solving for p_rgh, Initial residual = 1, Final residual = 7.23021e-07, No Iterations 5
GAMG:  Solving for p_rgh, Initial residual = 5.59773e-05, Final residual = 9.98001e-09, No Iterations 9
time step continuity errors : sum local = 4.66941e-09, global = -4.25438e-09, cumulative = -4.25438e-09
GAMG:  Solving for p_rgh, Initial residual = 0.00197122, Final residual = 5.81787e-09, No Iterations 10
GAMGPCG:  Solving for p_rgh, Initial residual = 5.04291e-05, Final residual = 5.50712e-09, No Iterations 4
time step continuity errors : sum local = 2.6169e-09, global = 2.05596e-11, cumulative = -4.23382e-09
total convective particle-fluid heat flux [W] = 1.05309e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 4.41767
ExecutionTime = 1.13 s  ClockTime = 1 s

Courant Number mean: 2.68783e-05 max: 0.00150604

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.001


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  1 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107006       0.0005    80952    0.1909491   -6145.8939  -0.66313048    20.981317 
  107010       0.0009    80952   0.50103593   -6145.8939  -0.66313048    20.973362 
  107011        0.001    80952    0.6461879   -6145.8939  -0.66320204    20.973444 
Loop time of 0.101922 on 8 procs for 5 steps with 80952 atoms
Max time of 0.101923 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804695, Final residual = 8.5156e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 4.22332e-05, Final residual = 4.22332e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 6.65886e-05, Final residual = 6.65886e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.29766e-05, Final residual = 2.29766e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.76984, Final residual = 6.78078e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.776678, Final residual = 8.53776e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.356355, Final residual = 6.30934e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.558657, Final residual = 9.8582e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.793917, Final residual = 4.24819e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.325427, Final residual = 5.76527e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.769782, Final residual = 6.785e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.779693, Final residual = 8.5844e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.356355, Final residual = 6.30939e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1534.36
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.43576
U : (-1.36444e-05 -8.45792e-05 -0.000120117) m/s
G : (-1.48643e-06 -9.21405e-06 -1.30856e-05) kg/m2s
mG: 1.6073e-05 kg/m2s
Re: 0.00428612
Pr: 0.045
JH: 0.595137
h : 0.090543 J/m2sK
Tw: 1473.15 K
Tf: 1586.95 K
dT: -113.799 K
q : -10.3037 J/m2s
A : 0.00245342 m2
Q : -0.0252793 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.25 kg/m3
mu: 7.5e-05 Pa s
dp: 0.02 m
ep: 0.438819
U : (5.5241e-05 0.00300945 -0.000135728) m/s
G : (6.0602e-06 0.000330152 -1.48901e-05) kg/m2s
mG: 0.000330543 kg/m2s
Re: 0.0881446
Pr: 0.045
JH: 0.32508
h : 1.01709 J/m2sK
Tw: 1473.15 K
Tf: 1591.58 K
dT: -118.43 K
q : -120.454 J/m2s
A : 0.00245336 m2
Q : -0.295518 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -1.1953e-19
Maximum Fluid Concentration: 235.008
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.732303, Final residual = 6.37878e-05, No Iterations 20
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.752341, Final residual = 9.18958e-05, No Iterations 19
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.809049, Final residual = 7.01984e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-1870.03 -1105.42 -12246.9)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399455 0 1.00424
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600538 0 1.00648
Phase-sum volume fraction, min, max = 0.999992 0.996064 1.00648
DILUPBiCGStab:  Solving for T, Initial residual = 0.0686948, Final residual = 7.79924e-11, No Iterations 1
DILUPBiCGStab:  Solving for C, Initial residual = 7.81235e-05, Final residual = 2.37448e-10, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.280063, Final residual = 1.11004e-09, No Iterations 2
smoothSolver:  Solving for Uy, Initial residual = 0.302326, Final residual = 7.07384e-10, No Iterations 2
smoothSolver:  Solving for Uz, Initial residual = 0.377803, Final residual = 2.02709e-09, No Iterations 2
GAMG:  Solving for p_rgh, Initial residual = 0.00180603, Final residual = 9.58822e-09, No Iterations 17
GAMG:  Solving for p_rgh, Initial residual = 4.73702e-05, Final residual = 7.5396e-09, No Iterations 9
time step continuity errors : sum local = 4.99069e-05, global = -3.11291e-06, cumulative = -3.11714e-06
GAMG:  Solving for p_rgh, Initial residual = 9.08842e-06, Final residual = 8.55641e-09, No Iterations 6
GAMGPCG:  Solving for p_rgh, Initial residual = 1.96193e-06, Final residual = 2.48021e-09, No Iterations 3
time step continuity errors : sum local = 4.99047e-05, global = -3.11102e-06, cumulative = -6.22816e-06
total convective particle-fluid heat flux [W] = 1.25072e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 5.61822
ExecutionTime = 1.62 s  ClockTime = 1 s

Courant Number mean: 0.000284655 max: 0.0464397

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.0015


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  2 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107011        0.001    80952    0.6461879   -6145.8939  -0.66320204    20.973444 
  107016       0.0015    80952    3.1189791   -6145.8939  -0.66313048    20.973937 
Loop time of 0.0857694 on 8 procs for 5 steps with 80952 atoms
Max time of 0.0857784 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.804577, Final residual = 8.50707e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 5.43886e-05, Final residual = 5.43886e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 7.96604e-05, Final residual = 7.96604e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.40844e-05, Final residual = 2.40844e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.79111, Final residual = 4.48981e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.660313, Final residual = 6.18147e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.312564, Final residual = 6.67658e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.696938, Final residual = 5.86075e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.810373, Final residual = 8.43241e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.503184, Final residual = 5.55987e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.789198, Final residual = 5.39929e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.625967, Final residual = 6.62219e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.312727, Final residual = 6.67119e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1536.71
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.24998 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199999 m
ep: 0.435856
U : (1.91042e-05 -5.88365e-05 0.000765355) m/s
G : (2.0815e-06 -6.41055e-06 8.33895e-05) kg/m2s
mG: 8.36615e-05 kg/m2s
Re: 0.0223096
Pr: 0.045
JH: 0.427889
h : 0.338843 J/m2sK
Tw: 1473.15 K
Tf: 1557.95 K
dT: -84.7958 K
q : -28.7325 J/m2s
A : 0.00245342 m2
Q : -0.0704927 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249981 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199999 m
ep: 0.438904
U : (0.00121696 0.0387208 0.0204038) m/s
G : (0.000133522 0.00424836 0.00223865) kg/m2s
mG: 0.00480395 kg/m2s
Re: 1.28105
Pr: 0.045
JH: 0.190334
h : 8.6548 J/m2sK
Tw: 1473.15 K
Tf: 1565.07 K
dT: -91.9203 K
q : -795.552 J/m2s
A : 0.00245336 m2
Q : -1.95178 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -2.00982e-08
Maximum Fluid Concentration: 236.011
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.870363, Final residual = 6.25944e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.884229, Final residual = 6.29701e-05, No Iterations 19
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.843814, Final residual = 6.88154e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-554.114 15498.4 -28772.5)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399517 0 1.0063
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600474 0 1.00322
Phase-sum volume fraction, min, max = 0.999992 0.994884 1.0063
DILUPBiCGStab:  Solving for T, Initial residual = 0.0777959, Final residual = 9.29849e-10, No Iterations 2
DILUPBiCGStab:  Solving for C, Initial residual = 0.000150021, Final residual = 2.87533e-10, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.349492, Final residual = 1.39514e-10, No Iterations 4
smoothSolver:  Solving for Uy, Initial residual = 0.309333, Final residual = 3.92833e-10, No Iterations 4
smoothSolver:  Solving for Uz, Initial residual = 0.431568, Final residual = 9.8926e-09, No Iterations 3
GAMG:  Solving for p_rgh, Initial residual = 0.00195633, Final residual = 5.76696e-09, No Iterations 12
GAMG:  Solving for p_rgh, Initial residual = 0.000470057, Final residual = 8.89078e-09, No Iterations 11
time step continuity errors : sum local = 7.74661e-05, global = -4.12348e-06, cumulative = -1.03516e-05
GAMG:  Solving for p_rgh, Initial residual = 0.00014322, Final residual = 3.87342e-09, No Iterations 9
GAMGPCG:  Solving for p_rgh, Initial residual = 2.30486e-05, Final residual = 3.40948e-09, No Iterations 4
time step continuity errors : sum local = 7.74673e-05, global = -4.12428e-06, cumulative = -1.44759e-05
total convective particle-fluid heat flux [W] = 1.98537e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 9.85877
ExecutionTime = 2.11 s  ClockTime = 2 s

Courant Number mean: 0.00103508 max: 0.0907231

Debugging zero!

Interface Courant Number mean: 0 max: 0

Debugging one!

Time = 0.002


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  2 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107016       0.0015    80952    3.1189791   -6145.8939  -0.66313048    20.973937 
  107020       0.0019    80952    9.8517058   -6145.8939  -0.66305894    20.974687 
  107021        0.002    80952    10.894707   -6145.8939  -0.66320204    20.974875 
Loop time of 0.135152 on 8 procs for 5 steps with 80952 atoms
Max time of 0.135152 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.80458, Final residual = 8.47817e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 7.17035e-05, Final residual = 7.17035e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.000114345, Final residual = 4.97675e-07, No Iterations 1
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.13009e-05, Final residual = 2.13009e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.783222, Final residual = 7.39338e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.826907, Final residual = 9.36839e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.333575, Final residual = 7.26957e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.738742, Final residual = 8.8124e-05, No Iterations 9
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.825539, Final residual = 7.45413e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.673247, Final residual = 4.90688e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.78119, Final residual = 8.58712e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.759976, Final residual = 5.45715e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.327155, Final residual = 7.04004e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1540.44
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249945 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199999 m
ep: 0.436043
U : (-0.000240353 0.000144298 0.00139561) m/s
G : (-2.61953e-05 1.57266e-05 0.000152103) kg/m2s
mG: 0.000155141 kg/m2s
Re: 0.0413708
Pr: 0.045
JH: 0.378174
h : 0.555342 J/m2sK
Tw: 1473.15 K
Tf: 1533.54 K
dT: -60.3898 K
q : -33.537 J/m2s
A : 0.00245342 m2
Q : -0.0822803 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249952 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199998 m
ep: 0.439052
U : (-0.00593097 -0.169889 0.0675336) m/s
G : (-0.000650876 -0.018644 0.00741127) kg/m2s
mG: 0.0200736 kg/m2s
Re: 5.3529
Pr: 0.045
JH: 0.142992
h : 27.1693 J/m2sK
Tw: 1473.15 K
Tf: 1541.21 K
dT: -68.062 K
q : -1849.2 J/m2s
A : 0.00245336 m2
Q : -4.53675 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -1.06072e-07
Maximum Fluid Concentration: 236.503
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.832951, Final residual = 7.84512e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.877044, Final residual = 7.96755e-05, No Iterations 19
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.850405, Final residual = 6.82736e-05, No Iterations 17
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (39162.8 56961.3 -315942)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399615 0 1.01155
MULES: Solving for alpha.air
air volume fraction, min, max = 0.600372 0 1.00305
Phase-sum volume fraction, min, max = 0.999987 0.993038 1.01155
DILUPBiCGStab:  Solving for T, Initial residual = 0.118188, Final residual = 8.7212e-09, No Iterations 2
DILUPBiCGStab:  Solving for C, Initial residual = 0.000249173, Final residual = 2.13813e-09, No Iterations 1
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.267548, Final residual = 4.20075e-10, No Iterations 6
smoothSolver:  Solving for Uy, Initial residual = 0.319191, Final residual = 5.99364e-10, No Iterations 6
smoothSolver:  Solving for Uz, Initial residual = 0.243477, Final residual = 3.47532e-09, No Iterations 5
GAMG:  Solving for p_rgh, Initial residual = 0.0112744, Final residual = 7.65233e-09, No Iterations 16
GAMG:  Solving for p_rgh, Initial residual = 0.00136688, Final residual = 4.91865e-09, No Iterations 10
time step continuity errors : sum local = 0.000111641, global = -7.20463e-06, cumulative = -2.16805e-05
GAMG:  Solving for p_rgh, Initial residual = 0.00073184, Final residual = 9.64391e-09, No Iterations 13
GAMGPCG:  Solving for p_rgh, Initial residual = 0.000175917, Final residual = 4.0745e-09, No Iterations 5
time step continuity errors : sum local = 0.000111641, global = -7.20355e-06, cumulative = -2.88841e-05
total convective particle-fluid heat flux [W] = 3.20638e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 17.1794
ExecutionTime = 2.64 s  ClockTime = 2 s

Courant Number mean: 0.00404595 max: 0.353549

Debugging zero!

Interface Courant Number mean: 2.20653e-06 max: 0.013752

Debugging one!

Time = 0.0025


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  2 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107021        0.002    80952    10.894707   -6145.8939  -0.66320204    20.974875 
  107026       0.0025    80952    1108.5274   -6145.8939  -0.66327361    20.972953 
Loop time of 0.155829 on 8 procs for 5 steps with 80952 atoms
Max time of 0.155829 on 8 procs for 5 steps with 80952 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.805227, Final residual = 8.34133e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.000118804, Final residual = 8.80495e-06, No Iterations 1
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 8.00823e-05, Final residual = 8.00823e-05, No Iterations 0
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 2.54424e-05, Final residual = 2.54424e-05, No Iterations 0

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.799894, Final residual = 5.78365e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.809642, Final residual = 7.19325e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.651961, Final residual = 8.38356e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.752191, Final residual = 4.48287e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.831507, Final residual = 7.31679e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.750165, Final residual = 8.17999e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.785911, Final residual = 5.3069e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.761358, Final residual = 8.13545e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.620447, Final residual = 4.68607e-05, No Iterations 11
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1546.46
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249893 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199998 m
ep: 0.436248
U : (-0.000324971 9.36401e-05 0.00110473) m/s
G : (-3.54268e-05 1.02082e-05 0.000120433) kg/m2s
mG: 0.00012595 kg/m2s
Re: 0.0335863
Pr: 0.045
JH: 0.394273
h : 0.470043 J/m2sK
Tw: 1473.15 K
Tf: 1513.5 K
dT: -40.3469 K
q : -18.9648 J/m2s
A : 0.00245342 m2
Q : -0.0465284 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249916 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199996 m
ep: 0.439238
U : (-0.0463022 -1.37052 0.143146) m/s
G : (-0.00508271 -0.150445 0.0157135) kg/m2s
mG: 0.151349 kg/m2s
Re: 40.359
Pr: 0.045
JH: 0.0954645
h : 136.761 J/m2sK
Tw: 1473.15 K
Tf: 1521.37 K
dT: -48.224 K
q : -6595.18 J/m2s
A : 0.00245336 m2
Q : -16.1804 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -4.74489e-07
Maximum Fluid Concentration: 237.766
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.878779, Final residual = 6.75485e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.882262, Final residual = 7.8021e-05, No Iterations 18
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.922971, Final residual = 8.69998e-05, No Iterations 14
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (389917 -7.5042e+06 -2.10229e+06)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399747 -1.08499e-12 1.07919
MULES: Solving for alpha.air
air volume fraction, min, max = 0.60024 0 1.00385
Phase-sum volume fraction, min, max = 0.999987 0.948442 1.07919
DILUPBiCGStab:  Solving for T, Initial residual = 0.207608, Final residual = 3.09989e-09, No Iterations 3
DILUPBiCGStab:  Solving for C, Initial residual = 0.000624078, Final residual = 2.06857e-09, No Iterations 2
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.277505, Final residual = 6.60787e-09, No Iterations 6
smoothSolver:  Solving for Uy, Initial residual = 0.203774, Final residual = 1.10753e-09, No Iterations 7
smoothSolver:  Solving for Uz, Initial residual = 0.124679, Final residual = 2.17017e-09, No Iterations 6
GAMG:  Solving for p_rgh, Initial residual = 0.0791913, Final residual = 2.70386e-08, No Iterations 12
GAMG:  Solving for p_rgh, Initial residual = 0.00208924, Final residual = 9.42367e-09, No Iterations 10
time step continuity errors : sum local = 0.000263024, global = -1.29774e-05, cumulative = -4.18615e-05
GAMG:  Solving for p_rgh, Initial residual = 0.00364591, Final residual = 2.60604e-09, No Iterations 12
GAMGPCG:  Solving for p_rgh, Initial residual = 0.000608397, Final residual = 9.41927e-09, No Iterations 5
time step continuity errors : sum local = 0.000263027, global = -1.29815e-05, cumulative = -5.4843e-05
total convective particle-fluid heat flux [W] = 5.05597e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 36.7912
ExecutionTime = 3.17 s  ClockTime = 3 s

Courant Number mean: 0.0142592 max: 1.0421

Debugging zero!

Interface Courant Number mean: 0.000566139 max: 0.732815

Debugging one!

Time = 0.003


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80952
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  3 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107026       0.0025    80952    1108.5274   -6145.8939  -0.66327361    20.972953 
  107030       0.0029    80914    731050.14   -6145.8939   -0.6634168    20.973496 
  107031        0.003    80895    902771.96   -6145.8939  -0.66305894    20.973632 
Loop time of 0.184637 on 8 procs for 5 steps with 80895 atoms
Max time of 0.184638 on 8 procs for 5 steps with 80895 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.810101, Final residual = 8.04322e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.00015618, Final residual = 1.17802e-07, No Iterations 1
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.000109395, Final residual = 1.03859e-08, No Iterations 1
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.000104167, Final residual = 4.02902e-07, No Iterations 1

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.834662, Final residual = 8.68913e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.857741, Final residual = 6.07421e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.800438, Final residual = 9.61731e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.793387, Final residual = 6.05079e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.817347, Final residual = 8.2866e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.774494, Final residual = 6.80566e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.813279, Final residual = 4.79798e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.793102, Final residual = 9.37179e-05, No Iterations 9
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.800501, Final residual = 5.10469e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1555.94
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249882 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199997 m
ep: 0.436501
U : (0.00104337 -0.00270453 -0.00342279) m/s
G : (0.000113804 -0.000294993 -0.000373337) kg/m2s
mG: 0.000489237 kg/m2s
Re: 0.130461
Pr: 0.045
JH: 0.300562
h : 1.39186 J/m2sK
Tw: 1473.15 K
Tf: 1497.15 K
dT: -24.0014 K
q : -33.4066 J/m2s
A : 0.00245342 m2
Q : -0.0819602 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249894 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199993 m
ep: 0.439558
U : (0.542782 15.7388 -0.26211) m/s
G : (0.0596208 1.7288 -0.0287909) kg/m2s
mG: 1.73006 kg/m2s
Re: 461.335
Pr: 0.045
JH: 0.0586444
h : 960.353 J/m2sK
Tw: 1473.15 K
Tf: 1502.1 K
dT: -28.9496 K
q : -27801.9 J/m2s
A : 0.00245336 m2
Q : -68.2081 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -5.67488e-06
Maximum Fluid Concentration: 253.137
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.934186, Final residual = 7.33467e-05, No Iterations 14
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.936621, Final residual = 7.31807e-05, No Iterations 13
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.938114, Final residual = 9.13782e-05, No Iterations 13
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (-1.93971e+08 8.65016e+07 -2.11139e+08)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.399083 -8.42438e-11 1.03838
MULES: Solving for alpha.air
air volume fraction, min, max = 0.599882 0 1.00348
Phase-sum volume fraction, min, max = 0.998964 0.769742 1.03838
DILUPBiCGStab:  Solving for T, Initial residual = 0.427483, Final residual = 4.86423e-10, No Iterations 4
DILUPBiCGStab:  Solving for C, Initial residual = 0.00231379, Final residual = 3.32346e-09, No Iterations 3
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.404855, Final residual = 1.01433e-09, No Iterations 5
smoothSolver:  Solving for Uy, Initial residual = 0.0192365, Final residual = 7.04993e-09, No Iterations 4
smoothSolver:  Solving for Uz, Initial residual = 0.193282, Final residual = 6.97694e-09, No Iterations 4
GAMG:  Solving for p_rgh, Initial residual = 0.219714, Final residual = 1.58922e-07, No Iterations 13
GAMG:  Solving for p_rgh, Initial residual = 0.000444319, Final residual = 3.52521e-09, No Iterations 10
time step continuity errors : sum local = 0.000954079, global = -0.000482919, cumulative = -0.000537762
GAMG:  Solving for p_rgh, Initial residual = 0.00196951, Final residual = 4.24916e-09, No Iterations 13
GAMGPCG:  Solving for p_rgh, Initial residual = 0.000890865, Final residual = 4.48047e-09, No Iterations 5
time step continuity errors : sum local = 0.000954085, global = -0.000482921, cumulative = -0.00102068
total convective particle-fluid heat flux [W] = 3.80714e+09
total convective particle-fluid mass flux [kg/s] (Eulerian) = 103.735
ExecutionTime = 3.75 s  ClockTime = 3 s

Courant Number mean: 0.0897478 max: 18.4464

Debugging zero!

Interface Courant Number mean: 0.0148299 max: 6.39457

Debugging one!

Time = 0.0035


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 80895
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  3 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107031        0.003    80895    902771.96   -6145.8939  -0.66305894    20.973632 
  107036       0.0035    78592     10717618   -6145.8939  -0.66327361    20.974511 
Loop time of 0.166092 on 8 procs for 5 steps with 78592 atoms
Max time of 0.166092 on 8 procs for 5 steps with 78592 atoms
LIGGGHTS finished
FDICPCG:  Solving for sSmoothField, Initial residual = 0.835072, Final residual = 8.29025e-05, No Iterations 16
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.00018347, Final residual = 7.81221e-08, No Iterations 1
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.000168455, Final residual = 1.41656e-07, No Iterations 1
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.000193375, Final residual = 3.99338e-08, No Iterations 1

 timeStepFraction() = 1
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.833588, Final residual = 7.51075e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.840521, Final residual = 4.33447e-05, No Iterations 11
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.829071, Final residual = 6.46376e-05, No Iterations 10
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.820753, Final residual = 4.8947e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.833524, Final residual = 7.82451e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.808899, Final residual = 6.47622e-05, No Iterations 9
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.843751, Final residual = 4.5337e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.836327, Final residual = 6.52052e-05, No Iterations 10
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.837973, Final residual = 7.96653e-05, No Iterations 8
diagonal:  Solving for vSmoothFieldx, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldy, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for vSmoothFieldz, Initial residual = 0, Final residual = 0, No Iterations 0
diagonal:  Solving for sSmoothField, Initial residual = 0, Final residual = 0, No Iterations 0
heatTransferGunn: average part. temp = 1564.06
####################
cellID: 0
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249855 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199996 m
ep: 0.437269
U : (0.00137751 -0.001416 -0.00913123) m/s
G : (0.000150498 -0.000154704 -0.000997624) kg/m2s
mG: 0.0010207 kg/m2s
Re: 0.272183
Pr: 0.045
JH: 0.259453
h : 2.50668 J/m2sK
Tw: 1473.15 K
Tf: 1482.25 K
dT: -9.10332 K
q : -22.8191 J/m2s
A : 0.00245342 m2
Q : -0.0559848 J/s
####################
cellID: 1
kf: 2 J/msK
Cp: 1200 J/kgK
ro: 0.249818 kg/m3
mu: 7.5e-05 Pa s
dp: 0.0199981 m
ep: 0.440365
U : (4.5998 136.026 -9.40316) m/s
G : (0.506029 14.9644 -1.03445) kg/m2s
mG: 15.0087 kg/m2s
Re: 4001.93
Pr: 0.045
JH: 0.0380694
h : 5408.29 J/m2sK
Tw: 1473.15 K
Tf: 1479.95 K
dT: -6.79899 K
q : -36770.9 J/m2s
A : 0.00245336 m2
Q : -90.2123 J/s
Minimum Particle Weight 0
Minimum Fluid Concentration: -0.0353167
Maximum Fluid Concentration: 244.425
FDICPCG:  Solving for vSmoothFieldx, Initial residual = 0.94151, Final residual = 7.50063e-05, No Iterations 13
FDICPCG:  Solving for vSmoothFieldy, Initial residual = 0.945512, Final residual = 8.21013e-05, No Iterations 12
FDICPCG:  Solving for vSmoothFieldz, Initial residual = 0.945659, Final residual = 8.32959e-05, No Iterations 13
update Ksl.internalField()
TotalForceExp: (0 0 0)
TotalForceImp: (5.73172e+08 -5.84752e+08 1.63176e+09)
MULES: Solving for alpha.iron
iron volume fraction, min, max = 0.375632 -0.215322 1.45131
MULES: Solving for alpha.air
air volume fraction, min, max = 0.597135 -0.616566 1.14164
Phase-sum volume fraction, min, max = 0.972767 0.426592 1.38023
DILUPBiCGStab:  Solving for T, Initial residual = 0.817672, Final residual = 3.53345e-09, No Iterations 5
DILUPBiCGStab:  Solving for C, Initial residual = 0.0277129, Final residual = 6.13032e-09, No Iterations 9
PIMPLE: iteration 1
smoothSolver:  Solving for Ux, Initial residual = 0.49961, Final residual = 3.07318e-09, No Iterations 9
smoothSolver:  Solving for Uy, Initial residual = 0.100105, Final residual = 3.09258e-09, No Iterations 9
smoothSolver:  Solving for Uz, Initial residual = 0.186642, Final residual = 1.48835e-09, No Iterations 9
GAMG:  Solving for p_rgh, Initial residual = 0.195057, Final residual = 1.62425e-07, No Iterations 32
GAMG:  Solving for p_rgh, Initial residual = 0.00067377, Final residual = 5.35525e-09, No Iterations 10
time step continuity errors : sum local = 0.0153281, global = -0.0146018, cumulative = -0.0156225
GAMG:  Solving for p_rgh, Initial residual = 0.014119, Final residual = 1.29726e-08, No Iterations 19
GAMGPCG:  Solving for p_rgh, Initial residual = 0.00120419, Final residual = 9.05107e-09, No Iterations 6
time step continuity errors : sum local = 0.0153286, global = -0.0146025, cumulative = -0.030225
total convective particle-fluid heat flux [W] = -7.45662e+10
total convective particle-fluid mass flux [kg/s] (Eulerian) = 289.167
ExecutionTime = 4.33 s  ClockTime = 4 s

Courant Number mean: 2.71329 max: 389.262

Debugging zero!

Interface Courant Number mean: 2.35595 max: 389.262

Debugging one!

Time = 0.004


 Coupling...
Starting up LIGGGHTS
Executing command: 'delete_atoms region freeboard compress no '
delete_atoms region freeboard compress no 
Deleted 0 atoms, new total = 78592
Executing command: 'set region raceways property/atom Temp ${Tinlet}'
set region raceways property/atom Temp ${Tinlet}
set region raceways property/atom Temp 1823.15
Setting atom values ...
  3 settings made for property/atom
Executing command: 'run 5 pre no post no'
run 5 pre no post no
Step Time Atoms KinEng totalFor avForceP nDelRun 
  107036       0.0035    78592     10717618   -6145.8939  -0.66327361    20.974511 
[4] #0  Foam::error::printStack(Foam::Ostream&)[6] #0  Foam::error::printStack(Foam::Ostream&)[0] #0  Foam::error::printStack(Foam::Ostream&) at ??:?
 at ??:?
[6] #1  Foam::sigFpe::sigHandler(int)[0] #1  Foam::sigFpe::sigHandler(int) at ??:?
[4] #1  Foam::sigFpe::sigHandler(int) at ??:?
[6] #2  ? at ??:?
[0] #2  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[0] #3  ? at ??:?
[4] #2  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[6] #3  ? in "/lib/x86_64-linux-gnu/libm.so.6"
[0] #4  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[4] #3  ? in "/lib/x86_64-linux-gnu/libm.so.6"
[6] #4  ? in "/lib/x86_64-linux-gnu/libm.so.6"
[4] #4  ? at fix_heat_gran_conduction.cpp:?
 at fix_heat_gran_conduction.cpp:?
 at fix_heat_gran_conduction.cpp:?
[6] #5  LAMMPS_NS::FixHeatGranCond::post_force(int)[4] #5  LAMMPS_NS::FixHeatGranCond::post_force(int)[0] #5  LAMMPS_NS::FixHeatGranCond::post_force(int) at ??:?
 at ??:?
 at ??:?
[4] #6  LAMMPS_NS::Modify::post_force(int)[0] #6  LAMMPS_NS::Modify::post_force(int)[6] #6  LAMMPS_NS::Modify::post_force(int) at ??:?
 at ??:?
[0] #7  LAMMPS_NS::Verlet::run(int)[4] #7  LAMMPS_NS::Verlet::run(int) at ??:?
[6] #7  LAMMPS_NS::Verlet::run(int) at ??:?
 at ??:?
[0] #8  LAMMPS_NS::Run::command(int, char**)[4] #8  LAMMPS_NS::Run::command(int, char**) at ??:?
[6] #8  LAMMPS_NS::Run::command(int, char**) at ??:?
 at ??:?
 at ??:?
[0] #9  void LAMMPS_NS::Input::command_creator<LAMMPS_NS::Run>(LAMMPS_NS::LAMMPS*, int, char**)[4] #9  void LAMMPS_NS::Input::command_creator<LAMMPS_NS::Run>(LAMMPS_NS::LAMMPS*, int, char**)[6] #9  void LAMMPS_NS::Input::command_creator<LAMMPS_NS::Run>(LAMMPS_NS::LAMMPS*, int, char**) at ??:?
[0] #10  LAMMPS_NS::Input::execute_command() at ??:?
[6] #10  LAMMPS_NS::Input::execute_command() at ??:?
[4] #10  LAMMPS_NS::Input::execute_command() at ??:?
[6] #11  LAMMPS_NS::Input::one(char const*) at ??:?
 at ??:?
[4] #11  LAMMPS_NS::Input::one(char const*)[0] #11  LAMMPS_NS::Input::one(char const*) at ??:?
[6] #12  Foam::twoWayMPI::couple(int) at ??:?
[0] #12  Foam::twoWayMPI::couple(int) at ??:?
[4] #12  Foam::twoWayMPI::couple(int) at ??:?
[4] #13  Foam::cfdemCloud::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[0] #13  Foam::cfdemCloud::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[6] #13  Foam::cfdemCloud::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[0] #14  Foam::cfdemCloudEnergy::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[4] #14  Foam::cfdemCloudEnergy::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[6] #14  Foam::cfdemCloudEnergy::evolve(Foam::GeometricField<double, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&, Foam::GeometricField<Foam::Vector<double>, Foam::fvPatchField, Foam::volMesh>&) at ??:?
[0] #15   at ??:?
[4] #15   at ??:?
[6] #15  mainmainmain in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
 in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolv[0] #16  ?erMultiphaseScalar"
[4] #16  ? in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[6] #16  ? in "/lib/x86_64-linux-gnu/libc.so.6"
[4] #17  __libc_start_main in "/lib/x86_64-linux-gnu/libc.so.6"
[0] #17  __libc_start_main in "/lib/x86_64-linux-gnu/libc.so.6"
[6] #17  __libc_start_main in "/lib/x86_64-linux-gnu/libc.so.6"
[4] #18   in "/lib/x86_64-linux-gnu/libc.so.6"
[0] #18   in "/lib/x86_64-linux-gnu/libc.so.6"
[6] #18  ??? in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[TUE035485:01612] *** Process received signal ***
[TUE035485:01612] Signal: Floating point exception (8)
[TUE035485:01612] Signal code:  (-6)
[TUE035485:01612] Failing at address: 0x3e80000064c
[TUE035485:01612] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x45330)[0x7fb4fc0b3330]
[TUE035485:01612] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x11c)[0x7fb4fc10cb2c]
[TUE035485:01612] [ 2] /lib/x86_64-linux-gnu/libc.so.6(gsignal+0x1e)[0x7fb4fc0b327e]
[TUE035485:01612] [ 3] /lib/x86_64-linux-gnu/libc.so.6(+0x45330)[0x7fb4fc0b3330]
[TUE035485:01612] [ 4] /lib/x86_64-linux-gnu/libm.so.6(+0x153a4)[0x7fb4fc2c53a4]
[TUE035485:01612] [ 5]  in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[TUE035485:01616] *** Process received signal ***
[TUE035485:01616] Signal: Floating point exception (8)
[TUE035485:01616] Signal code:  (-6)
[TUE035485:01616] Failing at address: 0x3e800000650
[TUE035485:01616] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x45330)[0x7f83303e2330]
[TUE035485:01616] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x11c)[0x7f833043bb2c]
[TUE035485:01616] [ 2] /lib/x86_64-linux-gnu/libc.so.6(gsignal+0x1e)[0x7f83303e227e]
[TUE035485:01616] [ 3] /lib/x86_64-linux-gnu/libc.so.6(+0x45330)[0x7f83303e2330]
[TUE035485:01616] [ 4] /lib/x86_64-linux-gnu/libm.so.6(+0x153a4)[0x7f83305f43a4]
[TUE035485:01616] [ 5] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(+0x109fe41)[0x7fb4f9658e41]
[TUE035485:01612] [ 6] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(+0x109fe41)[0x7f832d987e41]
[TUE035485:01616] [ 6] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS15FixHeatGranCond10post_forceEi+0xb2)[0x7fb4f96596d2]
[TUE035485:01612] [ 7] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS15FixHeatGranCond10post_forceEi+0xb2)[0x7f832d9886d2]
[TUE035485:01616] [ 7]  in "/home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/bin/cfdemSolverMultiphaseScalar"
[TUE035485:01618] *** Process received signal ***
[TUE035485:01618] Signal: Floating point exception (8)
[TUE035485:01618] Signal code:  (-6)
[TUE035485:01618] Failing at address: 0x3e800000652
[TUE035485:01618] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x45330)[0x7f15725b4330]
[TUE035485:01618] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x11c)[0x7f157260db2c]
[TUE035485:01618] [ 2] /lib/x86_64-linux-gnu/libc.so.6(gsignal+0x1e)[0x7f15725b427e]
[TUE035485:01618] [ 3] /lib/x86_64-linux-gnu/libc.so.6(+0x45330)[0x7f15725b4330]
[TUE035485:01618] [ 4] /lib/x86_64-linux-gnu/libm.so.6(+0x153a4)[0x7f15727c63a4]
[TUE035485:01618] [ 5] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Modify10post_forceEi+0x57)[0x7f832ed62fc7]
[TUE035485:01616] [ 8] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Modify10post_forceEi+0x57)[0x7fb4faa33fc7]
[TUE035485:01612] [ 8] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(+0x109fe41)[0x7f156fb59e41]
[TUE035485:01618] [ 6] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Verlet3runEi+0x3e2)[0x7f832eec51f2]
[TUE035485:01616] [ 9] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS15FixHeatGranCond10post_forceEi+0xb2)[0x7f156fb5a6d2]
[TUE035485:01618] [ 7] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Verlet3runEi+0x3e2)[0x7fb4fab961f2]
[TUE035485:01612] [ 9] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS3Run7commandEiPPc+0x2b0)[0x7f832ee60e00]
[TUE035485:01616] [10] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS3Run7commandEiPPc+0x2b0)[0x7fb4fab31e00]
/home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Modify10post_forceEi+0x57)[0x7f1570f34fc7]
[TUE035485:01618] [ 8] [TUE035485:01612] [10] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15command_creatorINS_3RunEEEvPNS_6LAMMPSEiPPc+0x42)[0x7f832ed1f2c2]
[TUE035485:01616] [11] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS6Verlet3runEi+0x3e2)[0x7f15710971f2]
[TUE035485:01618] [ 9] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15command_creatorINS_3RunEEEvPNS_6LAMMPSEiPPc+0x42)[0x7fb4fa9f02c2]
[TUE035485:01612] [11] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15execute_commandEv+0x820)[0x7f832ed1d2a0]
[TUE035485:01616] [12] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15execute_commandEv+0x820)[0x7fb4fa9ee2a0]
[TUE035485:01612] [12] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input3oneEPKc+0x89)[0x7f832ed1de09]
[TUE035485:01616] [13] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam9twoWayMPI6coupleEi+0x8d3)[0x7f8331714273]
[TUE035485:01616] [14] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam10cfdemCloud6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x7d5)[0x7f83313f9ed5]
[TUE035485:01616] [15] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS3Run7commandEiPPc+0x2b0)[0x7f1571032e00]
[TUE035485:01618] [10] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam16cfdemCloudEnergy6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x2a)[0x7f833145c89a]
[TUE035485:01616] [16] cfdemSolverMultiphaseScalar(main+0x4d2f)[0x55f712b4ceef]
[TUE035485:01616] [17] /lib/x86_64-linux-gnu/libc.so.6(+0x2a1ca)[0x7f83303c71ca]
[TUE035485:01616] [18] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x8b)[0x7f83303c728b]
[TUE035485:01616] [19] cfdemSolverMultiphaseScalar(+0x41875)[0x55f712b53875]
[TUE035485:01616] *** End of error message ***
/home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input3oneEPKc+0x89)[0x7fb4fa9eee09]
[TUE035485:01612] [13] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam9twoWayMPI6coupleEi+0x8d3)[0x7fb4fd3e5273]
[TUE035485:01612] [14] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam10cfdemCloud6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x7d5)[0x7fb4fd0caed5]
[TUE035485:01612] [15] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam16cfdemCloudEnergy6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x2a)[0x7fb4fd12d89a]
[TUE035485:01612] [16] cfdemSolverMultiphaseScalar(main+0x4d2f)[0x564f59faceef]
[TUE035485:01612] [17] /lib/x86_64-linux-gnu/libc.so.6(+0x2a1ca)[0x7fb4fc0981ca]
[TUE035485:01612] [18] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x8b)[0x7fb4fc09828b]
[TUE035485:01612] [19] cfdemSolverMultiphaseScalar(+0x41875)[0x564f59fb3875]
[TUE035485:01612] *** End of error message ***
/home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15command_creatorINS_3RunEEEvPNS_6LAMMPSEiPPc+0x42)[0x7f1570ef12c2]
[TUE035485:01618] [11] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input15execute_commandEv+0x820)[0x7f1570eef2a0]
[TUE035485:01618] [12] /home/ht45454/CFDEM/LIGGGHTS/src-build/libliggghts.so(_ZN9LAMMPS_NS5Input3oneEPKc+0x89)[0x7f1570eefe09]
[TUE035485:01618] [13] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam9twoWayMPI6coupleEi+0x8d3)[0x7f15738e6273]
[TUE035485:01618] [14] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam10cfdemCloud6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x7d5)[0x7f15735cbed5]
[TUE035485:01618] [15] /home/ht45454/CFDEM/CFDEMcoupling-24.01-4.x/platforms/linux64GccDPInt32Opt/lib/liblagrangianCFDEM-24.01-4.x.so(_ZN4Foam16cfdemCloudEnergy6evolveERNS_14GeometricFieldIdNS_12fvPatchFieldENS_7volMeshEEERNS1_INS_6VectorIdEES2_S3_EES9_+0x2a)[0x7f157362e89a]
[TUE035485:01618] [16] cfdemSolverMultiphaseScalar(main+0x4d2f)[0x555b9f7d7eef]
[TUE035485:01618] [17] /lib/x86_64-linux-gnu/libc.so.6(+0x2a1ca)[0x7f15725991ca]
[TUE035485:01618] [18] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x8b)[0x7f157259928b]
[TUE035485:01618] [19] cfdemSolverMultiphaseScalar(+0x41875)[0x555b9f7de875]
[TUE035485:01618] *** End of error message ***
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun noticed that process rank 4 with PID 0 on node TUE035485 exited on signal 8 (Floating point exception).
--------------------------------------------------------------------------
